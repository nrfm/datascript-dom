(function(){window.generic=(window.generic||{});window.generic.install=function(c,b){var a;for(a in b){if(b.hasOwnProperty(a)){c[a]=b[a];}}};})();(function(a){a.install(a,{document_readys:[],document_is_ready:function(){var d=a.document_readys,b;a.document_readys=null;for(b=0;b<d.length;b++){try{d[b](jQuery);}catch(c){}}if(a.should_jQuery_noConflict){jQuery.noConflict(false);}},on_document_ready:function(b){if(a.has_document_readied()){b(jQuery);}else{a.document_readys.push(b);}},has_document_readied:function(){return a.document_readys===null;}});})(window.generic);function consoleLog(j,b,a){var i=window.consoleLog,d=document.location,h=d.hash.match("debug=1"),f=(a==="error"||h),g;if(!b){b="global";}else{(i[b]=i[b]||[]).push(j);}g=b+" : "+j;(i.global=i.global||[]).push(g);try{if(!f){return;}if(window.console){if(window.console[a]){window.console[a](g);}else{if(window.console.log){window.console.log(g);}}}}catch(c){}}function consoleWarn(b,a){consoleLog(b,a,"warn");}function consoleError(b,a){consoleLog(b,a,"error");}document.getElementsByTagName("html")[0].className+=" scriptsOn";(function(b,a){b.imdbads=b.imdbads||{};b.imdbads.frequencyCapping=(function(){var k=function(){try{if(l&&!j){if(typeof mraidbridge!=="undefined"&&typeof mraidbridge.localstorage!=="undefined"){return mraidbridge.localstorage;}else{return undefined;}}else{if(l&&j&&b.localStorage!==null){b.localStorage.setItem("foo","foo");b.localStorage.removeItem("foo");}}return b.localStorage;}catch(n){return undefined;}},l=(/iphone|ipad|ipod/i).test(b.navigator.userAgent.toLowerCase()),j=a.domain.match(/imdb/g)!==null,m="IMDbAdvertisingFrequencyCapping",g=function(){var o;if(k()&&b.JSON){o=k().getItem(m);if(o){try{return JSON.parse(o);}catch(n){k().removeItem(m);console.log("Could not deserialize persistence variable");}}return{};}return null;},f=function(n){if(k()&&b.JSON){k().setItem(m,JSON.stringify(n));}},i=function(){var o=g(),n;if(o){for(n in o){if(c(o[n])){delete o[n];}}f(o);}},c=function(n){if(n&&n.l&&n.l>h){return false;}return true;},d=new Date().getTime(),h=d-86400000;if(b.generic&&b.generic.on_document_ready){b.generic.on_document_ready(i);}else{if(a.readyState=="complete"){i();}else{b.addEventListener("load",i,false);}}return{should_autoplay:function(o){var n=g();if(!n){return false;}return c(n[o]);},log_autoplay:function(o){var n=g();if(n){n[o]={l:d};f(n);}else{console.log("Autoplay logged, but localStorage is not available!");if(b.generic&&b.generic.monitoring&&b.generic.monitoring.record_event){b.generic.monitoring.record_event("flash_persistence_failure",true);}}},clear_autoplay:function(){f({});}};})();})(window,document);(function(m,r,k){var j=m.ads_js_start?new Date().getTime()-m.ads_js_start:null,t=navigator.userAgent,c=/MSIE/.test(t),a=/Firefox/.test(t),l=m.generic,s={top_ad:"t",top_rhs:"tr"},d={injected_billboard:"top_ad",injected_navstrip:"top_ad",navboard:"top_ad"},w=r.all?function(z){return r.all[z];}:function(z){return r.getElementById(z);},i=function(z){return r.getElementsByTagName(z);},n=function(A){var z=(typeof A==="string"?w(A):A);if(z.src.length>0&&z.src.indexOf("www.imdb.com")===-1&&z.src.indexOf("javascript:")===-1){l.monitoring.record_event("iframe_not_sourceless_fdoc",false);return;}return z.contentWindow?z.contentWindow.document:z.contentDocument;},o=function(z){return w(z);},v=function(z){return w(z+"_wrapper");},q=function(A,B,z){if(A.attachEvent){A.attachEvent("on"+B,function(){z.apply(A,arguments);});}else{A.addEventListener(B,z,false);}},f=Math.random()*10000000000000000,y="/images/a/ifb/doubleclick/indirect.html",p={},x={};var h=(function(){var I,F,D="as",G=function(){var K="{";if(F){if("h" in F){K+=B("h");}if(("h" in F)&&("n" in F)){K+=",";}if("n" in F){K+=B("n");}}K+="}";l.cookie.set(D,K,l.days_to_midnight||1);},B=function(L){var K="";jQuery.each(F[L],function(M,N){K+='"'+M+'":['+C(N[0])+","+C(N[1])+"],";});return'"'+L+'":{'+K.substr(0,K.length-1)+"}";},z=function(){var K=l.cookie.get(D);if(K){try{F=jQuery.parseJSON(K);I=I||F||{};}catch(L){I=I||(F={});}}},C=function(L){var K=parseInt(L,10);return isFinite(K)?K:0;},E=function(){return(r.location.pathname==="/")?"h":"n";},A=function(L,M){var K=ad_utils.get_ad_object(L[0]);return((L.css("display")==="none")?0:parseInt(K.w,10));},J=function(M,O){var N=0,L=ad_utils.get_ad_object(M[0]),K=parseInt(L.h,10);if(O==="top_ad"){if(jQuery("#nb20").hasClass("banner")){N=-5;}else{if(jQuery("#nb20").hasClass("supertab")){N=-15;}}}else{if(O==="injected_billboard"){N=20;}}if("swfAutoMaxHeight" in M[0].contentWindow){K=M[0].contentWindow.swfMinHeight;}return((M.css("display")==="none"||K===0)?0:K+N);},H={top_ad:"t",top_rhs:"tr",injected_navstrip:"in",injected_billboard:"ib"};return{store:function(){l.on_document_ready(function(M){var L;try{z();F=F||{};L=F[E()]||{};M.each(H,function(P,O){var N=M("#"+P);if(N.length!==0){L[O]=[A(N,P),J(N,P)];}});F[E()]=L;G();}catch(K){consoleLog("Failed to store ad size cookie "+K.toString(),"ads");}});}};})();var b=(function(){var A=function(B,C){var D=n(B);if(!a){D.open("text/html","replace");}D.write("<body>"+C+"<script>document.close()<\/script></body>");},z=function(D,E){var C="__srcless_"+Math.floor(Math.random()*68719476735).toString(36),B="<body><script>document.write(parent.ad_utils."+C+");delete parent.ad_utils."+C+";<\/script></body>";ad_utils[C]=E;D.src="javascript:unescape('"+escape(B)+"')";};return{inject_slot:function(C,D){var F=C.id,B=C.getAttribute("data-dart-params")||"",E='<style>body{background:transparent;}</style><script type="data-doubleclick" src="http://ia.media-imdb.com/images/G/01/mobile/blank_pixel._V137875076_.gif'+B+'"><\/script>'+D+'<script>document.write("<script defer>parent.ad_utils.ad_table.'+F+'.fired=true;<\\/script>");<\/script>';if(c){z(C,E);}else{A(C,E);}}};})();this.ad_utils={ord:f,regenerateOrd:function(){consoleLog("Regenerating Client Side Ord","ads");f=Math.random()*10000000000000000;ad_utils.ord=f;},ad_table:{},ad_queue:[],low_latency_punt_ads:{},blank_ad_code:"<script>document.ad={h:0,w:0,scope:'blank'}<\/script>",slots_on_page:null,get_slot_iframe:o,setup_slot_metrics:function(z){ad_utils.slot_events.listen(z,"iframe request reflow tagdeliver load",function(C){var B=C.data.duration,A=C.data.timestamp;if(B===k&&A){B=csm.duration(A);}l.monitoring.update_slot_metrics(C.slot,C.event,B);});ad_utils.slot_events.listen(z,"request",function(A){var B=A.slot;l.monitoring.start_timing(B);});ad_utils.slot_events.listen(z,"request tagdeliver",function(C){var D=C.slot,B=ad_utils.inject_ad.get_injectable_slots(D),A;for(A=0;A<B.length;A++){ad_utils.slot_events.trigger(B[A],C.event,C.data);}});ad_utils.slot_events.listen(z,"load",function(B){var A=B.data.type;if(!A){consoleError(B.slot+" loaded, but type was not reported");}else{l.monitoring.stop_timing(z,A,true);}l.monitoring.update_slot_metrics(B.slot,"trueload");});ad_utils.slot_events.listen(z,"punt",function(B){var A=B.event+"_"+B.data.type;l.monitoring.update_slot_metrics(B.slot,A);});},register_ad:function(z){ad_utils.setup_slot_metrics(z);ad_utils.slot_events.trigger(z,"iframe");this.ad_table[z]={slot:z};},gpt:(function(){var A=null,z=[];return{handle_response:function(B){var C;A=B;for(C=0;C<z.length;C++){this.render_ad(z[C]);}},render_ad:function(F){var C,E,D,B;if(!A){z.push(F);return;}C=A[F]||{};E=o(F);D=C._html_||"";B=E.getAttribute("data-roadblocked")!==null;if(B){D="<!-- roadblocked -->"+ad_utils.blank_ad_code;ad_utils.slot_events.trigger(F,"request",{duration:0});}b.inject_slot(E,D);}};})(),expand_ad:function(F){var M=this,K=F.id,I=F.height,L=F.width;if("expand_called" in this.ad_table[K]){return;}var G=v(K),C=G.id,H=this.get_ad_object(F),J=w(K+"_before"),A=w(K+"_after"),B,E=csm.duration(),D,z=w(K+"_reflow_helper"),N=z?z.offsetTop:null;if((K+"_wrapper")!==C){if(!l.has_document_readied()){l.on_document_ready(function(){M.expand_ad(F);});return;}}if(!this.ad_table||!this.ad_table[K]){return;}else{this.ad_table[K].expanded=1;}if(H){if(!r.ads){r.ads={};}r.ads[H.cid]=H;if("w" in H){F.width=parseInt(H.w,10);}if("h" in H){F.height=parseInt(H.h,10);}if("z" in H&&H.z){G.style.zIndex=H.z;G.style.position="relative";}if(H.st){this.expand_supertab(H);}else{if(H.bb){this.expand_billboard(H);}else{if(K==="top_ad"&&this.is_open(H)&&!H.clickroll&&!H.overlay){this.expand_top_banner();}}}if(H.wrap){this.expand_wrap(H);}if(H.bamf){this.expand_bamf(H,F);}if(H.inner_bamf){this.expand_inner_bamf(H);}if(H.relative_bamf){this.expand_relative_bamf(H);}if(this.is_open(H)){if(J){this.display_label(J);}if(A){this.display_label(A);}}else{this.collapse_ad(F);}if(H.styles){for(B in H.styles){l.override_style(B,H.styles[B].style);}}}this.ad_table[K].expand_called=1;l.on_document_ready(function(O){O(F).trigger("expand_ad");});if(I===F.height&&L===F.width){ad_utils.slot_events.trigger(K,"reflow",{duration:0});}else{setTimeout(function(){var P=(K==="top_ad"&&ad_utils.is_open(H)&&!H.st)?10:0,O=(z&&z.offsetTop===N+P);ad_utils.slot_events.trigger(K,"reflow",{duration:O?0:E});},10);}if(!(K in d)){if(!ad_utils.slot_events.has_fired(K,"tagdeliver")){ad_utils.slot_events.trigger(K,"tagdeliver",{duration:E});}}h.store();r.body.className=r.body.className;},get_ad_object:function(F){var K=F.id,C=n(F),H=null;try{H=C.ad;}catch(J){consoleLog("Cannot access ad parameters: "+J.toString(),"ads");}if(!H){var z=0;var M=0;var L=["img","object","embed","iframe"];var G,E,B;for(E in L){B=C.getElementsByTagName(L[E]);for(G=0;G<B.length;G++){var A=B[G],D,I;D=A.scrollWidth||A.width;I=A.scrollHeight||A.height;if(D&&D>1){z=Math.max(z,parseInt(D,10));}if(I&&I>1){M=Math.max(M,parseInt(I,10));}consoleLog(K+" : estimated size : "+D+","+I,"ads");}}H={w:z.toString(),h:M.toString(),pid:"",url:"",aid:"0",cid:"0"};if(z===0||M===0){H.scope="null";}}else{if(!("pid" in H)){H.pid="DFP";}}C.ad=H;return H;},get_cornerstone_ad_object:function(z){var A=s[z]+"adData";if("aanResponse" in top.document&&A in top.document.aanResponse){return top.document.aanResponse[A];}return null;},get_mapped_amazon_slot_name:function(z){return s[z]?s[z]:z;},clean_up_slot_metrics:function(z){var D=z.id,B=n(z),A=this.get_ad_object(z);try{l.monitoring.stop_timing(D,this.get_type_of_ad(A),true);}catch(C){consoleLog("stop_timing failed: "+C.toString(),"ads");}},on_ad_load:function(B){if(B.src.length>0&&B.src.indexOf("www.imdb.com")===-1&&B.src.indexOf("javascript:")===-1){l.monitoring.record_event("iframe_not_sourceless",false);return;}var F=B.id,D,A,C=this.ad_table[F],z;if(!C||!C.fired){consoleLog("deflected spurious onload event for "+F,"on_ad_load");return;}D=this.get_ad_object(B);A=this.get_type_of_ad(D);C.loaded=true;if(D.scope==="blank"||D.scope==="null"){if(B.getAttribute("data-original-width")==="0"&&B.getAttribute("data-original-height")==="0"){z=0;}else{z=l.monitoring.get_metric_value(F,"reflow");}}else{}try{if(!C.expanded){this.expand_ad(B);}}catch(E){consoleLog("Exception during expand_ad:"+E.message);}ad_utils.slot_events.trigger(F,"load",{duration:z,type:A});},is_open:function(z){return z&&"w" in z&&"h" in z&&z.w>0&&z.h>0&&z.scope!=="blank";},expand_supertab:function(B){var A=w("nb15"),z=w("nb20");if(A){A.className="supertab";}else{if(z){z.className="supertab";}}},expand_billboard:function(I){var ab=r,P=parent,C="injected_billboard",T=o(C),F=v(C),D=n(C),S=D.getElementsByTagName("body"),K=S.length===1?S[0]:D.createElement("body"),L=w("top_rhs_wrapper"),Z=L?(L.parentElement||L.parentNode):null,N=I.bb_close,J=I.bb_close_tracker,Y=I.bb_show,G=I.bb_show_tracker,R="ax",ac,aa,E,H,B,X=false;if(!F){return false;}F.className=(F.className?F.className+" ":"")+"billboard";function U(){var ag=l.cookie.get(R),ad=ag&&ag.split(/o|c/),ae=ag&&ag.split(/\d*/),ah={},af;if(ad&&ae){if(ae[0]===""){ae.shift();}for(af=0;af<ae.length;++af){ah[ad[af]]=ae[af];}}aa=ah;}function A(){var ae="",ad=new Date(),af,ag;for(ag in aa){if(aa.hasOwnProperty(ag)){ae+=ag+aa[ag];}}l.cookie.set(R,ae,l.days_to_midnight||1);}function M(ai,aj){var af=D.createElement("div"),ag=ai.getElementsByTagName(aj),ae,ah,ad="";while(ag.length>0){ah=ag[0];af.appendChild(ah);ad+=af.innerHTML;af.removeChild(ah);}return ad;}function Q(){if(parseInt(T.style.height,10)!==parseInt(D.ad.h,10)){T.contentWindow.minimize();}T.style.display="none";if(!L&&!X){l.on_document_ready(W);}else{z();}}function W(){V();z();}function V(){if(!X){L=w("top_rhs_wrapper");Z=L?(L.parentElement||L.parentNode):null;if(L){try{F.parentNode.removeChild(E);Z.insertBefore(E,L);E.style.marginRight="";E.style.marginTop="";}catch(ad){consoleLog("caught a duplicate call to attempt_reattach_show_ad_button","ads");}}}}function z(){if(Y!==k&&Y!==""){E.style.display="block";}U();aa[I.aid]="c";A();ac="";ac+=M(D,"object");ac+=M(D,"embed");ac+=M(D,"iframe");h.store();F.style.margin="0px";X=true;}function O(){E.style.display="none";T.style.display="block";U();aa[I.aid]="o";A();if(ac){K.innerHTML=ac+K.innerHTML;}D.getElementById("billboard_close_button").onclick=Q;h.store();F.style.margin="20px 19px";}E=ab.createElement("div");E.id="billboard_show_button";E.style.display="none";if(Z){Z.insertBefore(E,L);}else{ad_utils.slot_events.listen("top_rhs","iframe",function(){V();});E.style.marginRight="19px";E.style.marginTop="7px";F.parentNode.insertBefore(E,F);}if(I.bb===1){H=D.createElement("div");H.id="billboard_close_button";H.style.cssFloat="right";H.style.cursor="pointer";H.style.position="absolute";H.style.top=0;H.style.right=0;H.style.zIndex=5000000;H.innerHTML=N||"";H.onclick=function(){P.ad_utils.ns.get("billboard").close();};K.appendChild(H);P.ad_utils.ns.register("billboard","close",function(){Q();typeof J!=="undefined"&&J();});E.innerHTML=Y;E.onclick=function(){O();typeof G!=="undefined"&&G();};U();if(I.aid in aa&&aa[I.aid]==="c"){Q();}}return true;},expand_top_banner:function(){var z=w("nb15");if(z){z.className="banner";}else{w("nb20").className="banner";}},expand_bamf:function(B,z){var A=B.bamf;l.extend(z.style,A.style);},expand_inner_bamf:function(A){var z=A.inner_bamf;var B=w(z.targetId);if(B&&z.node){l.insert_after(z.node,B);}},expand_relative_bamf:function(B){var z=B.relative_bamf;var C=w(z.targetId);var A;if(z.relation==="insert_after"){A=l.insert_after;}else{if(z.relation==="insert_before"){A=l.insert_before;}else{if(z.relation==="insert_inside"){A=l.insert_inside;}}}if(C&&z.node){A(z.node,C);}},expand_wrap:function(A){if(!A.styles){A.styles={};}var z;if(A.sleeves){z={wrapper:{style:{background:A.wrap}},root:{style:{background:"none","box-shadow":"none"}},pagecontent:{style:{height:"100%"}}};}else{z={"styleguide-v2":{style:{background:A.wrap}},root:{style:{"background-color":"transparent","box-shadow":"none"}},pagecontent:{style:{height:"100%"}},nb20:{style:{background:"none"}}};}l.extend(A.styles,z);},expand_label:function(z){z.className=z.className.replace(/hidden/,"");},display_label:function(z){z.style.display="block";z.style.visibility="visible";},collapse_ad:function(z){var B=z.id,A=function(D){var C=w(D);if(C){C.style.display="none";}};z.style.display="none";A(B+"_wrapper");A(B+"_before");A(B+"_after");},get_type_of_ad:function(z){if(!z){return"null";}if(z.scope){return z.scope;}return"got_ad";},show_ad_feedback:function(H){function I(){C("#ad_feedback_"+H).remove();return false;}function D(R){var N=C(m),Q=C(r),P=(N.width()-300)/2+Q.scrollLeft(),O=(N.height()-320)/2+Q.scrollTop();R.css({top:O<0?0:O,left:P});}try{var C=jQuery,A=o(H),M=A.contentWindow,J=ad_utils.get_ad_object(A),L,F=M.location.hash.match(/#([^;]*);/),B={adId:(J?J.aid:""),cid:(J?J.cid:""),page_id:m.location.href.substr(0,255),pagesubtype:(F?F[1]:""),slot:H},z=B.adId+";"+B.cid+";"+B.slot,K=C("#ad_feedback_container"),E=0;C("div.dfp_slot iframe").each(function(){var P=this.id,O=this.contentDocument,N=ad_utils.get_ad_object(this);if(!(P in x)&&N){L=ad_utils.get_cornerstone_ad_object(P);if(L){x[P]={aid:L.adId,cid:L.creativeId,pid:L.adNetwork};}else{x[P]={aid:N.aid,cid:N.cid,pid:N.pid};}x[P].url=N.url;x[P].dim=N.w+"x"+N.h;}});C.each(x,function(N,O){B["slot_"+E]=N;B["cid_"+E]=O.cid;B["aid_"+E]=O.aid;B["pid_"+E]=O.pid;B["dim_"+E]=O.dim;B["url_"+E]=O.url;E++;});if(K.length===0){K=C('<iframe id="ad_feedback_container">');K.addClass("hidden").attr({name:"ad_feedback_container",scrolling:"no",frameborder:"no",marginheight:"0",marginwidth:"0",allowtransparency:"yes"});K[0].hide=function(){C(this).addClass("hidden");};K[0].show=function(){C(this).removeClass("hidden");};K[0].isHidden=function(){return K.hasClass("hidden");};C("body").append(K);}if(K.attr("src")===""||K.attr("ref")!==z){K.unbind().load(function(){K[0].show();D(K);C(this).unbind();}).attr("src","/ads/feedback#"+C.param(B)).attr("ref",z);}else{if(K[0].isHidden()){K[0].show();D(K);}else{K[0].hide();return false;}}}catch(G){consoleLog("ad feedback failure : "+G,"ads");I();}return false;},report_ad_data:function(D,B){var A=D,E,z={};if(A===top){return;}try{while(A.parent!==top){A=A.parent;}E=A.frameElement.id;}catch(C){consoleLog("could not determine ad slot: "+C);return;}$.each("aid cid pid url dom dim".split(" "),function(F,G){if(G in B){z[G]=B[G];}});x[E]=z;},ns:(function(){var B={},A=function(F,C,E){var D;if(typeof F==="string"){D=F;}else{D=F.frameElement.id;}z(D)[C]=E;},z=function(C){return(B[C]=B[C]||{});};return{register:A,get:z};})(),inject_ad:(function(){var B={},z={},C={},A=function(D){consoleLog(D,"inject_ad");};return{render:function(F){var D=o(F),E=B[F];if(!C[F]){A(F+" rendered");C[F]=1;ad_utils.ad_table[F]={slot:F,injected:true};if(E){b.inject_slot(D,E);}else{b.inject_slot(D,'<script>document.ad = {h:"0",w:"0",scope:"blank"}<\/script>');}}},register:function(F){var E=d[F],D=this;A(F+" registered");z[F]=1;if(B[F]){D.render(F);}else{ad_utils.slot_events.listen(E,"load",function(){D.render(F);});}ad_utils.setup_slot_metrics(F);ad_utils.slot_events.trigger(F,"iframe");},inject:function(E,D){A(E+" injected");B[E]=D;if(z[E]){this.render(E);}},get_injectable_slots:function(F){var D=[],E;for(E in d){if(d[E]===F){D.push(E);}}return D;}};})(),weblab:(function(){var z={};return{set_treatment:function(A,B){z[A]=B;},get_treatment:function(A){return z[A];}};})(),attach_aax_callback:function(A,z){z.aax_render_ad=function(B){if(B&&B.html){z.document.write(B.html);z.document.got_aax_ad="got_ad";}else{z.document.got_aax_ad="blank";}ad_utils.slot_events.trigger(A,"tagdeliver");};},inject_serverside_ad:function(D,C){var B=o(D),z=B.getAttribute("data-roadblocked")!==null,A=B.getAttribute("data-blank-serverside")!==null;ad_utils.slot_events.trigger(D,"request",{duration:0});if(z){C="<!-- roadblocked -->"+ad_utils.blank_ad_code;}else{if(A){C="<!-- blank -->"+ad_utils.blank_ad_code;}}b.inject_slot(B,C);},aax_render_ad:function(C){var A=o(C),z=A.getAttribute("data-aax-url"),B="<script>parent.ad_utils.attach_aax_callback('"+C+"', window);<\/script><script src=\""+z+'"><\/script>';A.onload=function(){var E=ad_utils.ad_table[C],D;if(!E||!E.fired){consoleLog("deflected spurious cornerstone onload event for "+C,"aax_render_ad");return;}if(n(A).got_aax_ad!=="got_ad"){A.style.display="none";D="blank";}else{D=frame_doc(A).got_aax_ad;}ad_utils.slot_events.trigger(C,"load",{type:D});};ad_utils.slot_events.trigger(C,"request");b.inject_slot(A,B);},register_punt_ad:function(C,B,z,A){this.low_latency_punt_ads[C]={w:B,h:z,markup:A};},inject_punt_ad:function(F,G){var C=F.frameElement,H=C.id,B=n(C),A=null,E=null,z=(B&&B.ad&&B.ad.aid)?B.ad.aid:"0",D=(B&&B.ad&&B.ad.cid)?B.ad.cid:"0";if(H in this.low_latency_punt_ads){A=this.low_latency_punt_ads[H];B.ad={w:A.w,h:A.h,pid:"",url:"",aid:z,cid:D};this.expand_ad(C);E=A.markup.replace(/\[PUNT_ORIGIN\]/,encodeURIComponent('{"punt_origin":"'+G+'"}'));B.write(E);ad_utils.slot_events.trigger(H,"punt",{type:"got_ad"});}else{ad_utils.slot_events.trigger(H,"punt",{type:"blank"});}},fp:(function(){return m.imdbads.frequencyCapping;})(),tandem:(function(){var z={};return{register_swf:function(A,B){consoleLog("Register swf: "+A+" "+B,"Tandem");if(z[B]){consoleError("swf already registered: "+A+" "+B,"Tandem");return false;}z[B]={id:A};},send_message:function(B,C,E){var D=z[B],A,G;consoleLog("Sending message: "+B+" "+C+" "+E,"Tandem");if(D){for(G in ad_utils.ad_table){if(n(G)&&n(G).getElementById(D.id)){A=n(G).getElementById(D.id);}}if(w(D.id)){A=w(D.id);}try{if(c){A.receiveTimelineMessage(E,C);}else{A.getElementsByTagName("embed")[0].receiveTimelineMessage(E,C);}return true;}catch(F){consoleError("Unable to call receiveTimelineMessage on: "+B,"Tandem");consoleError(F);return false;}}else{consoleError("Attempted message to : "+B+" before registered.","Tandem");return false;}}};})(),set_slots_on_page:function(z){ad_utils.slots_on_page=z;},ads_header:(function(){var A=false,z=[];return{on_done:function(C){if(A){try{C();}catch(B){consoleWarn(B);}}else{z.push(C);}},done:function(){var C;A=true;for(C=0;C<z.length;C++){try{z[C]();}catch(B){consoleWarn(B);}}z=null;}};})()};l.install(l,{should_jQuery_noConflict:(m.$&&!m.jQuery),one_way_send_record:[],insert_after:function(z,B){try{B.parentNode.insertBefore(z,B.nextSibling);}catch(A){B.parentNode.appendChild(z);}},insert_before:function(z,A){A.parentNode.insertBefore(z,A);},insert_inside:function(z,A){A.appendChild(z);},extend:function(z,B){var A;for(A in B){if(typeof B[A]==="object"){if(z[A]!==B[A]){if(typeof z[A]==="undefined"){z[A]={};}this.extend(z[A],B[A]);}}else{z[A]=B[A];}}},override_style:function(D,B,C){var z="#"+D,A;for(A in B){B[A]+=" !important";}l.add_json_style(z,B,C);},add_json_style:function(z,C,E,D){var B=z+"{",A;for(A in C){B+=A+":"+C[A]+";";}B+="}";l.add_css_style(B,E,D);},add_css_style:function(G,A,F){var B="css-style-generic",z=[B],D,H,E;if(!A||!A.length){A=B;}else{z.push(A);}if(!F){F="a";}for(E in z){if(!w(z[E])){D=r.createElement("style");D.setAttribute("type","text/css");D.id=z[E];i("head")[0].appendChild(D);}}D=w(A);if(D.styleSheet&&"cssText" in D.styleSheet){H=(F==="a"?D.styleSheet.cssText:"")+G;D.styleSheet.cssText=H;}else{H=(F==="a"?D.innerHTML:"")+G;try{D.innerHTML=H;}catch(C){D.innerText=H;}}},add_css_file:function(z,B){if(!B){B="css-file-generic";}var A=w(B);if(!A){A=r.createElement("link");A.setAttribute("type","text/css");A.rel="stylesheet";A.id=B;i("head")[0].appendChild(A);}A.href=z;},set:function(A,z){var B=A.split(":");if(B[0]==="cookie"){l.cookie.set(B[1],z);}else{l.cache.set(B[1],z);}},get:function(z){var A=z.split(":");if(A[0]==="cookie"){return l.cookie.get(A[1]);}else{return l.cache.get(A[1]);}},erase:function(z){var A=z.split(":");if(A[0]==="cookie"){return l.cookie.erase(A[1]);}else{return l.cache.erase(A[1]);}},cache:{set:function(z,A){p[z]=A;},get:function(z){return p[z];},erase:function(z){delete p[z];}},load_script:function(A){var z=r.createElement("script");z.type="text/javascript";z.src=A;i("head")[0].appendChild(z);},load_script_notify:function(C,z){var A=r.createElement("script"),B=false;A.type="text/javascript";A.src=C;A.onload=A.onreadystatechange=function(){var D=this.readyState;if((B)||(D&&D!=="complete"&&D!=="loaded")){return;}B=true;r.body.removeChild(A);if("function"===typeof(z)){z(C);}};r.body.appendChild(A);},one_way_send:function(z){imageObj=new Image(0,0);imageObj.src=z;this.one_way_send_record.push(imageObj);},load_when_visible:function(z,F){var C=0;var E=jQuery(m);var D=E.height()+E.scrollTop();if(jQuery("#"+z).length){var B=jQuery(jQuery("#"+z).get(0));var A=B.offset().top;if(D>A){F(z);}else{E.scroll(function(){D=E.height()+E.scrollTop();A=B.offset().top;if((D>A)&&!C){C=1;F(z);}});}}else{F(z);}},unload_plugins:function(){var E=[r],H,z,D,A,G,B,F=new RegExp("^("+location.protocol+"//"+location.hostname+")?(/.*)?$"),C=function(I){var J,K;for(J=I.length-1;J>=0;J--){K=I[J];K.parentNode.removeChild(K);}};while(E.length){H=E.pop();C(H.getElementsByTagName("object"));C(H.getElementsByTagName("embed"));D=H.getElementsByTagName("iframe");for(B=D.length-1;B>=0;B--){A=D[B];if(F.test(A.src)){G=n(A);if(G){E.push(G);}}else{C([A]);}}}},addEventListener:function(A,B,z){q(A,B,z);}});this.custom={amazon:{load_callback:function(z){return;}},indirect:{close:function(z){if(z.location.href.match("floater")){custom.floater.close(z.frameElement.id);}}},full_page:{style_id:"custom__full_page__generated_styles",data_url:"/images/a/js/graffiti_data.js",apply_fast:function(E,F){var B=this.styles[E.treatment],H,z,J,D=[],G,I,C,A;for(H in B){if(B.hasOwnProperty(H)){z=B[H];for(C=0;C<z.length;C++){J=z[C];G=F?null:J["default"];if(J.fixed){G=J.fixed;}else{if(J.name in E){G=E[J.name];}}if(G){if(typeof G==="string"){G=[G];}I="";for(A=0;A<G.length;A++){I+="  "+H+" : "+G[A]+(J.important?" !important":"")+";\n";}D.push(J.selector+"{\n"+I+"}\n");}}}}l.add_css_style(D.join("\n"),this.style_id,"o");},apply:function(A){var z=this;r.getElementById("root").style.boxShadow="none";m.generic.on_document_ready(function(){z.settings=A;if("styles" in z){z._apply();}else{m.generic.load_script_notify(z.data_url,function(){z._apply();});}});},_apply:function(){var B,C=this.settings.ARGS.split(/&/),A={},z=this,E="/* ARGS:"+this.settings.ARGS+" */\n";jQuery.each(C,function(G,H){var F=/^(.*)=(.*)$/.exec(H);if(F.length===3){A[F[1]]=unescape(F[2].replace(/\+/g," "));}});B=this.invert_styles(A.treatment);jQuery.each(B,function(F,G){if(G.fixed){E+=z.format_css(G,G.fixed);}else{if(A[F]||G["default"]){E+=z.format_css(G,A[F]);}}});try{jQuery("style#"+this.style_id).remove();jQuery("head").append(jQuery('<style type="text/css">').attr("id",this.style_id).html(E));}catch(D){l.add_css_style(E,this.style_id,"o");}},invert_styles:function(A){var B=["default","important","fixed"],z={};jQuery.each(this.styles[A],function(D,C){jQuery.each(C,function(E,F){var G=z[F.name]={style:D,selector:F.selector};jQuery.each(B,function(I,H){if(F[H]){G[H]=F[H];}});});});return z;},format_css:function(z,A){return z.selector+" { "+z.style+" : "+(A?A:z["default"])+(z.important?" !important;":";")+"}\n";}},floater:{close:function(z){l.extend(w(z),{style:{width:"0px",height:"0px"}});},launch:function(z,H,E,F,D,B,A){var C=r.createElement("iframe"),G=typeof F==="string"?w(F):F;if(E!=="none"){setTimeout(function(){custom.floater.close(A);},E*1000);}l.extend(C,{id:A,name:A,src:z,width:H[0]+"px",height:H[1]+"px",frameBorder:"0",scrolling:"no",allowTransparency:"true",style:{marginLeft:B[0]+"px",marginTop:B[1]+"px",zIndex:B[2],position:"absolute"}});D(C,G);},set:function(D,B,C,z,A,F){var E=Math.ceil(Math.random()*9999999),G="floater_"+E;l.cache.set(G,D);custom.floater.launch(y+"?source=cache:"+G,B,C,z,A,F,G);return G;}},css:{inject_css:function(A,z){m.generic.on_document_ready(function(){var B=A.getElementById(z),C=r.head;l.insert_inside(B,C);});}}};var g=function(z,A){return((A))?'<param name="'+z+'" value="'+A+'">':"";};var u=function(z,A){return((A))?" "+z+'="'+A+'" ':"";};this.flashAdUtils={makeFlashAd:function(G){var R=G.id,H=G.src,S=G.width,J=G.height,L=G.bgcolor,ac=G.wmode||"opaque",I=G.salign,ae=G.scale,aa=G.extraParams,ab=G.extraTAGs,U=G.minVersion,z=escape(G.clickThru),Z=G.clickTAGs,C=function(ag){return ag!==null&&ag!==k&&(ag+"").length;},Y=function(ag){return isFinite(parseInt(ag,10));},E="",X,af,M;if(!C(R)||!C(H)||!Y(S)||!Y(J)){consoleLog("makeFlashAd: Missing required params","flashAdUtils");return;}if(!flashAdUtils.canPlayFlash(U)){consoleLog("makeFlashAd: Current flash version too low","flashAdUtils");}if((Z)){for(X=0;X<Z.length;X++){if(Z[X]){E=E+"&clickTAG"+(X+1)+"="+escape(Z[X]);}}}if((ab)){for(af in ab){E=E+"&"+escape(af)+"="+escape(ab[af]);}}E+="&ord="+ad_utils.ord;if(r.getElementById("navbar")){if(r.getElementById("megaMenu")){E+="&navbar=mega";}else{E+="&navbar=legacy";}}else{E+="&navbar=null";}var A="";var P="";try{var O={width:1,height:1,src:1,bgcolor:1,wmode:1,salign:1,scale:1,flashvars:1};for(M in aa){if(O[M]){continue;}A=A+g(M,aa[M]);P=P+u(M,aa[M]);}}catch(K){}var W=g("bgcolor",L);var F=u("bgcolor",L);var V=g("wmode",ac);var D=u("wmode",ac);var T=g("scale",ae);var B=u("scale",ae);var ad=g("salign",I);var N=u("salign",I);var Q='<object  classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"  codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0"  width="'+S+'"  height="'+J+'"  id="swf_'+R+'"><param name="movie" value="'+H+'"><param name="flashvars" value="env=WEB&clickTAG='+z+"&"+E+'"><param name="play" value="true"><param name="quality" value="high"><param name="allowScriptAccess" value="always">'+T+ad+W+V+A+'<div style="margin-left:0.1px"><embed src="'+H+'"  flashvars="env=WEB&clickTAG='+z+"&"+E+'"  quality="high"  play="true"  width="'+S+'"  height="'+J+'"  name="swf_'+R+'"  allowScriptAccess="always"  type="application/x-shockwave-flash"  pluginspage="http://www.macromedia.com/go/getflashplayer" '+B+N+F+D+P+"></embed></div></object>";return Q;},canPlayFlash:function(A){var E=false;var H=parseInt(A,10);if(!A||H<9){A=9;}else{A=H;}var z=(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"])?navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin:0;if(z&&navigator.plugins["Shockwave Flash"]){var J=navigator.plugins["Shockwave Flash"].description.split(" "),I,C;for(C=0;C<J.length;++C){if(isNaN(parseInt(J[C],10))){continue;}I=parseInt(J[C],10);}E=I>=A;}else{if(navigator.userAgent&&navigator.userAgent.indexOf("MSIE")>=0&&(navigator.appVersion.indexOf("Win")!==-1)){try{var D=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+A);D.AllowScriptAccess="always";var G=D.GetVariable("$version");var F=G.match(/([0-9]+)/);E=F[1]>=A;}catch(B){}}}return E;}};h.store();l.on_document_ready(function(A){var z;A(m).load(function(){h.store();});});l.on_document_ready(function(){q(m,"unload",function(){l.unload_plugins();});});if(j){l.on_document_ready(function(){l.monitoring.record_metric("ads_js_response",j);});}})(window,document);(function(b,a,d){var c=(b.custom=b.custom||{});c.strings=(function(){return{chained_replace:function(g){var j=this,f;for(f=0;f<g.length;f++){var h=g[f];j=j.replace(h[0],h[1]);}return j;}};})();})(window,document);(function(b,a,d){var c=(b.custom=b.custom||{});c.doubleclick=(function(){var k=[],f=[[/%3B/g,";"],[/%3D/g,"="],[/%2C/g,","],[/%3F/g,"?"]],i=/(\[|%5B)CLIENT_SIDE_ORD(\]|%5D)/g,m=/(\[|%5B)CLIENT_SIDE_KEYVALUES(\]|%5D)/,o="4215",l=function(r){r=r.replace(i,ad_utils.ord);r=r.replace(m,k.join(";"));return c.strings.chained_replace.call(r,f);},j=/\[PLAYLISTINDEX\]/,q=/\[PLAYLISTID\]/,h=/\[PLAYERTYPE\]/,p=/\[CLIENT_SIDE_ATTRIBUTE\]/g,n="http://www.amazon.com/aan/2009-05-01/imdb/default?slot=sitewide-iframe&u=[CLIENT_SIDE_ATTRIBUTE]&ord=[CLIENT_SIDE_ATTRIBUTE]",g=false;return{ord_regex:i,construct_url:function(s){var r=(s.match(";ifb=pf;"))?"pfadj":"adj";var t=escape(s.substring(1,s.length));t=l(t);return a.location.protocol+"//ad.doubleclick.net/N"+o+"/"+r+"/"+t;},construct_video_url:function(s,r){if(g){ad_utils.regenerateOrd();}var t=n.replace(p,ad_utils.ord);(new Image()).src=t;g=true;s=s.replace(i,ad_utils.ord);s=s.replace(m,k.join(";"));s=s.replace(j,"vi%3D"+(r.listindex||"0"));s=s.replace(q,r.list?"vl%3D"+r.list:"");s=s.replace(h,"vt%3D"+r.playertype);s=s.replace(p,ad_utils.ord);return a.location.protocol+"//pubads.g.doubleclick.net/gampad/ads?iu=/"+o+"/"+s;},add_client_side_keyvalue:function(r,s){k.push(r+"="+s);}};})();})(window,document);(function(b){var g={},f={},d=function(j,n,k,l){var m=new c(n,k,l?l:{});try{j(m);}catch(i){consoleError(i);}},a=function(j,i){return j+":"+i;},c=function(k,i,j){this.slot=k;this.event=i;this.data=j;},h=function(i,j){return(function(){if(--j===0){i.apply(this,arguments);}});};b.slot_events={listen:function(p,l,m){var j=l.replace(/(^\s+|\s+$)/g,"").split(/\s+/),o,n,k;for(k=0;k<j.length;k++){n=j[k];o=a(p,n);if(o in f){d(m,p,n,f[o]);}else{(g[o]=g[o]||[]).push(m);}}return this;},listen_all:function(l,m,k){var n=h(k,l.length),j;for(j=0;j<l.length;j++){this.listen(l[j],m,n);}},trigger:function(o,l,m){var n=a(o,l),k=g[n]||[],j;if(n in f){generic.monitoring.record_event(n+"_already_fired",false);consoleError("attempted to fire "+n+", but it has already fired!");return;}f[n]=m;for(j=0;j<k.length;j++){d(k[j],o,l,m);}return this;},has_fired:function(j,i){return a(j,i) in f;}};})(window.ad_utils);(function(a){a.install(a,{extended_split:function(h,g,b){var d=[],c=0,f;while(!b||d.length<b-1){f=h.indexOf(g,c);if(f===-1){break;}d.push(h.substring(c,f));c=f+g.length;}d.push(h.substring(c));return d;},object_from_querystring:function(g){var d=g.split("&"),f={},b,c;if(g===""){return{};}for(b=0;b<d.length;b++){c=a.extended_split(d[b],"=",2);f[c[0]]=(c.length===1)?null:decodeURIComponent(c[1]);}return f;},cookie:{set:function(g,i,j){var c,b,f,h;if(j){var d=new Date();d.setTime(d.getTime()+(j*24*60*60*1000));c="; expires="+d.toGMTString();}else{c="";}b=document.location.host.split(".");f=b.pop();h=b.pop();document.cookie=g+"="+escape(i)+c+"; path=/; domain="+h+"."+f;},get:function(c){var b=document.cookie.split(";"),d,f;for(d=0;d<b.length;d++){if(typeof b[d]!=="string"){continue;}f=b[d].split("=");if(f[0]&&f[1]&&f[0].replace(/\s/,"")===c){return unescape(f[1]);}}return null;},erase:function(b){this.set(b,"",-1);}}});})(window.generic);(function(j,n,f){var o=(j.generic=j.generic||{}),c={},k=j.IMDbTimer,b=("IMDbTimer" in j)?j.IMDbTimer.starttime:NaN,p=n.location.hash.match("debug=1"),i=p||(!isNaN(b)&&Math.random()<0.25),h=p||(Math.random()<0.25),m="none",g="1P";ad_slots=(function(){var q={},u={},r={top_ad:1,top_rhs:1,injected_navstrip:1,injected_billboard:1,navboard:1,bottom_ad:2,middle_rhs:2,btf_rhs2:2,rhs_cornerstone:2},v={top_ad:1,top_rhs:1,bottom_ad:1},s={reflow:1,"ad-delivery":1,load:1},t={};o.on_document_ready(function(w){w(j).bind("beforeunload",function(){var y,x;for(y in q){x=q[y];if(x.request&&x.load===f){o.monitoring.record_event("ad_load_failure."+y);}}o.monitoring.send_metrics();});});return{is_slot_monitored:function(w){return(w in r)||(w in v);},is_twilight_slot:function(w){return(w in r);},is_twilight_core_slot:function(w){return(w in r&&r[w]===1);},is_forester_slot:function(w){return(w in v);},is_forester_event:function(x,w){return this.is_forester_slot(x)&&w in s;},set_metric_value:function(y,w,x){(q[y]=q[y]||{})[w]=x;},get_metric_value:function(x,w){if(x in q){return q[x][w];}},core_slots:function(){var x={},w;for(w in r){if(r[w]===1){x[w]=1;}}return x;},record_slot_status:function(x){var w=x.match(/^(.*)\.(got_ad|null|blank|fail)$/);if(w){t[w[1]]=w[2];}},core_slots_have_an_ad:function(){var x,w=false;for(x in ad_slots.core_slots()){if(!(x in t)){return null;}if(t[x]==="got_ad"){w=true;}}return w;},set_partner:function(x,w){u[x]=w;return this;},get_partner:function(w){return u[w];},set_remnant_partner:function(x,w){return ad_slots.set_partner(x,w);},get_remnant_partner:function(w){return ad_slots.get_partner(w);}};})();var l="http://www.imdb.com/twilight/?";var d=(function(){var r=(function(){var t="DART";return{prepare_and_send_metric:function(u,x,w,v){s({slot:x,ad_network_name:t,aid:u.aid,cid:u.cid,slot_event:w,time:v});}};})(),q=(function(){var t="PDA",v=20,u=100;return{prepare_and_send_metric:function(B,A,z){var y,x=v,w;w=function(){y=ad_utils.get_cornerstone_ad_object(B);if(y){s({slot:B,ad_network_name:t,aid:y.adId,cid:y.creativeId,slot_event:A,time:z});}else{if(--x){setTimeout(w,u);}else{}}};w();}};})(),s=function(x){var B,y,F,z,t,u,D,C,w,E,A;if(!h||!ad_slots.is_forester_slot(x.slot)){return;}B="http://fls-na.amazon.com/1/display-ads-cx/1/OP/?";y="LMET";F="imdb";z=ad_utils.get_mapped_amazon_slot_name(x.slot);t=page_type;u=x.ad_network_name;D=x.aid;C=x.cid;E=x.time;w=x.slot_event;A='{"s":"'+F+'","l":"'+z+'","p":"'+t+'","n":"'+u+'","a":"'+D+'","c":"'+C+'","m":"'+w+'","v":"'+E+'"}';if(p){consoleLog(A+" metrics sent","forester");}o.one_way_send(B+y+escape(A));};return{send_forester_metric:function(t,w,v,u){r.prepare_and_send_metric(t,w,v,u);q.prepare_and_send_metric(w,v,u);},set_page_type:function(t){page_type=t;}};})();this.csm=(function(){var q={};return{measure:function(s,r){this.record(s,this.duration(),r);},record:function(t,x,r,s){var v=q[t],u;if(i&&!csm.metrics[t]){o.monitoring.record_metric(t+(s?s:""),x,r);}csm.metrics[t]=x;if(v){for(u=0;u<v.length;u++){try{v[u](x,t);}catch(w){consoleLog("error invoking callback for "+t,"csm");}}delete q[t];}},duration:function(r){return(r?r:+new Date())-b;},listen:function(r,s){if(r in csm.metrics){setTimeout(s,0);}else{(q[r]=q[r]||[]).push(s);}},metrics:{}};})();o.monitoring={event_starts:{},event_stops:{},events_to_stop:0,event_duration:{},event_counters:[],all_events_started_flag:false,twilight_info:"",twilight_client:(function(){var r=navigator.userAgent,q;q=r.match(/MSIE (\d+)/);if(q&&q[1]>=6){return"ie"+q[1];}q=r.match(/Mac OS.*Firefox\/(\d+)/);if(q){return q[1]==="3"?"firefox3-mac":"firefox-mac";}q=r.match(/Firefox\/(\d+)/);if(q){return q[1]==="3"?"firefox3":"firefox";}if(r.indexOf("Chrome")!==-1){return"chrome";}if(r.indexOf("Safari")!==-1){return"safari";}if(r.indexOf("Opera")!==-1){return"opera";}return"Other";})(),isTwilightActiveSample:i,page_type:"",start_timing:function(q){this.start_timing_at(q,new Date().getTime());},start_timing_at:function(q,r){this.event_starts[q]=r;this.events_to_stop++;},stop_timing:function(s,r,q){var u=new Date().getTime(),t=s;if(!this.event_starts[s]){return;}this.event_stops[s]=u;if(r){t+="."+r;}this.record_metric(t,u-this.event_starts[s]);delete this.event_starts[s];this.events_to_stop--;if(q||(this.all_events_started_flag&&this.events_to_stop===0)){this.send_metrics();}},record_event:function(s,q){var r;this.event_counters.push(s);if(s in c){for(weblab in c[s]){r=s+"__weblab_"+weblab;this.event_counters.push(r);consoleLog(r,"twilight");}}consoleLog(s,"twilight");if(q){this.send_metrics();}},record_metric:function(t,u,q){var s,r;ad_slots.record_slot_status(t);this.event_duration[t]=u;consoleLog(t+","+u,"twilight");if(t in c){for(s in c[t]){r=t+"__weblab_"+s;this.event_duration[r]=u;consoleLog(r+","+u,"twilight");}}if(q){this.send_metrics();}},send_metrics:function(){var r=l+this.twilight_info,t,v=[],q=0,z="",x=function(A,B){v.push(function(){q++;return"&Operation."+q+"="+A+"&OperationTiming."+q+"="+B;});},w=function(A){v.push(function(){q++;return"&Counter."+q+"="+A;});},s=function(){if(z.length){o.one_way_send(r+z+"&ord="+ad_utils.ord);consoleLog("metrics sent ("+q+")","twilight");z="";q=0;}},y=1700,u;for(t in this.event_duration){x(t,this.event_duration[t]);}this.event_duration={};for(u=0;u<this.event_counters.length;u++){w(this.event_counters[u]);}this.event_counters=[];for(u=0;u<v.length;u++){z+=v[u]();if(z.length+r.length>y){s();}}s();},set_twilight_info:function(r,q,v,s,u,t){if(k&&k.pt==="java"){r+=".java";}this.twilight_info="PageType="+r+"&Geo="+q+"&tw_ord="+v+"&timestamp="+s+"&Client="+this.twilight_client+"&Site="+t;l=u;},set_forester_info:function(q){d.set_page_type(q);},all_events_started:function(){this.all_events_started_flag=true;},set_partner:function(r,q){var s=r.frameElement.id;ad_slots.set_partner(s,q);},get_partner:function(q){return ad_slots.get_partner(q)||m;},set_remnant_partner:function(r,q){o.monitoring.set_partner(r,q);},get_remnant_partner:function(q){return o.monitoring.get_partner(q);},set_remnant_partner_fallback:function(s,r){var q=ad_slots.get_partner(s);if(typeof(q)==="undefined"){ad_slots.set_partner(s,r);}else{ad_slots.set_partner(s,q+"_"+r);}},update_slot_metrics:function(x,t,u){var w,v,s=ad_utils.get_slot_iframe(x),q=s?s.contentWindow.document.ad:null,r="."+o.monitoring.get_partner(x);if(!(x)||!ad_slots.is_slot_monitored(x)||ad_slots.get_metric_value(x,t)!==f){return;}ad_slots.set_metric_value(x,t,(f!==u)?u:csm.duration());v=ad_slots.get_metric_value(x,t);if(q&&ad_slots.is_forester_event(x,t)){d.send_forester_metric(q,x,t,v);if(t==="load"){d.send_forester_metric(q,x,"ad-delivery",ad_slots.get_metric_value(x,"load")-ad_slots.get_metric_value(x,"request"));}}if(ad_slots.is_twilight_slot(x)){csm.record("csm_"+x+"_"+t,v,0,r);if("load"===t&&"."+m!==r&&"."+g!==r){csm.record("csm_"+x+"_deliver",v-ad_slots.get_metric_value(x,"tagdeliver"),0,r);}if(ad_slots.is_twilight_core_slot(x)){a.send(t);}}},get_metric_value:function(r,q){return ad_slots.get_metric_value(r,q);},enable_weblab_metrics:function(r,q,u){var t,s;for(t=0;t<u.length;t++){s=u[t];c[s]=c[s]||{};c[s][r+"_"+q]=1;}}};o.on_document_ready(function(r){var q;r(j).bind("beforeunload",function(s){var t=(n.location+"").split("#",2)[0];j.name="clicktoresponse:"+(new Date()).getTime()+":"+t;});if(!o.monitoring.isTwilightActiveSample){return;}csm.measure("csm_ready");r(j).load(function(){csm.measure("csm_load",true);});r("div.dfp_slot").each(function(){o.monitoring.record_event("dfp_slot");});q=parseInt(r("#servertime").attr("time"),10);if(!isNaN(q)){o.monitoring.record_metric("csm_server",q);}});(function(){if(n.location.protocol==="http:"){var q=j.name.match(/^clicktoresponse:(\d+):(.*)$/),r;if(q){if(n.referrer===q[2]&&k){r=k.starttime-q[1];k.clicktoresponse=r;o.monitoring.record_metric("click_to_response",r);}j.name="";}}})();var a=(function(){var u,q=[],r=ad_slots.core_slots(),t=function(){var v;if(!s){s=true;consoleLog("Finalized core ads on current page: "+q.join(","));for(v in events_to_send_once_finalized){a.send(v);}}},s=false;events_to_send_once_finalized={};for(u in r){ad_utils.slot_events.listen(u,"iframe",function(v){q.push(v.slot);if(q.length===r.length){t();}});}o.on_document_ready(t);return{send:function(w){var y=0,x,v;if(s){for(v=0;v<q.length;v++){x=ad_slots.get_metric_value(q[v],w);if(f===x){return;}y=Math.max(y,x);}csm.record("csm_core_ads_"+w,y);}else{events_to_send_once_finalized[w]=1;}}};})();})(window,document);if(window.IMDbTimer&&window.IMDbTimer.events){(function(c,b,a){generic.send_csm_head_metrics=function(){c.record("csm_head_pre_title",a.csm_head_pre_title-b);c.record("csm_head_post_title",a.csm_head_post_title-b);c.record("csm_head_pre_css",a.csm_head_pre_css-b);c.record("csm_head_post_css",a.csm_head_post_css-b);c.record("csm_head_pre_icon",a.csm_head_pre_icon-b);c.record("csm_head_post_icon",a.csm_head_post_icon-b);c.record("csm_head_pre_ads",a.csm_head_pre_ads-b);};})(csm,IMDbTimer.starttime,IMDbTimer.events);}(function(f,b){var g="top_ad injected_billboard injected_navstrip top_rhs middle_rhs btf_rhs2 rhs_cornerstone bottom_ad".split(" "),m="top_ad top_rhs injected_navstrip injected_billboard navboard".split(" "),n,o=ad_utils.slot_events,j=function(i){consoleLog(i,"ads-amazon-csm");},c={},l={},h={},a={},d=window.ue_t0,k;if(typeof f!=="function"||typeof b!=="function"){j("uet() / uex() not available, will not record CSM metrics");return;}for(k=0;k<g.length;k++){(function(i){o.listen(i,"iframe",function(){c[i]=new Date().getTime();f("bb",i,{wb:1});});o.listen(i,"request",function(){l[i]=new Date().getTime();f("be",i,{wb:1});});o.listen(i,"tagdeliver",function(){h[i]=new Date().getTime();f("af",i,{wb:1});});o.listen(i,"reflow",function(q){var p=new Date().getTime();if(q.data.duration===0&&d){p=d+10;}a[i]=p;f("cf",i,{wb:1},p);});o.listen(i,"load",function(){var q=generic.monitoring.get_remnant_partner(i),p=i+"."+q;if(q!=="none"){f("bb",p,{wb:1},c[i]);f("be",p,{wb:1},l[i]);f("af",p,{wb:1},h[i]);f("cf",p,{wb:1},a[i]);b("ld",p,{wb:1});}b("ld",i,{wb:1});});})(g[k]);}ad_utils.ads_header.on_done(function(){var p=[],i=function(s){var r,q=0;for(r in s){q=Math.max(q,s[r]);}return q;};for(k=0;k<m.length;k++){n=m[k];if(n in ad_utils.slots_on_page){p.push(n);}}j("determined core_slots: "+p.join(","));o.listen_all(p,"iframe",function(){f("bb","core_ads",{wb:1},i(c));});o.listen_all(p,"request",function(){f("be","core_ads",{wb:1},i(l));});o.listen_all(p,"tagdeliver",function(){f("af","core_ads",{wb:1},i(h));});o.listen_all(p,"reflow",function(){f("cf","core_ads",{wb:1},i(a));});o.listen_all(p,"load",function(){b("ld","core_ads",{wb:1});});});})(window.uet,window.uex);(function(){var a=function(c){try{c();}catch(b){consoleError(b.message,"imdbads.cmd");}};window.imdbads=window.imdbads||{};imdbads.cmd=imdbads.cmd||[];ad_utils.ads_header.on_done(function(){var c=0,b=imdbads.cmd||[];for(c=0;c<b.length;c++){a(b[c]);}imdbads.cmd={push:function(d){a(d);}};});})();(function(b,a,c){this.custom.parallax={init:function(d){b.generic.on_document_ready(function(){var h=d.getElementById("parallax"),k=a.getElementById("root");generic.insert_before(h,k);var f=d.getElementById("skrollr_core_src").innerHTML;a.getElementById("skrollr_core_dest").innerHTML=f;if(b.skrollr){b.skrollr.init({mobileCheck:function(){return false;},smoothScrolling:true});}for(var g=1;g<=10;g++){var j=a.getElementById("parallax_layer"+g);if(j){custom.parallax.seen["parallax_layer"+g]={obj:j,seen:false};}}a.addEventListener("scroll",custom.parallax.scrollListener);});},seen:{},interactionTrackers:{},scrollListener:function(){var g,d;for(var f=1;f<=10;f++){g=custom.parallax.seen["parallax_layer"+f];if(g&&!g.seen){d=(g.obj.getBoundingClientRect().top-a.documentElement.clientHeight)<-100;if(d){(new Image()).src=custom.parallax.interactionTrackers["parallax_layer"+f];g.seen=true;}}}}};})(window,document);(function e(b,g,d){function c(m,j){if(!g[m]){if(!b[m]){var i=typeof require=="function"&&require;if(!j&&i){return i(m,!0);}if(a){return a(m,!0);}var k=new Error("Cannot find module '"+m+"'");throw k.code="MODULE_NOT_FOUND",k;}var h=g[m]={exports:{}};b[m][0].call(h.exports,function(l){var o=b[m][1][l];return c(o?o:l);},h,h.exports,e,b,g,d);}return g[m].exports;}var a=typeof require=="function"&&require;for(var f=0;f<d.length;f++){c(d[f]);}return c;})({1:[function(b,c,a){(function(Q,p){var l={version:"v2.2.4",settings:{}},h=0,N="riot-",K=N+"tag",H="string",j="object",X="undefined",aa="function",g=/^(?:opt(ion|group)|tbody|col|t[rhd])$/,o=["_item","_id","update","root","mount","unmount","mixin","isMounted","isLoop","tags","parent","opts","trigger","on","off","one"],u=(Q&&Q.document||{}).documentMode|0,x=Array.isArray;l.observable=function(ad){ad=ad||{};var ae={},ac=0;ad.on=function(af,ag){if(s(ag)){if(typeof ag.id===X){ag._id=ac++;}af.replace(/\S+/g,function(ah,ai){(ae[ah]=ae[ah]||[]).push(ag);ag.typed=ai>0;});}return ad;};ad.off=function(af,ag){if(af=="*"){ae={};}else{af.replace(/\S+/g,function(aj){if(ag){var ai=ae[aj];for(var ak=0,ah;(ah=ai&&ai[ak]);++ak){if(ah._id==ag._id){ai.splice(ak--,1);}}}else{ae[aj]=[];}});}return ad;};ad.one=function(ag,ah){function af(){ad.off(ag,af);ah.apply(ad,arguments);}return ad.on(ag,af);};ad.trigger=function(ag){var af=[].slice.call(arguments,1),ai=ae[ag]||[];for(var ah=0,aj;(aj=ai[ah]);++ah){if(!aj.busy){aj.busy=1;aj.apply(ad,aj.typed?[ag].concat(af):af);if(ai[ah]!==aj){ah--;}aj.busy=0;}}if(ae.all&&ag!="all"){ad.trigger.apply(ad,["all",ag].concat(af));}return ad;};return ad;};l.mixin=(function(){var ac={};return function(ae,ad){if(!ad){return ac[ae];}ac[ae]=ad;};})();(function(af,al,ah){if(!ah){return;}var ag=ah.location,am=af.observable(),aj=false,ai;function ae(){return ag.href.split("#")[1]||"";}function ad(an){return an.split("/");}function ak(an){if(an.type){an=ae();}if(an!=ai){am.trigger.apply(null,["H"].concat(ad(an)));ai=an;}}var ac=af.route=function(an){if(an[0]){ag.hash=an;ak(an);}else{am.on("H",an);}};ac.exec=function(an){an.apply(null,ad(ae()));};ac.parser=function(an){ad=an;};ac.stop=function(){if(aj){if(ah.removeEventListener){ah.removeEventListener(al,ak,false);}else{ah.detachEvent("on"+al,ak);}am.off("*");aj=false;}};ac.start=function(){if(!aj){if(ah.addEventListener){ah.addEventListener(al,ak,false);}else{ah.attachEvent("on"+al,ak);}aj=true;}};ac.start();})(l,"hashchange",Q);var d=(function(ag){var af,ae,ac,ad=/[{}]/g;return function(ah){var ai=l.settings.brackets||ag;if(af!==ai){af=ai;ac=ai.split(" ");ae=ac.map(function(aj){return aj.replace(/(?=.)/g,"\\");});}return ah instanceof RegExp?(ai===ag?ah:new RegExp(ah.source.replace(ad,function(aj){return ae[~~(aj==="}")];}),ah.global?"g":"")):ac[ah];};})("{ }");var q=(function(){var ad={},ag='"in d?d:'+(Q?"window).":"global)."),af=/(['"\/])(?:[^\\]*?|\\.|.)*?\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function\s*\()|([A-Za-z_$]\w*)/g;return function(al,ak){return al&&(ad[al]||(ad[al]=ac(al)))(ak);};function ac(ak,al){if(ak.indexOf(d(0))<0){ak=ak.replace(/\n|\r\n?/g,"\n");return function(){return ak;};}ak=ak.replace(d(/\\{/g),"\uFFF0").replace(d(/\\}/g),"\uFFF1");al=ae(ak,ai(ak,d(/{/),d(/}/)));ak=(al.length===2&&!al[0])?aj(al[1]):"["+al.map(function(an,am){return am%2?aj(an,true):'"'+an.replace(/\n|\r\n?/g,"\\n").replace(/"/g,'\\"')+'"';}).join(",")+'].join("")';return new Function("d","return "+ak.replace(/\uFFF0/g,d(0)).replace(/\uFFF1/g,d(1))+";");}function aj(ak,al){ak=ak.replace(/\n|\r\n?/g," ").replace(d(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),"");return/^\s*[\w- "']+ *:/.test(ak)?"["+ai(ak,/["' ]*[\w- ]+["' ]*:/,/,(?=["' ]*[\w- ]+["' ]*:)|}|$/).map(function(am){return am.replace(/^[ "']*(.+?)[ "']*: *(.+?),? *$/,function(ap,ao,an){return an.replace(/[^&|=!><]+/g,ah)+'?"'+ao+'":"",';});}).join("")+'].join(" ").trim()':ah(ak,al);}function ah(ak,al){ak=ak.trim();return !ak?"":"(function(v){try{v="+ak.replace(af,function(ao,an,am){return am?'(("'+am+ag+am+")":ao;})+"}catch(e){}return "+(al===true?'!v&&v!==0?"":v':"v")+"}).call(d)";}function ae(am,al){var ak=[];al.map(function(ao,an){an=am.indexOf(ao);ak.push(am.slice(0,an),ao);am=am.slice(an+ao.length);});if(am){ak.push(am);}return ak;}function ai(ao,ak,an){var aq,ap=0,am=[],al=new RegExp("("+ak.source+")|("+an.source+")","g");ao.replace(al,function(at,ar,au,av){if(!ap&&ar){aq=av;}ap+=ar?1:-1;if(!ap&&au!=null){am.push(ao.slice(aq,av+au.length));}});return am;}})();var i=(function(ae){var ad={tr:"tbody",th:"tr",td:"tr",tbody:"table",col:"colgroup"},ac="div";ae=ae&&ae<10;function ag(aj){var ah=aj&&aj.match(/^\s*<([-\w]+)/),ai=ah&&ah[1].toLowerCase(),al=ad[ai]||ac,ak=L(al);ak.stub=true;if(ae&&ai&&(ah=ai.match(g))){af(ak,aj,ai,!!ah[1]);}else{ak.innerHTML=aj;}return ak;}function af(al,ak,aj,ai){var an=L(ac),ah=ai?"select>":"table>",am;an.innerHTML="<"+ah+ak+"</"+ah;am=an.getElementsByTagName(aj)[0];if(am){al.appendChild(am);}}return ag;})(u);function R(ae){var ad=d(0),ac=ae.trim().slice(ad.length).match(/^\s*(\S+?)\s*(?:,\s*(\S+))?\s+in\s+(.+)$/);return ac?{key:ac[1],pos:ac[2],val:ad+ac[3]}:{val:ae};}function B(ae,ac,af){var ad={};ad[ae.key]=ac;if(ae.pos){ad[ae.pos]=af;}return ad;}function U(af,al,ak){P(af,"each");var ae=M(af),am=af.outerHTML,ad=!!T[ae],ah=T[ae]||{tmpl:am},ai=af.parentNode,aj=document.createComment("riot placeholder"),an=[],ac=I(af),ag;ai.insertBefore(aj,af);ak=R(ak);al.one("premount",function(){if(ai.stub){ai=al.root;}af.parentNode.removeChild(af);}).on("update",function(){var ao=q(ak.val,al);if(!x(ao)){ag=ao?JSON.stringify(ao):"";ao=!ao?[]:Object.keys(ao).map(function(au){return B(ak,au,ao[au]);});}var at=document.createDocumentFragment(),ar=an.length,ap=ao.length;while(ar>ap){an[--ar].unmount();an.splice(ar,1);}for(ar=0;ar<ap;++ar){var aq=!ag&&!!ak.key?B(ak,ao[ar],ar):ao[ar];if(!an[ar]){(an[ar]=new A(ah,{parent:al,isLoop:true,hasImpl:ad,root:g.test(ae)?ai:af.cloneNode(),item:aq},af.innerHTML)).mount();at.appendChild(an[ar].root);}else{an[ar].update(aq);}an[ar]._item=aq;}ai.insertBefore(at,aj);if(ac){al.tags[ae]=an;}}).one("updated",function(){var ao=Object.keys(al);m(ai,function(ap){if(ap.nodeType==1&&!ap.isLoop&&!ap._looped){ap._visited=false;ap._looped=true;Z(ap,al,ao);}});});}function S(ae,ac,ad){m(ae,function(af){if(af.nodeType==1){af.isLoop=af.isLoop||(af.parentNode&&af.parentNode.isLoop||af.getAttribute("each"))?1:0;var ag=I(af);if(ag&&!af.isLoop){ad.push(C(ag,af,ac));}if(!af.isLoop){Z(af,ac,[]);}}});}function f(ae,ad,af){function ac(aj,ai,ag){if(ai.indexOf(d(0))>=0){var ah={dom:aj,expr:ai};af.push(n(ah,ag));}}m(ae,function(ai){var ah=ai.nodeType;if(ah==3&&ai.parentNode.tagName!="STYLE"){ac(ai,ai.nodeValue);}if(ah!=1){return;}var ag=ai.getAttribute("each");if(ag){U(ai,ad,ag);return false;}V(ai.attributes,function(aj){var al=aj.name,ak=al.split("__")[1];ac(ai,aj.value,{attr:ak||al,bool:ak});if(ak){P(ai,al);return false;}});if(I(ai)){return false;}});}function A(aq,ai,ae){var al=l.observable(this),aj=r(ai.opts)||{},ar=i(aq.tmpl),ah=ai.parent,ax=ai.isLoop,ak=ai.hasImpl,au=D(ai.item),aw=[],ac=[],ao=ai.root,ag=aq.fn,ad=ao.tagName.toLowerCase(),an={},av=[];if(ag&&ao._tag){ao._tag.unmount(true);}this.isMounted=false;ao.isLoop=ax;ao._tag=this;this._id=h++;n(this,{parent:ah,root:ao,opts:aj,tags:{}},au);V(ao.attributes,function(ay){var az=ay.value;if(d(/{.*}/).test(az)){an[ay.name]=az;}});if(ar.innerHTML&&!/^(select|optgroup|table|tbody|tr|col(?:group)?)$/.test(ad)){ar.innerHTML=z(ar.innerHTML,ae);}function ap(){var ay=ak&&ax?al:ah||al;V(ao.attributes,function(az){aj[az.name]=q(az.value,ay);});V(Object.keys(an),function(az){aj[az]=q(an[az],ay);});}function af(az){for(var ay in au){if(typeof al[ay]!==X){al[ay]=az[ay];}}}function at(){if(!al.parent||!ax){return;}V(Object.keys(al.parent),function(ay){var az=!~o.indexOf(ay)&&~av.indexOf(ay);if(typeof al[ay]===X||az){if(!az){av.push(ay);}al[ay]=al.parent[ay];}});}this.update=function(ay){ay=D(ay);at();if(ay&&typeof au===j){af(ay);au=ay;}n(al,ay);ap();al.trigger("update",ay);G(aw,al);al.trigger("updated");};this.mixin=function(){V(arguments,function(ay){ay=typeof ay===H?l.mixin(ay):ay;V(Object.keys(ay),function(az){if(az!="init"){al[az]=s(ay[az])?ay[az].bind(al):ay[az];}});if(ay.init){ay.init.bind(al)();}});};this.mount=function(){ap();if(ag){ag.call(al,aj);}f(ar,al,aw);am(true);if(aq.attrs||ak){O(aq.attrs,function(az,ay){ao.setAttribute(az,ay);});f(al.root,al,aw);}if(!al.parent||ax){al.update(au);}al.trigger("premount");if(ax&&!ak){al.root=ao=ar.firstChild;}else{while(ar.firstChild){ao.appendChild(ar.firstChild);}if(ao.stub){al.root=ao=ah.root;}}if(!al.parent||al.parent.isMounted){al.isMounted=true;al.trigger("mount");}else{al.parent.one("mount",function(){if(!y(al.root)){al.parent.isMounted=al.isMounted=true;al.trigger("mount");}});}};this.unmount=function(aA){var az=ao,aB=az.parentNode,ay;if(aB){if(ah){ay=E(ah);if(x(ay.tags[ad])){V(ay.tags[ad],function(aC,aD){if(aC._id==al._id){ay.tags[ad].splice(aD,1);}});}else{ay.tags[ad]=p;}}else{while(az.firstChild){az.removeChild(az.firstChild);}}if(!aA){aB.removeChild(az);}else{aB.removeAttribute("riot-tag");}}al.trigger("unmount");am();al.off("*");ao._tag=null;};function am(az){V(ac,function(aA){aA[az?"mount":"unmount"]();});if(ah){var ay=az?"on":"off";if(ax){ah[ay]("unmount",al.unmount);}else{ah[ay]("update",al.update)[ay]("unmount",al.unmount);}}}S(ar,this,ac);}function v(ad,ae,af,ac){af[ad]=function(ak){var aj=ac._item,ai=ac.parent,ah;if(!aj){while(ai&&!aj){aj=ai._item;ai=ai.parent;}}ak=ak||Q.event;try{ak.currentTarget=af;if(!ak.target){ak.target=ak.srcElement;}if(!ak.which){ak.which=ak.charCode||ak.keyCode;}}catch(ag){}ak.item=aj;if(ae.call(ac,ak)!==true&&!/radio|check/.test(af.type)){if(ak.preventDefault){ak.preventDefault();}ak.returnValue=false;}if(!ak.preventUpdate){ah=aj?E(ai):ac;ah.update();}};}function ab(ac,ad,ae){if(ac){ac.insertBefore(ae,ad);ac.removeChild(ad);}}function G(ad,ac){V(ad,function(aj,ah){var af=aj.dom,ai=aj.attr,ak=q(aj.expr,ac),al=aj.dom.parentNode;if(aj.bool){ak=ak?ai:false;}else{if(ak==null){ak="";}}if(al&&al.tagName=="TEXTAREA"){ak=(""+ak).replace(/riot-/g,"");}if(aj.value===ak){return;}aj.value=ak;if(!ai){af.nodeValue=""+ak;return;}P(af,ai);if(s(ak)){v(ai,ak,af,ac);}else{if(ai=="if"){var ae=aj.stub,am=function(){ab(ae.parentNode,ae,af);},ag=function(){ab(af.parentNode,af,ae);};if(ak){if(ae){am();af.inStub=false;if(!y(af)){m(af,function(an){if(an._tag&&!an._tag.isMounted){an._tag.isMounted=!!an._tag.trigger("mount");}});}}}else{ae=aj.stub=ae||document.createTextNode("");if(af.parentNode){ag();}else{(ac.parent||ac).one("updated",ag);}af.inStub=true;}}else{if(/^(show|hide)$/.test(ai)){if(ai=="hide"){ak=!ak;}af.style.display=ak?"":"none";}else{if(ai=="value"){af.value=ak;}else{if(k(ai,N)&&ai!=K){if(ak){af.setAttribute(ai.slice(N.length),ak);}}else{if(aj.bool){af[ai]=ak;if(!ak){return;}}if(typeof ak!==j){af.setAttribute(ai,ak);}}}}}}});}function V(ae,ag){for(var ad=0,ac=(ae||[]).length,af;ad<ac;ad++){af=ae[ad];if(af!=null&&ag(af,ad)===false){ad--;}}return ae;}function s(ac){return typeof ac===aa||false;}function P(ad,ac){ad.removeAttribute(ac);}function I(ac){return ac.tagName&&T[ac.getAttribute(K)||ac.tagName.toLowerCase()];}function C(ai,ah,ag){var ac=new A(ai,{root:ah,parent:ag},ah.innerHTML),ae=M(ah),af=E(ag),ad;ac.parent=af;ad=af.tags[ae];if(ad){if(!x(ad)){af.tags[ae]=[ad];}if(!~af.tags[ae].indexOf(ac)){af.tags[ae].push(ac);}}else{af.tags[ae]=ac;}ah.innerHTML="";return ac;}function E(ac){var ad=ac;while(!I(ad.root)){if(!ad.parent){break;}ad=ad.parent;}return ad;}function M(ae){var af=I(ae),ad=ae.getAttribute("name"),ac=ad&&ad.indexOf(d(0))<0?ad:af?af.name:ae.tagName.toLowerCase();return ac;}function n(ag){var af,ac=arguments;for(var ae=1;ae<ac.length;++ae){if((af=ac[ae])){for(var ad in af){ag[ad]=af[ad];}}}return ag;}function D(ad){if(!(ad instanceof A)&&!(ad&&typeof ad.trigger==aa)){return ad;}var ae={};for(var ac in ad){if(!~o.indexOf(ac)){ae[ac]=ad[ac];}}return ae;}function m(ad,ac){if(ad){if(ac(ad)===false){return;}else{ad=ad.firstChild;while(ad){m(ad,ac);ad=ad.nextSibling;}}}}function O(ad,af){var ac,ae=/([-\w]+) ?= ?(?:"([^"]*)|'([^']*)|({[^}]*}))/g;while((ac=ae.exec(ad))){af(ac[1].toLowerCase(),ac[2]||ac[3]||ac[4]);}}function y(ac){while(ac){if(ac.inStub){return true;}ac=ac.parentNode;}return false;}function L(ac){return document.createElement(ac);}function z(ac,ad){return ac.replace(/<(yield)\/?>(<\/\1>)?/gi,ad||"");}function W(ac,ad){return(ad||document).querySelectorAll(ac);}function F(ac,ad){return(ad||document).querySelector(ac);}function r(ad){function ac(){}ac.prototype=ad;return new ac();}function Z(ag,ad,ae){if(ag._visited){return;}var af,ac=ag.getAttribute("id")||ag.getAttribute("name");if(ac){if(ae.indexOf(ac)<0){af=ad[ac];if(!af){ad[ac]=ag;}else{if(x(af)){af.push(ag);}else{ad[ac]=[af,ag];}}}ag._visited=true;}}function k(ad,ac){return ad.slice(0,ac.length)===ac;}var t=[],T={},Y;function w(ae){if(l.render){return;}if(!Y){Y=L("style");Y.setAttribute("type","text/css");}var ad=document.head||document.getElementsByTagName("head")[0];if(Y.styleSheet){Y.styleSheet.cssText+=ae;}else{Y.innerHTML+=ae;}if(!Y._rendered){if(Y.styleSheet){document.body.appendChild(Y);}else{var ac=F("style[type=riot]");if(ac){ac.parentNode.insertBefore(Y,ac);ac.parentNode.removeChild(ac);}else{ad.appendChild(Y);}}}Y._rendered=true;}function J(ad,ae,af){var ac=T[ae],ag=ad._innerHTML=ad._innerHTML||ad.innerHTML;ad.innerHTML="";if(ac&&ad){ac=new A(ac,{root:ad,opts:af},ag);}if(ac&&ac.mount){ac.mount();t.push(ac);return ac.on("unmount",function(){t.splice(t.indexOf(ac),1);});}}l.tag=function(ad,af,ae,ac,ag){if(s(ac)){ag=ac;if(/^[\w\-]+\s?=/.test(ae)){ac=ae;ae="";}else{ac="";}}if(ae){if(s(ae)){ag=ae;}else{w(ae);}}T[ad]={name:ad,tmpl:af,attrs:ac,fn:ag};return ad;};l.mount=function(af,ad,ac){var ag,ai,al=[];function ah(am){var an="";V(am,function(ao){an+=", *["+K+'="'+ao.trim()+'"]';});return an;}function aj(){var am=Object.keys(T);return am+ah(am);}function ak(an){var ao;if(an.tagName){if(ad&&(!(ao=an.getAttribute(K))||ao!=ad)){an.setAttribute(K,ad);}var am=J(an,ad||an.getAttribute(K)||an.tagName.toLowerCase(),ac);if(am){al.push(am);}}else{if(an.length){V(an,ak);}}}if(typeof ad===j){ac=ad;ad=0;}if(typeof af===H){if(af==="*"){af=ai=aj();}else{af+=ah(af.split(","));}ag=W(af);}else{ag=af;}if(ad==="*"){ad=ai||aj();if(ag.tagName){ag=W(ad,ag);}else{var ae=[];V(ag,function(am){ae.push(W(ad,am));});ag=ae;}ad=0;}if(ag.tagName){ak(ag);}else{V(ag,ak);}return al;};l.update=function(){return V(t,function(ac){ac.update();});};l.mountTo=l.mount;l.util={brackets:d,tmpl:q};if(typeof a===j){c.exports=l;}else{if(typeof define==="function"&&define.amd){define(function(){return(Q.riot=l);});}else{Q.riot=l;}}})(typeof window!="undefined"?window:void 0);},{}],2:[function(b,c,a){c.exports="html{box-sizing:border-box}html *,*:before,*:after{box-sizing:inherit}body{margin:0}graphic>.graphic{opacity:inherit}.graphic>img{position:absolute;top:0;left:0}.graphic>.ad-hover,.graphic>.hover{opacity:0;transition:opacity .15s linear;-moz-transition:opacity .15s linear;-o-transition:opacity .15s linear;-webkit-transition:opacity .15s linear}.app:hover .graphic>.ad-hover,.graphic:hover>.hover{opacity:1}.ad>div{overflow:hidden}.th-gallery-parent .th-gallery-arrow{cursor:pointer}.th-gallery-parent>.th-gallery-image{opacity:0;transition:opacity .15s linear;-moz-transition:opacity .15s linear;-o-transition:opacity .15s linear;-webkit-transition:opacity .15s linear}.th-gallery-parent>.active{opacity:1}";},{}],3:[function(d,f,a){var c=d("riot");function b(g){this.eventEmitter=g;}b.prototype={off:function(g){this.eventEmitter.off(g);},on:function(g,h){this.eventEmitter.on(g,h);},one:function(g,h){this.eventEmitter.one(g,h);},trigger:function(i){if(i.isGlobal){window.Tarnhelm.triggerGlobalAction(i);return;}if(i.adName!=null){window.Tarnhelm.triggerTandemAction(i);return;}var h=Math.abs(window.parseInt(i.delay,10)||0);if(h){var g=this;window.setTimeout(function(){g.eventEmitter.trigger(i.actionName,i);},h);}else{this.eventEmitter.trigger(i.actionName,i);}},triggerMany:function(j){for(var g=0;g<j.length;g++){var h=j[g];this.trigger(h);}}};f.exports=b;},{riot:1}],4:[function(c,b,d){var a=c("./actionHandler.js");var l=c("./eventEmitter.js");var i=c("../renderer/stores/ad.js");var j=c("./linkHandler.js");var f=c("./logHandler.js");var g=c("./externalFunctionHandler.js");var k=c("./videoActionHandler.js");var h=function(y){var x={};x.id=y.adData.id;x.name=y.adData.name;x.domNode=y.domNode;x.containerFrame=y.containerFrame;x.actionHandler=new a(new l());x.adStore=new i(y.adData,x.actionHandler);j.setDefaultLink(y.adData.defaultLink);j.listen(x.actionHandler);f.listen(x.actionHandler);g.listen(x.actionHandler,x.containerFrame);k.listen(x.actionHandler);function o(){if(v()){var A=x.adStore.getData();var z=A.rect.height+"px";var B=A.rect.width+"px";var C=w();C.style.position="relative";C.style.height=z;C.style.width=B;C.style.zIndex="50";}}function v(){return x.containerFrame&&x.containerFrame.parentNode;}function w(){var z=x.containerFrame.parentNode;return z;}function n(){if(v()){var C=x.adStore.getData();var E=C.frameProperties;var B;var D;var A;var G;var z;var F;if(E){B=E.rect.height+"px";D=E.rect.width+"px";A=(E.rect.anchorX==="left")?"left":"right";G=(E.rect.anchorY==="bottom")?"bottom":"top";z=(E.rect.offsetX!==null)?E.rect.offsetX:0;F=(E.rect.offsetY!==null)?E.rect.offsetY:0;}else{B=C.rect.height+"px";D=C.rect.width+"px";G="top";A="right";z=0;F=0;}x.containerFrame.style.position="absolute";x.containerFrame.style[A]=z+"px";x.containerFrame.style[G]=F+"px";x.containerFrame.style.height=B;x.containerFrame.style.width=D;}}function p(){return(window.ad_utils&&window.ad_utils.fp)?window.ad_utils.fp:undefined;}function t(){if(!x.adStore.requiresAutoplay()){return;}var z=p();if(z&&z.should_autoplay(x.id)){var A=x.adStore.getFrequencyCappedInitActions();x.actionHandler.triggerMany(A);z.log_autoplay(x.id);}}function r(){if(this.initted){return;}this.initted=true;if(!m()){o();}n();t();}function m(){var z=x.adStore.getData();return z.frameProperties&&z.frameProperties.isFloater;}function u(){x.actionHandler.trigger({actionName:"minimize-ad"});}function s(){x.actionHandler.trigger({actionName:"maximize-ad"});}function q(A){if(x.containerFrame){var z=x.containerFrame.style;z.top=z.right=z.bottom=z.left="";if(z.removeProperty){z.removeProperty("top");z.removeProperty("right");z.removeProperty("bottom");z.removeProperty("left");}z.height=A.height+"px";z.width=A.width+"px";z[A.anchorX]=A.offsetX+"px";z[A.anchorY]=A.offsetY+"px";}}return{getId:function(){return x.id;},getName:function(){return x.name;},getDomNode:function(){return x.domNode;},getContainerFrame:function(){return x.containerFrame;},getActionHandler:function(){return x.actionHandler;},getAdStore:function(){return x.adStore;},resizeAdContainer:q,initContainerWrapper:o,minimize:u,maximize:s,initAfterMount:r};};b.exports=h;},{"../renderer/stores/ad.js":41,"./actionHandler.js":3,"./eventEmitter.js":6,"./externalFunctionHandler.js":7,"./linkHandler.js":9,"./logHandler.js":10,"./videoActionHandler.js":14}],5:[function(b,c,a){c.exports={compareDateRanges:function(j,i){var f=new Date(j.start);var d=new Date(i.start);var h=f.getTime();var g=d.getTime();if(h<g){return -1;}if(h>g){return 1;}return 0;},getActiveSortedDateRanges:function(h,g){var d=[];if(!g||!g.length){return d;}for(var f=0;f<g.length;f++){var j=new Date(g[f].start);if(h>=j.getTime()){d.push(g[f]);}}return d.sort(this.compareDateRanges);}};},{}],6:[function(c,d,a){var b=c("riot");function f(){b.observable(this);}d.exports=f;},{riot:1}],7:[function(b,c,a){var d={listen:function(h,i){var f=this;var g=i.contentWindow;h.on("call-external-function",function(j){f.callExternalFunction(g,j);});},callExternalFunction:function(h,k){var j=k.data.functionName;var g=k.data.arguments||[];var i=this.getFunctionContext(h,k);var f=this.getFunction(j,i);if(typeof f!=="function"){this.logErrorMessage(f,k);return;}f.apply(i,g);},getFunction:function(h,f){if(h.indexOf(".")===-1){return f[h];}var g=h.split(".");return g.reduce(function(i,k,j,l){return i[k];},f);},getFunctionContext:function(f,g){if(g.data.context==="top"){return window.top;}else{return f;}},logErrorMessage:function(f,h){var g="";if(f==null){g+="Function does not exist";}else{g+=h.data.functionName+" is not a function";}g+=' in "'+h.data.context+'" context. ';window.Tarnhelm.log('Failed to call external function "'+h.data.functionName+'".',g);}};c.exports=d;},{}],8:[function(b,c,a){c.exports={beforeNode:function(g,f){var d=document.createElement("style");d.type="text/css";if(d.styleSheet){d.styleSheet.cssText=g;}else{d.appendChild(document.createTextNode(g));}f.parentNode.insertBefore(d,f);}};},{}],9:[function(d,g,c){var a;var b=this;function f(i){i.on("open-link",function(j){if(j.data.sameWindow){window.top.location.href=j.data.url;}else{window.open(j.data.url);}});i.on("open-default-link",function(j){if(!b.defaultLink){window.Tarnhelm.log('No defaultLink for the "open-default-link" action.');return;}if(j.data&&j.data.sameWindow){window.top.location.href=b.defaultLink;}else{window.open(b.defaultLink);}});}function h(i){b.defaultLink=i;}g.exports={listen:f,setDefaultLink:h};},{}],10:[function(b,c,a){c.exports={listen:function(d){d.on("log",function(f){window.Tarnhelm.log(f.message);});}};},{}],11:[function(c,d,b){function a(f){this.trackingHash=f||{};this.fireTracker=function(g){var h=this.trackingHash[g];window.Tarnhelm.log('Tracking event fired for: "'+g+'"');if(h){(new Image()).src=h;}};}d.exports=a;},{}],12:[function(c,f,b){var a={opacity:"opacity",translate:"transform",translateX:"transform",translateY:"transform",rotate:"transform",scale:"transform",scaleX:"transform",scaleY:"transform",blur:"filter",brightness:"filter",contrast:"filter",grayscale:"filter",saturate:"filter"};var d={filter:["-webkit-filter","-moz-filter","-o-filter"]};f.exports={isValidTransitionType:function(g){if(typeof g!=="string"){return false;}return !!a[g];},getTransitionSegment:function(g){return this.getTransitionSegmentForProperty(g,a[g.type]);},getPrefixedTransitionSegments:function(k){var h=[];h.push(this.getTransitionSegment(k));var j=d[a[k.type]];for(var g=0;g<j.length;g++){h.push(this.getTransitionSegmentForProperty(k,j[g]));}return h;},getTransitionSegmentForProperty:function(i,g){var h=[];if(g){h.push(g);}if(i.duration){h.push(i.duration);}if(i.easing){h.push(i.easing);}if(i.delay){h.push(i.delay);}return h.join(" ");},getCSSFunctionSegment:function(g,h){return g+"("+h+")";},calculateTransitionStyles:function(p){var r={start:{},end:{}};var h=[];var o=[];var k=[];var m=[];var q=[];for(var l=0;l<p.length;l++){var n=p[l];if(this.isValidTransitionType(n.type)){var g=a[n.type];switch(g){case"transform":if(!o.length){h.push(this.getTransitionSegment(n));}o.push(this.getCSSFunctionSegment(n.type,n.startValue));k.push(this.getCSSFunctionSegment(n.type,n.endValue));break;case"opacity":r.start[n.type]=n.startValue;r.end[n.type]=n.endValue;h.push(this.getTransitionSegment(n));break;case"filter":if(!m.length){var j=this.getPrefixedTransitionSegments(n);h=h.concat(j);}m.push(this.getCSSFunctionSegment(n.type,n.startValue));q.push(this.getCSSFunctionSegment(n.type,n.endValue));break;}}}if(h.length){r.start.transition=h.join(",");}if(o.length){r.start.transform=o.join(" ");}if(k.length){r.end.transform=k.join(" ");}if(m.length){r.start.filter=m.join(" ");}if(q.length){r.end.filter=q.join(" ");}return r;},getTransitionTime:function(j){var i=parseFloat(j.duration)||0;var g=parseFloat(j.delay)||0;var h=Math.floor((i+g)*1000);return h;},getMaxTransitionTime:function(k){var g=0;for(var h=0;h<k.length;h++){var j=this.getTransitionTime(k[h]);if(j>g){g=j;}}return g;}};},{}],13:[function(b,c,a){var d=3000;c.exports={getQueryParam:function(g,f){var i=new RegExp("[\\?&]"+g+"=([^&#]*)");var h=i.exec(f);return h?h[1]:"";},preloadUrl:function(g,h){var f=new Image();if(typeof h==="function"){f.onload=h;}f.src=g;},preloadUrls:function(g){if(!g||!g.length){return;}for(var f=0;f<g.length;f++){this.preloadUrl(g[f]);}},preloadUrlsWithCallback:function(l,k){var f=0;var h;var m=false;if(!l||!l.length){k();return;}function j(){if(!m){m=true;k();}}function n(){f++;window.Tarnhelm.log(f+" of "+l.length+" images have preloaded");if(f===l.length){window.clearTimeout(h);j();}}h=window.setTimeout(function(){window.Tarnhelm.log("Preload assets failed to load before the timeout, triggering callback");j();},d);for(var g=0;g<l.length;g++){this.preloadUrl(l[g],n);}}};},{}],14:[function(b,c,a){c.exports={videoActions:["video:play","video:pause","video:reset","video:mute","video:unmute"],listen:function(f){var d=this;f.on(this.videoActions.join(" "),function(g,h){d.triggerVideoAction(f,h.actionName,h.componentName);});},triggerVideoAction:function(h,g,f){var d=g+":"+f;h.trigger({actionName:d});}};},{}],15:[function(c,d,b){var a=function(i,h){var i=i;var f;var g=this;function k(m){var l="";if(m.source){l+="url("+m.source+") ";l+=(m.position)?m.position+" ":"center top ";l+=(m.repeat)?m.repeat+" ":"no-repeat ";l+=(m.attachment)?m.attachment+" ":"scroll ";}l+=m.color;return l;}function j(){var l=document.getElementById(i);if(!l){window.Tarnhelm.log("Invalid element id set on wrapSwapper.");}return l;}this.setWrap=function(l){if(!f){f=j();}var m=k(l);f.style.background=m;};h.on("set-wrap-background",function(l){g.setWrap(l.data);});};d.exports=a;},{}],16:[function(b,c,a){(function(d,f){if(typeof(define)==="function"&&define.amd){define(["riot"],function(h){f(h);});}else{if(typeof(c)!=="undefined"&&typeof c.exports!=="undefined"){var g=b("riot");f(g);}else{f(d.riot);}}})(this,function(d){b("./mixins/action.js");b("./mixins/action-user.js");b("./mixins/action-video.js");b("./mixins/action-cuepoint.js");b("./mixins/background.js");b("./mixins/base.js");b("./mixins/children.js");b("./mixins/rect.js");b("./mixins/styles.js");b("./mixins/transitions.js");b("./mixins/video.js");b("./mixins/zoolander.js");b("./components/ad.tag");d.tag("app",'<ad data="{adData}"></ad>','class="app"',function(g){this._adInstance=this.opts.adInstance;this.adData=this._adInstance.getAdStore().getData();var f=this;this._adInstance.getActionHandler().on("ad-state-updated",function(){f.adData=f._adInstance.getAdStore().getData();f.update();});});});},{"./components/ad.tag":17,"./mixins/action-cuepoint.js":28,"./mixins/action-user.js":29,"./mixins/action-video.js":30,"./mixins/action.js":31,"./mixins/background.js":32,"./mixins/base.js":33,"./mixins/children.js":34,"./mixins/rect.js":35,"./mixins/styles.js":36,"./mixins/transitions.js":37,"./mixins/video.js":38,"./mixins/zoolander.js":39,riot:1}],17:[function(b,c,a){(function(d,f){if(typeof(define)==="function"&&define.amd){define(["riot"],function(h){f(h);});}else{if(typeof(c)!=="undefined"&&typeof c.exports!=="undefined"){var g=b("riot");f(g);}else{f(d.riot);}}})(this,function(d){b("./child.tag");d.tag("ad",'<div riot-style="{getTagStyleString()}"><child each="{getChildren()}" data="{data}"></child></div>','class="ad"',function(f){this.mixin("base");this.mixin("styles");this.mixin("rect");this.mixin("background");this.mixin("children");});});},{"./child.tag":19,riot:1}],18:[function(b,c,a){(function(d,f){if(typeof(define)==="function"&&define.amd){define(["riot"],function(h){f(h);});}else{if(typeof(c)!=="undefined"&&typeof c.exports!=="undefined"){var g=b("riot");f(g);}else{f(d.riot);}}})(this,function(d){d.tag("alphalfa",'<div class="alphalfa" riot-style="{getTagStyleString()}"><video autoplay style="display:none;" muted="true"><source riot-src="{this.opts.data.video.fileName + \'.webm\'}"><source riot-src="{this.opts.data.video.fileName + \'.mp4\'}"></video><canvas class="alphalfa-buffer" style="display:none;" height="{this.opts.data.video.height * 2}px" width="{this.opts.data.video.width}px"></canvas><canvas class="alphalfa-output" height="{this.opts.data.video.height}px" width="{this.opts.data.video.width}px"></canvas></div>',function(g){this.mixin("base");this.mixin("styles");this.mixin("rect");this.mixin("transitions");this.mixin("video");this.mixin("action");this.mixin("action-cuepoint");this.mixin("action-video");var f=this;this.initAlphalfa=function(){if(this.opts.data.isInvisible){this.getVideoEl().autoplay="";}this.bufferEl=this.root.getElementsByTagName("canvas")[0];this.outputEl=this.root.getElementsByTagName("canvas")[1];this.alphalfaPlayer=new ad_design.AlphalfaPlayer({video:this.getVideoEl(),buffer:this.bufferEl,output:this.outputEl,loop:this.opts.data.video.loop});this.alphalfaPlayer.listen();};this.play=function(){f.getVideoEl().play();};this.pause=function(){f.getVideoEl().pause();};this.mute=function(){window.Tarnhelm.log("Alphalfa does not support mute and unmute actions.");};this.unmute=this.mute;this.reset=function(){f.getVideoEl().currentTime=0;};this.on("mount",function(){this.setVideoEl(this.root.getElementsByTagName("video")[0]);this.initAlphalfa();this.initActionReceivers();this.initVideoHandlers();});this.on("unmount",function(){this.alphalfaPlayer.teardown();this.teardownVideoHandlers();});});});},{riot:1}],19:[function(b,c,a){(function(d,f){if(typeof(define)==="function"&&define.amd){define(["riot"],function(h){f(h);});}else{if(typeof(c)!=="undefined"&&typeof c.exports!=="undefined"){var g=b("riot");f(g);}else{f(d.riot);}}})(this,function(d){b("./alphalfa.tag");b("./countdowner.tag");b("./gallery.tag");b("./graphic.tag");b("./panel.tag");b("./minimal-video.tag");b("./reely.tag");b("./rotator.tag");b("./rotatorbutton.tag");d.tag("child",'<alphalfa each="{this.getType(\'alphalfa\')}" data="{data}"></alphalfa><countdowner each="{this.getType(\'countdowner\')}" data="{data}"></countdowner><gallery each="{this.getType(\'gallery\')}" data="{data}"></gallery><graphic each="{this.getType(\'graphic\')}" data="{data}"></graphic><panel each="{this.getType(\'panel\')}" data="{data}"></panel><reely each="{this.getType(\'reely\')}" data="{data}"></reely><minimal-video each="{this.getType(\'minimal-video\')}" data="{data}"></minimal-video><rotator each="{this.getType(\'rotator\')}" data="{data}"></rotator><rotatorbutton each="{this.getType(\'rotatorbutton\')}" data="{data}"></rotatorbutton>','data-comp-name="{ this.opts.data.name }"',function(f){this.getType=function(h){var g=[];if(this.opts.data.type===h&&!this.opts.data.isHidden){g.push({data:this.opts.data});}return g;};});});},{"./alphalfa.tag":18,"./countdowner.tag":20,"./gallery.tag":21,"./graphic.tag":22,"./minimal-video.tag":23,"./panel.tag":24,"./reely.tag":25,"./rotator.tag":26,"./rotatorbutton.tag":27,riot:1}],20:[function(b,c,a){(function(d,f){if(typeof(define)==="function"&&define.amd){define(["riot"],function(h){f(h);});}else{if(typeof(c)!=="undefined"&&typeof c.exports!=="undefined"){var g=b("riot");f(g);}else{f(d.riot);}}})(this,function(d){d.tag("countdowner",'<div id="{this.opts.data.name}" class="countdowner th-countdown" riot-style="{getTagStyleString()}"><div class="th-countdown-inject" id="{\'th-countdown-\' + this.opts.data.name}"></div></div>',function(f){this.mixin("base");this.mixin("styles");this.mixin("rect");this.mixin("zoolander");this.initCountdowner=function(){var h=this.root.getElementsByClassName("th-countdown-inject")[0];var k=this.getAdIframeZoolander();var g={el:h,targetDate:new Date(this.opts.data.targetDate),zoolander:k};var m=["splitChar","hideAfterRelease","periodContainerCss","periodCountCss","doPad","printLabels","labelsBelow","labels","labelsCss"];for(var j=0;j<m.length;j++){if(this.opts.data[m[j]]!=null){g[m[j]]=this.opts.data[m[j]];}}var l=new window.ad_design.Countdowner(g);};this.on("mount",function(){this.initCountdowner();});});});},{riot:1}],21:[function(b,c,a){(function(d,f){if(typeof(define)==="function"&&define.amd){define(["riot"],function(h){f(h);});}else{if(typeof(c)!=="undefined"&&typeof c.exports!=="undefined"){var g=b("riot");f(g);}else{f(d.riot);}}})(this,function(d){b("./graphic.tag");d.tag("gallery",'<div class="gallery th-gallery-parent" riot-style="{getTagStyleString()}"><graphic each="{name, i in this.opts.data.imageUrls}" data="{parent.getPhotoData(i)}" class="th-gallery-image {currentIndex === i ? \'active\' : \'\'}"></graphic><graphic class="th-gallery-arrow" data="{this.opts.data.arrowGraphics.previous}" onclick="{decrementIndex}"></graphic><graphic class="th-gallery-arrow" data="{this.opts.data.arrowGraphics.next}" onclick="{incrementIndex}"></graphic></div>',function(g){this.mixin("base");this.mixin("styles");this.mixin("background");this.mixin("rect");var f=this;this.currentIndex=0;this.maxIndex=this.opts.data.imageUrls.length-1;this.getPhotoData=function(i){var h={name:this.opts.data.name+i,source:this.opts.data.imageUrls[i],rect:{anchorX:"right",anchorY:"top",offsetX:0,offsetY:0,height:this.opts.data.rect.height,width:this.opts.data.rect.width}};return h;};this.incrementIndex=function(h){f.currentIndex++;if(f.currentIndex>f.maxIndex){f.currentIndex=0;}f.update();};this.decrementIndex=function(h){f.currentIndex--;if(f.currentIndex<0){f.currentIndex=f.maxIndex;}f.update();};});});},{"./graphic.tag":22,riot:1}],22:[function(b,c,a){(function(d,f){if(typeof(define)==="function"&&define.amd){define(["riot"],function(h){f(h);});}else{if(typeof(c)!=="undefined"&&typeof c.exports!=="undefined"){var g=b("riot");f(g);}else{f(d.riot);}}})(this,function(d){d.tag("graphic",'<div class="graphic" riot-style="{getTagStyleString()}" onclick="{this.hasAction(\'click\') ? handleClick : null}" onmouseenter="{this.hasAction(\'hoverIn\') ? handleHoverIn : null}" onmouseleave="{this.hasAction(\'hoverOut\') ? handleHoverOut : null}"><img if="{this.opts.data.source}" riot-src="{this.opts.data.source}" alt="{this.opts.data.description}"><img if="{this.opts.data.fullAdHoverSource}" riot-src="{this.opts.data.fullAdHoverSource}" alt="{this.opts.data.description}" class="ad-hover"><img if="{this.opts.data.hoverSource}" riot-src="{this.opts.data.hoverSource}" alt="{this.opts.data.description}" class="hover"></div>',function(f){this.mixin("base");this.mixin("styles");this.mixin("rect");this.mixin("transitions");this.mixin("action");this.mixin("action-user");});});},{riot:1}],23:[function(b,c,a){(function(d,f){if(typeof(define)==="function"&&define.amd){define(["riot"],function(h){f(h);});}else{if(typeof(c)!=="undefined"&&typeof c.exports!=="undefined"){var g=b("riot");f(g);}else{f(d.riot);}}})(this,function(d){d.tag("minimal-video",'<div riot-style="{getTagStyleString()}" class="minimal-video"><video autoplay muted="true"><source riot-src="{this.opts.data.video.fileName + \'.webm\'}"><source riot-src="{this.opts.data.video.fileName + \'.mp4\'}"></video></div>',function(g){this.mixin("base");this.mixin("styles");this.mixin("rect");this.mixin("video");this.mixin("action");this.mixin("action-cuepoint");this.mixin("action-video");var f=this;this.setupVideoAttributes=function(){var h=this.opts.data.video;if(h.autoplay!==false){this.getVideoEl().autoplay=true;}if(h.loop){this.getVideoEl().loop=true;}this.getVideoEl().style.width=h.width;this.getVideoEl().style.height=h.height;};this.play=function(){f.getVideoEl().play();};this.pause=function(){f.getVideoEl().pause();};this.mute=function(){f.getVideoEl().muted=true;};this.unmute=function(){f.getVideoEl().muted=false;};this.reset=function(){f.getVideoEl().currentTime=0;};this.listen=function(){this.getVideoEl().addEventListener("play",this.makeVisible);};this.teardown=function(){this.getVideoEl().removeEventListener("play",this.makeVisible);};this.on("mount",function(){this.makeInvisible();this.setVideoEl(this.root.getElementsByTagName("video")[0]);this.setupVideoAttributes();this.listen();this.initActionReceivers();this.initVideoHandlers();});this.on("unmount",function(){this.teardown();this.teardownVideoHandlers();this.teardownActionReceivers();});});});},{riot:1}],24:[function(b,c,a){(function(d,f){if(typeof(define)==="function"&&define.amd){define(["riot"],function(h){f(h);});}else{if(typeof(c)!=="undefined"&&typeof c.exports!=="undefined"){var g=b("riot");f(g);}else{f(d.riot);}}})(this,function(d){d.tag("panel",'<div class="panel" riot-style="{getTagStyleString()}" onclick="{this.hasAction(\'click\') ? handleClick : null}" onmouseenter="{this.hasAction(\'hoverIn\') ? handleHoverIn : null}" onmouseleave="{this.hasAction(\'hoverOut\') ? handleHoverOut : null}"><child each="{getChildren()}" data="{data}"></child></div>',function(f){this.mixin("base");this.mixin("styles");this.mixin("rect");this.mixin("background");this.mixin("children");this.mixin("transitions");this.mixin("action");this.mixin("action-user");});});},{riot:1}],25:[function(b,c,a){(function(d,f){if(typeof(define)==="function"&&define.amd){define(["riot"],function(h){f(h);});}else{if(typeof(c)!=="undefined"&&typeof c.exports!=="undefined"){var g=b("riot");f(g);}else{f(d.riot);}}})(this,function(d){d.tag("reely",'<div id="{this.opts.data.name}" riot-style="{getTagStyleString()}" class="reely-inject-el"></div>',function(g){this.mixin("base");this.mixin("styles");this.mixin("rect");this.mixin("video");this.mixin("zoolander");this.mixin("action");this.mixin("action-cuepoint");this.mixin("action-video");var f=this;this.determineControlBarConfig=function(l){if(!l){return{};}var j=Object.keys(l);var k={};for(var h=0;h<j.length;h++){var m=j[h];k[m]=l[m];}return k;};this.determineSpritesheetsConfig=function(h){if(!h){return{};}return h;};this.initReely=function(){var m=this.opts.data;var l=this.root.getElementsByClassName("reely-inject-el")[0];var j=this.getAdIframeZoolander();var k=this.determineControlBarConfig(m.controls);var h=this.determineSpritesheetsConfig(m.spritesheets);var i=this.determineSpritesheetsConfig(m.overlaySpritesheets);this.reelyPlayer=new ad_design.Reely({injectEl:l,src:this.opts.data.video.fileName,zoolander:j,slate:this.opts.data.video.slate||"",autoplay:this.opts.data.video.autoplay||false,autosound:this.opts.data.video.autosound||false,controlBar:k,spritesheets:h,overlaySpritesheets:i});};this.play=function(){f.reelyPlayer.play();};this.pause=function(){f.reelyPlayer.pause();};this.mute=function(){f.reelyPlayer.mute();};this.unmute=function(){f.reelyPlayer.unmute();};this.reset=function(){f.reelyPlayer.reset();};this.on("mount",function(){this.initReely();this.setVideoEl(this.reelyPlayer.videoEl);this.initActionReceivers();this.initVideoHandlers();});this.on("unmount",function(){this.reelyPlayer.teardown();this.teardownVideoHandlers();this.teardownActionReceivers();});});});},{riot:1}],26:[function(b,c,a){(function(d,f){if(typeof(define)==="function"&&define.amd){define(["riot"],function(h){f(h);});}else{if(typeof(c)!=="undefined"&&typeof c.exports!=="undefined"){var g=b("riot");f(g);}else{f(d.riot);}}})(this,function(d){d.tag("rotator",'<div class="rotator" riot-style="{getTagStyleString()}"><child data="{getActiveChild()}"></child></div>',function(f){this.mixin("base");this.mixin("styles");this.mixin("rect");this.mixin("background");this.mixin("children");this.mixin("transitions");this.activeChildName=this.opts.data.children[this.opts.data.activeIndex].name;this.getActiveChild=function(){var h=this.opts.data.children[this.opts.data.activeIndex];var i=h.name;if(i!==this.activeChildName){var g=this;this.activeChildName=i;window.setTimeout(function(){g.update();},1);return[];}else{return h;}};});});},{riot:1}],27:[function(b,c,a){(function(d,f){if(typeof(define)==="function"&&define.amd){define(["riot"],function(h){f(h);});}else{if(typeof(c)!=="undefined"&&typeof c.exports!=="undefined"){var g=b("riot");f(g);}else{f(d.riot);}}})(this,function(d){b("./graphic.tag");d.tag("rotatorbutton",'<div class="rotatorbutton" riot-style="{getTagStyleString()}" onclick="{handleClickAndRotatorbuttonClick}" onmouseenter="{this.hasAction(\'hoverIn\') ? handleHoverIn : null}" onmouseleave="{this.hasAction(\'hoverOut\') ? handleHoverOut : null}"><graphic data="{graphicData}"></graphic></div>',function(g){var f=this;this.mixin("base");this.mixin("styles");this.mixin("rect");this.mixin("transitions");this.mixin("action");this.mixin("action-user");this.handleRotatorbuttonClick=function(j){if(this.isActive()){return;}var h=f.opts.data;if(!h.rotatorName){return;}var i={actionName:"route",data:{rotatorConfigs:[{name:h.rotatorName,index:h.rotatorIndex}]}};if(h.rotatorConfigs&&h.rotatorConfigs.length){i.data.rotatorConfigs=i.data.rotatorConfigs.concat(h.rotatorConfigs);}i.data.showComponents=h.showComponents;i.data.hideComponents=h.hideComponents;this.getAdInstance().getActionHandler().trigger(i);};this.handleClickAndRotatorbuttonClick=function(h){if(this.hasAction("click")){this.handleClick(h);}this.handleRotatorbuttonClick(h);};this.getGraphicData=function(){var h=this.opts.data;var i={description:h.description,source:h.source,hoverSource:h.hoverSource,fullAdHoverSource:h.fullAdHoverSource,rect:{anchorX:"left",anchorY:"top",offsetX:0,offsetY:0,height:h.rect.height,width:h.rect.width}};if(this.isActive()){i.source=h.activeSource;}return i;};this.isActive=function(){var i=this.getAdInstance().getAdStore();var h=i.getComponentData(this.opts.data.rotatorName);return(h&&(this.opts.data.rotatorIndex===h.activeIndex));};this.setCursor=function(){if(this.isActive()){this.removeStyleRule("cursor");}else{this.addStyleRule("cursor","pointer");}};this.setState=function(){this.graphicData=this.getGraphicData();this.setCursor();};this.setState();this.on("update",function(){this.setState();});});});},{"./graphic.tag":22,riot:1}],28:[function(c,d,a){var b=c("riot");var f={init:function(){if(this.hasCuePointActions()){this.cuePointActionsArray=this.collateCuePointActions();}},hasCuePointActions:function(){return this.getConfiguredCuePoints().length>0;},initCuePointHandlers:function(){this.boundOnTimeUpdate=this.onTimeUpdate.bind(this);this.getVideoEl().addEventListener("timeupdate",this.boundOnTimeUpdate);},teardownCuePointHandlers:function(){this.getVideoEl().removeEventListener("timeupdate",this.boundOnTimeUpdate);},getConfiguredCuePoints:function(){var g=this.opts.data.actions||{};return(g&&g.cuePoints)?g.cuePoints:[];},collateCuePointActions:function(){var j=this.getConfiguredCuePoints();var h=[];var g;var l;var m;var n;for(var k=0;k<j.length;k++){g=j[k];l=g.timeString;m=g.actions;n=this.determineCueMS(l);h.push({ms:n,actions:m});}h.sort(function(o,i){return o.ms>i.ms;});return h;},onTimeUpdate:function(g){if(this.cueIndex==null){this.cueIndex=0;}if(this.cuePointActionsArray[this.cueIndex]==null){return;}this.cuePointEventHandler(g);},cuePointEventHandler:function(j){var g=j.target;var i=g.currentTime*1000;var k=this.cuePointActionsArray[this.cueIndex];var h=k.ms;if(i>=h){this.cueIndex++;this.triggerActions(k.actions);}},determineCueMS:function(h){var j=this.determineTimeObj(h);var g={m:60000,s:1000,ms:1};var i=Object.keys(j).reduce(function(l,k){return l+(j[k]*g[k]);},0);if(isNaN(i)){console.warn("Error processing cuepoint TimeString :: ",h);return;}return i;},determineTimeObj:function(j){var l={};var g=j.replace(/(\D{1,})([\d])/g,"$1,$2").split(",");for(var h=0;h<g.length;h++){var k=g[h].split(/(\D{1,})/);l[k[1]]=parseInt(k[0],10);}return l;}};b.mixin("action-cuepoint",f);},{riot:1}],29:[function(c,d,a){var b=c("riot");var f={init:function(){if(this.hasAction("click")){this.addStyleRule("cursor","pointer");}},handleClick:function(g){this.handleEvent(g,"click");},handleHoverIn:function(g){this.handleEvent(g,"hoverIn");},handleHoverOut:function(g){this.handleEvent(g,"hoverOut");}};b.mixin("action-user",f);},{riot:1}],30:[function(c,d,a){var b=c("riot");var f={initVideoHandlers:function(){this.boundHandleVideoComplete=this.handleVideoComplete.bind(this);this.getVideoEl().addEventListener("ended",this.boundHandleVideoComplete);if(this.hasCuePointActions()){this.initCuePointHandlers();}},teardownVideoHandlers:function(){this.getVideoEl().removeEventListener("ended",this.boundHandleVideoComplete);if(this.hasCuePointActions()){this.teardownCuePointHandlers();}},handleVideoComplete:function(g){this.handleEvent(g,"videoComplete");}};b.mixin("action-video",f);},{riot:1}],31:[function(c,d,a){var b=c("riot");var f={init:function(){if(this.hasAction("init")){var g=this.opts.data.actions.init;this.triggerActions(g);}},handleEvent:function(h,g){h.preventUpdate=true;if(!this.hasAction(g)){return true;}var i=this.opts.data.actions[g];this.triggerActions(i);return true;},triggerActions:function(h){var g=this.getAdInstance().getActionHandler();g.triggerMany(h);},hasAction:function(g){return(this.opts.data.actions&&this.opts.data.actions[g]&&this.opts.data.actions[g].length);}};b.mixin("action",f);},{riot:1}],32:[function(c,d,a){var b=c("riot");var f={init:function(){this.setBackground();this.on("update",this.setBackground);},setBackground:function(){var h=this.opts.data||{};var g=h.background||{};if(g.color){this.addStyleRule("background-color",g.color);}if(g.source){this.addStyleRule("background-image","url("+g.source+")");this.addStyleRule("background-repeat","no-repeat");}}};b.mixin("background",f);},{riot:1}],33:[function(c,d,a){var b=c("riot");var f={getAdInstance:function(){if(this._adInstance){return this._adInstance;}var h=this;var g;while(!g){h=h.parent;g=h._adInstance;}this._adInstance=g;return g;}};b.mixin("base",f);},{riot:1}],34:[function(c,f,a){var b=c("riot");var d={getChildren:function(){var h=[];if(this.opts.data&&this.opts.data.children){for(var g=0;g<this.opts.data.children.length;g++){h.push({data:this.opts.data.children[g]});}}return h;}};b.mixin("children",d);},{riot:1}],35:[function(d,f,a){var c=d("riot");var b={init:function(){this.setRect();this.on("update",this.setRect);},setRect:function(){var j=this.opts.data||{};var k=j.rect||{};var i="left";var h="top";var g=0;var l=0;this.removeStyleRules(["top","right","bottom","left"]);if(k.height!=null){this.addStyleRule("height",k.height+"px");}if(k.width!=null){this.addStyleRule("width",k.width+"px");}if(k.offsetX!=null){g=+k.offsetX;}if(k.offsetY!=null){l=+k.offsetY;}if(k.anchorX==="right"){i="right";}if(k.anchorY==="bottom"){h="bottom";}this.addStyleRule("position","absolute");this.addStyleRule(i,g+"px");this.addStyleRule(h,l+"px");}};c.mixin("rect",b);},{riot:1}],36:[function(d,g,b){var c=d("riot");var f={transform:["-webkit-transform","-ms-transform"],"transform-origin":["-webkit-transform-origin","-moz-transform-origin","-ms-transform-origin","-o-transform-origin"],transition:["-webkit-transition","-moz-transition","-o-transition"],filter:["-webkit-filter","-moz-filter","-o-filter"]};var a={init:function(){this.initTagStyles();this.addCustomCSSTagStyles();this.on("update",this.setTagStyleString);},initTagStyles:function(){this.tagStyles={};this.tagStyleString="";},addCustomCSSTagStyles:function(){var h=this.opts.data.css;if(h){this.addStyleRules(h);}},addStyleRule:function(l,k){this.tagStyles[l]=k;var h=f[l];if(h){for(var j=0;j<h.length;j++){this.tagStyles[h[j]]=k;}}},addStyleRules:function(h){for(var i in h){if(h.hasOwnProperty(i)){this.addStyleRule(i,h[i]);}}},removeStyleRule:function(h){delete this.tagStyles[h];},removeStyleRules:function(j){if(j&&j.length){for(var h=0;h<j.length;h++){this.removeStyleRule(j[h]);}}},setVisibility:function(){if(this.opts.data.isInvisible==null){return;}if(this.opts.data.isInvisible){this.addStyleRule("visibility","hidden");}else{this.addStyleRule("visibility","visible");}},makeInvisible:function(){var h=this.tagStyles.visibility;if(h||h!=="hidden"){this.addStyleRule("visibility","hidden");this.update();}},makeVisible:function(){var h=this.tagStyles.visibility;if(h&&h!=="visible"){this.addStyleRule("visibility","visible");this.update();}},getTagStyleString:function(){var i="";this.setVisibility();for(var h in this.tagStyles){if(this.tagStyles.hasOwnProperty(h)){i+=h+":"+this.tagStyles[h]+";";}}return i;},setTagStyleString:function(){this.tagStyleString=this.getTagStyleString();}};c.mixin("styles",a);},{riot:1}],37:[function(c,d,a){var b=c("riot");var g=c("../../modules/transitionStyleGenerator.js");var f={init:function(){this.transitionStyles=this.getAllTransitionStyles();if(this.hasTransitionsIn()){if(this.hasTransitionsIn()){this.setTransitionsStartState(this.transitionStyles["in"]);this.on("mount",function(){this.setTransitionsEndState(this.transitionStyles["in"]);});}}if(this.hasTransitionsOut()){var i=this;var j=this.getAdInstance().getActionHandler();var h="transition-component-out:"+this.opts.data.name;j.on(h,function(){i.setTransitionsStartState(i.transitionStyles.out);i.setTransitionsEndState(i.transitionStyles.out);});}},getAllTransitionStyles:function(){var i=this.opts.data;var h={"in":{},out:{}};if(this.hasTransitionsIn()){h["in"]=g.calculateTransitionStyles(i.transitionsIn);}if(this.hasTransitionsOut()){h.out=g.calculateTransitionStyles(i.transitionsOut);}return h;},setTransitionsStartState:function(h){this.addStyleRules(h.start);},setTransitionsEndState:function(h){if(window.requestAnimationFrame){var i=this;window.requestAnimationFrame(function(){window.setTimeout(function(){i.addStyleRules(h.end);i.update();},1);});}else{this.addStyleRules(h.end);this.update();}},hasTransitionsIn:function(){return(this.opts.data.transitionsIn&&this.opts.data.transitionsIn.length);},hasTransitionsOut:function(){return(this.opts.data.transitionsOut&&this.opts.data.transitionsOut.length);}};b.mixin("transitions",f);},{"../../modules/transitionStyleGenerator.js":12,riot:1}],38:[function(d,f,a){var c=d("riot");var g=["play","pause","mute","unmute","reset"];var b={enforceVideoInterface:function(){for(var h=0;h<g.length;h++){if(typeof this[g[h]]!=="function"){window.Tarnhelm.log(this.root.tagName+" failed to implement "+g[h]+"()");}}},setVideoEl:function(h){this.videoEl=h;this.enforceVideoInterface();},getVideoEl:function(){if(!this.videoEl){window.Tarnhelm.log(this.root.tagName+" failed to call `setVideoEl` or passed a bad reference.");return;}return this.videoEl;},initActionReceivers:function(){this.setActionReceivers("on");},teardownActionReceivers:function(){this.setActionReceivers("off");},setActionReceivers:function(m){var h=this.getAdInstance().getActionHandler();var o=h[m].bind(h);var l=this.data.name;for(var k=0;k<g.length;k++){var p=g[k];var n="video:"+p;var j=n+":"+l;var q=this[p];o(j,q);}}};c.mixin("video",b);},{riot:1}],39:[function(c,d,a){var b=c("riot");var f={getAdIframeZoolander:function(){var g=this.getAdInstance().getContainerFrame().contentWindow.document;var h=new ad_design.Zoolander({document:g,id:this.opts.data.name,prefixId:"#"+this.opts.data.name});return h;}};b.mixin("zoolander",f);},{riot:1}],40:[function(d,g,a){
/*!
  Riot v2.2.4, @license MIT, (c) 2015 Muut Inc. + contributors
*/
var c=d("riot");var h=d("../modules/injectCSS.js");var b=d("../modules/url.js");d("./app.tag");function f(i){var j=d("../../css/ad.min.css.js");h.beforeNode(j,i.getDomNode());var k=i.getAdStore().getPrimaryAssetUrls();b.preloadUrlsWithCallback(k,function(){c.mount(i.getDomNode(),{adInstance:i});i.initAfterMount();var l=i.getAdStore().getSecondaryAssetUrls();b.preloadUrls(l);});}g.exports={mountAd:f};},{"../../css/ad.min.css.js":2,"../modules/injectCSS.js":8,"../modules/url.js":13,"./app.tag":16,riot:1}],41:[function(c,b,h){var i=c("riot");var m=c("../../modules/dateRange.js");var j=c("../../modules/trackingHandler.js");var n=c("./delegators/asset.js");var a=c("./delegators/filter.js");var l=c("./delegators/router.js");var g=c("./delegators/transition.js");var f=c("./delegators/wrap.js");var d=["route","rotator:show-index","rotator:show-named-child","minimize-ad","maximize-ad","hide-component","show-component"];function k(p,q){var o=this;this.state=p;this.cachedComponents={};this.actionHandler=q;this.trackingHandler=new j(this.state.trackingHash);this.init();q.on(d.join(" "),function(r,s){o.handleRoutingAction(s);});q.on("track",function(s){var r=s.data.trackingEventName;o.trackingHandler.fireTracker(r);});q.on("set-wrap-background",function(s){var r=o.state.wraps[s.wrapName];f.triggerWrapSwap(r);});q.on("make-invisible",function(s){var r=o.cachedComponents[s.componentName];if(!r.isInvisible){o.cachedComponents[s.componentName].isInvisible=true;q.trigger({actionName:"ad-state-updated"});}});q.on("make-visible",function(s){var r=o.cachedComponents[s.componentName];if(r.isInvisible==null){return;}if(r.isInvisible){o.cachedComponents[s.componentName].isInvisible=false;q.trigger({actionName:"ad-state-updated"});}});}k.prototype={init:function(){this.state.activeDateRanges=m.getActiveSortedDateRanges(Date.now(),this.state.dateRanges);n.setAllAssetSources(this.state.assets,this.state.activeDateRanges);this.initComponentTree(this.state);this.assignTrackingActions(this.state);this.initWraps();},initWraps:function(){if(this.state.wraps){n.setWrapAssets(this.state.wraps,this.state.assets);}},initComponentTree:function(o){if(o.children&&o.children.length){for(var p=0;p<o.children.length;p++){this.initComponentTree(o.children[p]);}}this.initComponent(o);this.cacheComponent(o);},initComponent:function(o){if(o.background&&o.background.asset){n.setGraphicAssets(o.background,this.state.assets);}switch(o.type){case"graphic":case"rotatorbutton":n.setGraphicAssets(o,this.state.assets);break;case"gallery":n.setGalleryArrowAssets(o,this.state.assets);break;case"alphalfa":case"reely":case"minimal-video":n.setVideoAsset(o,this.state.assets);break;case"rotator":o.activeIndex=parseInt(o.activeIndex,10)||0;break;}},cacheComponent:function(o){if(o.name){if(this.cachedComponents[o.name]){window.Tarnhelm.log('More than one component exists with name"'+o.name+'"! Overwriting, this is very bad!');}this.cachedComponents[o.name]=o;}else{window.Tarnhelm.log("A component does not have a name!");}},handleRoutingAction:function(o){if(this.state.isTransitioning){window.Tarnhelm.log('Transition in progress, ignoring action "'+o.actionName+'"');return;}switch(o.actionName){case"route":l.route(o.data,this.cachedComponents,this.state);break;case"rotator:show-index":l.routeRotatorToIndex(o.componentName,o.data.index,this.cachedComponents,this.state);break;case"rotator:show-named-child":l.routeRotatorToNamedChild(o.componentName,o.data.childName,this.cachedComponents,this.state);break;case"minimize-ad":l.routeRotatorToNamedChild("expander","minimized",this.cachedComponents,this.state);break;case"maximize-ad":l.routeRotatorToNamedChild("expander","maximized",this.cachedComponents,this.state);break;case"hide-component":l.route({hideComponents:[o.componentName]},this.cachedComponents,this.state);break;case"show-component":l.route({showComponents:[o.componentName]},this.cachedComponents,this.state);break;}},assignTrackingActions:function(p){if(!p.trackingConfigs||!p.trackingConfigs.length){return;}var s=p.trackingConfigs;for(var r=0;r<s.length;r++){var o=s[r];var q=this.cachedComponents[o.componentName];if(!q){window.Tarnhelm.log('Attempted to add tracking to non existent component: "'+o.componentName+'"');return;}this.assignTrackingActionsToComponent(q,o);}},assignTrackingActionsToComponent:function(p,o){var q=parseInt(o.data.trackingNumber,10);if(isNaN(q)){window.Tarnhelm.log('Missing tracking number for component "'+p.name+'"');q=999;}var r=(q===1)?"":q;switch(o.trackingType){case"video":this.assignVideoTrackingToComponent(p,o,r);break;case"tab":this.appendTrackAction(p,"click","tabClick"+r);break;default:window.Tarnhelm.log('Unsupported tracking type for component "'+p.name+'"');}},assignVideoTrackingToComponent:function(r,q,t){var o=["videoStart","videoComplete"];r.actions=r.actions||{};r.actions.cuePoints=r.actions.cuePoints||[];for(var s=0;s<o.length;s++){var p=o[s];switch(p){case"videoStart":this.appendCuePointTrackAction(r,"10ms","videoStart"+t);break;case"videoComplete":this.appendTrackAction(r,"videoComplete","videoComplete"+t);break;}}},appendTrackAction:function(q,p,o){q.actions=q.actions||{};q.actions[p]=q.actions[p]||[];q.actions[p].push({actionName:"track",data:{trackingEventName:o}});},appendCuePointTrackAction:function(p,q,o){var r=this.findOrCreateCuePoint(p,q);r.actions.push({actionName:"track",data:{trackingEventName:o}});},findOrCreateCuePoint:function(q,s){var o=q.actions.cuePoints;for(var r=0;r<o.length;r++){if(o[r].timeString===s){return o[r];}}var p={timeString:s,actions:[]};o.push(p);return p;},getData:function(){return this.state;},getComponentData:function(o){return this.cachedComponents[o];},requiresAutoplay:function(){return(this.state.frequencyCappedInit&&this.state.frequencyCappedInit.actions&&this.state.frequencyCappedInit.actions.length);},getFrequencyCappedInitActions:function(){if(this.state.frequencyCappedInit&&this.state.frequencyCappedInit.actions){return this.state.frequencyCappedInit.actions;}return[];},getPrimaryAssetUrls:function(){return n.getPreloadAssetUrls("primary",this.state.assets);},getSecondaryAssetUrls:function(){return n.getPreloadAssetUrls("secondary",this.state.assets);}};b.exports=k;},{"../../modules/dateRange.js":5,"../../modules/trackingHandler.js":11,"./delegators/asset.js":42,"./delegators/filter.js":43,"./delegators/router.js":45,"./delegators/transition.js":46,"./delegators/wrap.js":47,riot:1}],42:[function(b,c,a){var f=b("../../../modules/dateRange.js");var d={setGraphicAssets:function(g,h){if(!g){window.Tarnhelm.log("Cannot set graphic assets, component was not provided");return;}if(!h){window.Tarnhelm.log("Cannot set graphic assets, assetLibrary was not provided");return;}if(g.asset){g.source=h[g.asset].source;}if(g.activeAsset){g.activeSource=h[g.activeAsset].source;}if(g.hoverAsset){g.hoverSource=h[g.hoverAsset].source;}if(g.fullAdHoverAsset){g.fullAdHoverSource=h[g.fullAdHoverAsset].source;}},setGalleryArrowAssets:function(g,h){this.setGraphicAssets(g.arrowGraphics.next,h);this.setGraphicAssets(g.arrowGraphics.previous,h);},setVideoAsset:function(g,h){if(!g){window.Tarnhelm.log("Cannot set video assets, component was not provided");return;}if(!g.video){window.Tarnhelm.log("Cannot set video assets, component.video object is missing");return;}if(!h){window.Tarnhelm.log("Cannot set video assets, assetLibrary was not provided");return;}if(g.video.asset){g.video.fileName=h[g.video.asset].fileNameSource;}},setWrapAssets:function(k,j){var l=Object.keys(k);for(var h=0;h<l.length;h++){var g=k[l[h]];this.setGraphicAssets(g,j);}},setAllAssetSources:function(j,g){var m=Object.keys(j);for(var h=0;h<m.length;h++){var k=j[m[h]];var l=this.getCurrentDatedAsset(k,g);switch(k.type){case"video":if(l.fileName){k.fileNameSource=l.fileName;}else{window.Tarnhelm.log('Video asset "'+m[h]+'" is missing "fileName"');}break;default:if(l.url){k.source=l.url;}else{window.Tarnhelm.log('Image asset "'+m[h]+'" is missing "url"');}break;}}},getPreloadAssetUrls:function(l,j){var g=[];if(l!=="primary"&&l!=="secondary"){window.Tarnhelm.log('Problem preloading assets, "'+l+'" should be "primary" or "secondary"');return g;}var m=Object.keys(j);for(var h=0;h<m.length;h++){var k=j[m[h]];if(k.preload===l&&k.source){g.push(k.source);}}return g;},getCurrentDatedAsset:function(k,h){var g=k;if(!h||!h.length){return g;}for(var j=h.length-1;j>-1;j--){var l=h[j].name;if(k.dateOverrides&&k.dateOverrides[l]){return k.dateOverrides[l];}}return g;}};c.exports=d;},{"../../../modules/dateRange.js":5}],43:[function(b,c,a){var d={buildTransitionsOutComponentList:function(f){var h=[];if(!f||f.isHidden){return h;}if(f.transitionsOut&&f.transitionsOut.length){h.push(f);}if(f.children&&f.children.length){if(f.type==="rotator"){var j=f.children[f.activeIndex];h=h.concat(this.buildTransitionsOutComponentList(j));}else{for(var g=0;g<f.children.length;g++){var k=f.children[g];if(!k.isHidden){h=h.concat(this.buildTransitionsOutComponentList(k));}}}}return h;},getHiddenComponentsInList:function(h,j){var k=[];for(var g=0;g<h.length;g++){var f=j[h[g]];if(f&&f.isHidden){k.push(f);}}return k;},getVisibleComponentsInList:function(j,k){var g=[];for(var h=0;h<j.length;h++){var f=k[j[h]];if(f&&!f.isHidden){g.push(f);}}return g;}};c.exports=d;},{}],44:[function(b,d,a){var c=b("./wrap.js");var f={getActiveChild:function(h){var g;if(h&&h.children&&h.children.length&&(h.activeIndex>=0)&&(h.activeIndex<h.children.length)){g=h.children[h.activeIndex];}if(!g){window.Tarnhelm.log('Unable to find active child for rotator "'+h.name+'"');}return g;},setActiveIndex:function(i,h,g){i.activeIndex=h;if(i.name==="expander"){this.resizeAd(i,g);}if(i.wrapConfig&&i.wrapConfig.enabled){c.triggerRotatorWrapSwap(i,g);}},setActiveIndexes:function(g,k,h){for(var j=0;j<g.length;j++){var l=k[g[j].name];this.setActiveIndex(l,g[j].index,h);}},resizeAd:function(k,h){var j=this.getActiveChild(k);var g=j.rect;var i=window.Tarnhelm.getAd(h.id);i.resizeAdContainer(g);h.rect.height=g.height;h.rect.width=g.width;k.rect.height=g.height;k.rect.width=g.width;}};d.exports=f;},{"./wrap.js":47}],45:[function(c,d,a){var h=c("./filter.js");var g=c("./rotator.js");var f=c("./transition.js");var b={route:function(k,s,q){var w=k.rotatorConfigs||[];var y=k.hideComponents||[];var x=k.showComponents||[];var j=window.Tarnhelm.getAd(q.id);var z=j.getActionHandler();var r=[];var l=[];for(var v=0;v<w.length;v++){var A=w[v];var p=s[A.name];if(p&&(p.activeIndex!==A.index)){l.push(A);if(!p.isHidden){var u=g.getActiveChild(p);r.push(u);}}}var m=h.getHiddenComponentsInList(x,s);var o=h.getVisibleComponentsInList(y,s);r=r.concat(o);if(!l.length&&!o.length&&!m.length){return;}var n=[];for(var v=0;v<r.length;v++){n=n.concat(h.buildTransitionsOutComponentList(r[v]));}if(n.length){var t=this;q.isTransitioning=true;f.triggerTransitionsOut(n,z,function(){g.setActiveIndexes(l,s,q);t.setComponentHiddenStates(o,true);t.setComponentHiddenStates(m,false);q.isTransitioning=false;z.trigger({actionName:"ad-state-updated"});});}else{g.setActiveIndexes(l,s,q);this.setComponentHiddenStates(o,true);this.setComponentHiddenStates(m,false);z.trigger({actionName:"ad-state-updated"});}},routeRotatorToIndex:function(l,k,m,j){var i=[{name:l,index:k}];this.route({rotatorConfigs:i},m,j);},routeRotatorToNamedChild:function(l,j,n,k){var o=n[l];if(o&&o.children&&o.children.length){for(var m=0;m<o.children.length;m++){if(o.children[m].name===j){this.routeRotatorToIndex(l,m,n,k);break;}}}},setComponentHiddenStates:function(l,k){for(var j=0;j<l.length;j++){l[j].isHidden=!!k;}}};d.exports=b;},{"./filter.js":43,"./rotator.js":44,"./transition.js":46}],46:[function(b,c,a){var f=b("../../../modules/transitionStyleGenerator.js");var d={triggerTransitionsOut:function(j,l,m){var k=this.getMaxTransitionOutTime(j);for(var h=0;h<j.length;h++){var g="transition-component-out:"+j[h].name;l.trigger({actionName:g});}window.setTimeout(function(){if(typeof m==="function"){m();}},k);},getMaxTransitionOutTime:function(j){var g=0;for(var h=0;h<j.length;h++){var k=f.getMaxTransitionTime(j[h].transitionsOut);if(k>g){g=k;}}return g;}};c.exports=d;},{"../../../modules/transitionStyleGenerator.js":12}],47:[function(b,d,a){var c={triggerRotatorWrapSwap:function(i,f){var h=i.children[i.activeIndex].wrap;if(!h){h=i.wrapConfig["default"];}var g=f.wraps[h];if(!g){window.Tarnhelm.log("Rotator wrap swap points to a non existent wrap. rotator: "+i.name+", wrapName: "+h);return;}this.triggerWrapSwap(g);},triggerWrapSwap:function(f){var g=this.createWrapAction(f);window.Tarnhelm.triggerTopAction(g);},createWrapAction:function(f){return{actionName:"set-wrap-background",data:f};}};d.exports=c;},{}],48:[function(g,a,t){var h=g("./modules/adInstance.js");var p=g("./modules/wrapSwapper.js");var k=g("./modules/actionHandler.js");var f=g("./modules/eventEmitter.js");var c=g("./modules/url.js");var j=g("./renderer/renderer.js");g("../../../vendor/IMDbAdvertisingJsModules/src/js/imdb-ad-design.js");var d={};var l=false;function r(v){var w=JSON.parse(JSON.stringify(v));delete w.adName;delete w.isGlobal;return w;}function u(){var v=c.getQueryParam("tarnhelmDebug",window.location.href);if(v==="1"||v==="true"){l=true;}}var m="wrapper";function b(v){var w=new p(m,v);return w;}function s(){var v=new k(new f());return v;}var q;var i;function n(){q=s();u();i=b(q);}var o={getAd:function(v){return d[v];},getAdByName:function(w){var v;var y=Object.keys(d);for(var x=0;x<y.length;x++){if(d[y[x]].getName()===w){v=d[y[x]];break;}}return v;},initAdInstance:function(y,v,w){if(this.getAd(w.id)){this.log('Ad with id "'+w.id+'" already exists. OVERWRITING!');}if(w.name&&this.getAdByName(w.name)){this.log('Ad with name "'+w.name+'" already exists. OVERWRITING!');}var x=new h({domNode:y,containerFrame:v,adData:w});d[w.id]=x;j.mountAd(x);return x;},triggerTopAction:function(v){q.trigger(v);},triggerGlobalAction:function(x){var y=Object.keys(d);var w=r(x);for(var v=0;v<y.length;v++){this.getAd(y[v]).getActionHandler().trigger(w);}},triggerTandemAction:function(x){if(!x.adName){this.log("Tarnhelm.triggerTandemAction failed, adName was not provided");return;}var v=this.getAdByName(x.adName);if(!v){this.log('Tarnhelm.triggerTandemAction failed, adInstance for "'+x.adName+'" was not found');return;}var w=r(x);v.getActionHandler().trigger(w);},getIsDebug:function(){return l;},setIsDebug:function(v){l=!!v;},log:function(){if(l&&window.console&&window.console.log){var v=Array.prototype.slice.call(arguments);console.log.apply(console,v);}}};a.exports=window.Tarnhelm=o;n();},{"../../../vendor/IMDbAdvertisingJsModules/src/js/imdb-ad-design.js":50,"./modules/actionHandler.js":3,"./modules/adInstance.js":4,"./modules/eventEmitter.js":6,"./modules/url.js":13,"./modules/wrapSwapper.js":15,"./renderer/renderer.js":40}],49:[function(b,c,a){var d=function(f){this.doDebug=false;this.video=f.video;this.output=f.output;this.buffer=f.buffer||undefined;this.parentOrigin=f.parentOrigin;this.dismissalTimeout=f.dismissalTimeout;this.originalOutputDisplay=this.output.style.display||"inline-block";this.outputHeight=this.output.height;this.outputWidth=this.output.width;this.isSupported=true;this.forceCanvas=f.forceCanvas;this.loop=f.loop;this.outputCtx=undefined;this.bufferCtx=undefined;this.renderMode=this.determineRenderMode();this.setupRenderContext();this._polyfillRequestAnimationFrame();};d.prototype={listen:function(){if(!this.isSupported){return;}this.boundFrameHandler=this.boundFrameHandler||this.frameHandler.bind(this);this.video.addEventListener("play",this.boundFrameHandler,false);this.boundEndHandler=this.boundEndHandler||this.videoEndedHandler.bind(this);this.video.addEventListener("ended",this.boundEndHandler,false);this.video.loop=this.loop;},teardown:function(){this.requestAnimFrame=undefined;this.video.removeEventListener("play",this.boundFrameHandler);this.video.removeEventListener("ended",this.boundEndHandler);if(this.renderMode===this.RENDER_MODES.GL){var f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,this.vbuffer);f.bufferData(f.ARRAY_BUFFER,1,f.STATIC_DRAW);f.deleteBuffer(this.vbuffer);f.bindBuffer(f.ARRAY_BUFFER,this.texCoordBuffer);f.bufferData(f.ARRAY_BUFFER,1,f.STATIC_DRAW);f.deleteBuffer(this.texCoordBuffer);f.bindTexture(f.TEXTURE_2D,null);f.deleteTexture(this.stackTexture);this.gl=undefined;}this.outputCtx=undefined;this.bufferCtx=undefined;this.video.parentNode.removeChild(this.video);this.video=undefined;this.output.width=1;this.output.height=1;this.output.parentNode.removeChild(this.output);this.output=undefined;if(this.buffer){this.buffer.width=1;this.buffer.height=1;this.buffer.parentNode.removeChild(this.buffer);this.buffer=undefined;}},RENDER_MODES:{GL:"gl",CANVAS:"canvas"},PIXEL_DATA_SIZE:4,FRAMERATE_DELAY:1000/60,determineRenderMode:function(f){if(this.forceCanvas){if(this.doDebug){console.log("Alphalfa renderMode :: forceCanvas");}return this.RENDER_MODES.CANVAS;}var g=true;this.gl=undefined;try{this.gl=this.output.getContext("webgl")||this.output.getContext("experimental-webgl");}catch(h){g=false;}if(!this.gl){g=false;}var i=(g)?this.RENDER_MODES.GL:this.RENDER_MODES.CANVAS;if(this.doDebug){console.log("Alphalfa determined renderMode :: ",i);}return i;},setupRenderContext:function(){if(this.renderMode===this.RENDER_MODES.GL){this._setupGlContext(this.gl);}else{this._setupCanvasContext();}if(!this.doDebug){this.video.style.display="none";if(this.buffer){this.buffer.style.display="none";}}this.processFrame=this.determineProcessFrame();},determineProcessFrame:function(){if(this.renderMode===this.RENDER_MODES.GL){return this.determineGlRenderFunc();}else{if(this.renderMode===this.RENDER_MODES.CANVAS){if(this.isIE()&&!this.hasBindSupport()){if(this.doDebug){console.log("Error: IE <9 does not support Function.bind. Aborting.");}this.dieBecauseUnsupported();return;}return this.processCanvasFrame.bind(this,this.buffer,this.bufferCtx,this.output,this.outputCtx,this.outputWidth,this.outputHeight);}}},determineGlRenderFunc:function(){if(this.isIE()){return this.ieProcessGlFrame.bind(this,this.gl,this.output);}else{return this.processGlFrame.bind(this,this.gl,this.output);}},hasBindSupport:function(){return("bind" in Function);},frameHandler:function(){if(!this.video){return false;}if(this.video.paused||this.video.ended){if(this.video.ended){this._clearCanvas();}return false;}this.processFrame();this.requestAnimFrame(this.boundFrameHandler);},videoEndedHandler:function(){if(this.parentOrigin){parent.postMessage("ALPHALFA_END",this.parentOrigin);}if(typeof this.dismissalTimeout!=="undefined"){this.boundHideOutputCanvas=this.boundHideOutputCanvas||this.hideOutputCanvas.bind(this);setTimeout(this.boundHideOutputCanvas,this.dismissalTimeout);}},showOutputCanvas:function(){this.output.style.display=this.originalOutputDisplay;},hideOutputCanvas:function(){this.output.style.display="none";},makeBufferCanvas:function(){var f=document.createElement("canvas");f.width=this.output.width;f.height=this.output.height*2;return f;},dieBecauseUnsupported:function(){if(this.doDebug&&window.console&&window.console.log){console.log("Alphalfa has seen things. Attack ships on fire off the shoulder of Orion... Time. to die.");}this.isSupported=false;if(this.boundFrameHandler&&this.boundEndHandler){this.video.removeEventListener("play",this.boundFrameHandler,false);this.video.removeEventListener("ended",this.boundEndHandler,false);}this.video.style.display="none";this.output.style.display="none";if(this.buffer){this.buffer.style.display="none";}},_clearCanvas:function(){if(this.renderMode===this.RENDER_MODES.GL){this._clearGlMode(this.gl);}else{if(this.renderMode===this.RENDER_MODES.CANVAS){this._clearCanvasMode();}}},processCanvasFrame:function(i,l,g,o,f,m){l.drawImage(this.video,0,0);var h=this.bufferCtx.getImageData(0,m,f,m);var j=h.data;for(var n=3,k=j.length;n<k;n=n+this.PIXEL_DATA_SIZE){j[n]=j[n-1];}o.putImageData(h,0,0,0,0,f,m);o.drawImage(i,0,0,f,m,0,0,f,m);},_setupCanvasContext:function(){try{this.outputCtx=this.output.getContext("2d");}catch(f){if(this.doDebug){console.log("Error executing `getContext`, canvas not supported.");}this.dieBecauseUnsupported();return;}this.outputCtx.globalCompositeOperation="source-in";this.buffer=this.buffer||this.makeBufferCanvas();this.bufferCtx=this.buffer.getContext("2d");},_clearCanvasMode:function(){this.outputCtx.clearRect(0,0,this.outputWidth,this.outputHeight);},processGlFrame:function(g,f){this._updateTextureFromVideo(g);g.drawArrays(g.TRIANGLE_STRIP,0,4);},_updateTextureFromVideo:function(f){f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,this.video);},isIE:function(){return/msie|trident/.test(navigator.userAgent.toLowerCase());},ieProcessGlFrame:function(g,f){this._ieUpdateTextureFromVideo(g);g.drawArrays(g.TRIANGLE_STRIP,0,4);},_ieUpdateTextureFromVideo:function(f){this.bufferCtx.drawImage(this.video,0,0);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,this.buffer);},_clearGlMode:function(f){f.clear(f.COLOR_BUFFER_BIT);},_setupGlContext:function(f){if(this.isIE()){if(this.doDebug){console.log("Using alternate IE render mode.");}this._ieGlSetup();}f.enableVertexAttribArray(0);f.viewport(0,0,this.output.width,this.output.height);if(this.doDebug){f.clearColor(0,0,0,0.1);}else{f.clearColor(0,0,0,0);}f.clear(f.COLOR_BUFFER_BIT);this.program=this._compileProgram(f,this.SHADER_VERTEX,this.SHADER_FRAGMENT);f.useProgram(this.program);this._getGlDataLocations(f);this._createAndBindTexCoordData(f);this._createAndBindTexture(f);this._createAndBindVertexData(f);},_ieGlSetup:function(){this.buffer=this.buffer||this.makeBufferCanvas();this.bufferCtx=this.buffer.getContext("2d");},_getGlDataLocations:function(f){this.aTexCoord_loc=f.getAttribLocation(this.program,"aTexCoord");this.aPosition_loc=f.getAttribLocation(this.program,"aPosition");this.uImage_loc=f.getUniformLocation(this.program,"uImage");},_createAndBindVertexData:function(f){this.vbuffer=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,this.vbuffer);f.bufferData(f.ARRAY_BUFFER,new Float32Array([-1,1,1,1,-1,-1,1,-1]),f.STATIC_DRAW);f.enableVertexAttribArray(this.aPosition_loc);f.vertexAttribPointer(this.aPosition_loc,2,f.FLOAT,false,0,0);},_createAndBindTexCoordData:function(f){this.texCoordBuffer=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,this.texCoordBuffer);f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,0.5,1,0.5]),f.STATIC_DRAW);f.enableVertexAttribArray(this.aTexCoord_loc);f.vertexAttribPointer(this.aTexCoord_loc,2,f.FLOAT,false,0,0);f.uniform2f(f.getUniformLocation(this.program,"uHalfTexOffset"),0,0.5);},_createAndBindTexture:function(f){this.stackTexture=f.createTexture();f.bindTexture(f.TEXTURE_2D,this.stackTexture);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST);},_compileProgram:function(k,i,j){var l;var g;var h;l=k.createShader(k.VERTEX_SHADER);k.shaderSource(l,i);k.compileShader(l);g=k.createShader(k.FRAGMENT_SHADER);k.shaderSource(g,j);k.compileShader(g);h=k.createProgram();k.attachShader(h,l);k.attachShader(h,g);k.linkProgram(h);if(!k.getShaderParameter(l,k.COMPILE_STATUS)){console.log("gl.getShaderInfoLog(vs) :: ",k.getShaderInfoLog(l));}if(!k.getShaderParameter(g,k.COMPILE_STATUS)){console.log("gl.getShaderInfoLog(fs) :: ",k.getShaderInfoLog(g));}if(!k.getProgramParameter(h,k.LINK_STATUS)){console.log("gl.getProgramInfoLog(program) :: ",k.getProgramInfoLog(h));}return h;},SHADER_VERTEX:["","  attribute vec2 aPosition;","  attribute vec2 aTexCoord;","  varying vec2 vTexCoord;","  void main() {","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vTexCoord = aTexCoord;","  }",""].join("\n"),SHADER_FRAGMENT:["","  precision highp float;","  uniform sampler2D uImage;","  uniform vec2 uHalfTexOffset;","  varying vec2 vTexCoord;","  void main() {","    vec4 color = texture2D( uImage, vTexCoord );","    vec4 alpha = texture2D( uImage, vTexCoord + uHalfTexOffset );","    color[3] = alpha[0]; // avg alpha","    gl_FragColor = color;","  }",""].join("\n"),_polyfillRequestAnimationFrame:function(){if(window.requestAnimationFrame){if(this.doDebug){console.log("Alphalfa requestAnimFrame :: native requestAnimationFrame");}this.requestAnimFrame=function(f){window.requestAnimationFrame(f);};}else{if(this.doDebug){console.log("Alphalfa requestAnimFrame :: setTimeout polyfill");}this.requestAnimFrame=function(f){clearTimeout(this.interval);this.interval=setTimeout(f,this.FRAMERATEDELAY);};}}};c.exports=d;},{}],50:[function(d,a,f){var g=d("./alphalfa/imdb-alphalfa-player.js");var h=d("./imdb-countdowner.js");var l=d("./imdb-date-checker.js");var c=d("./imdb-peeka.js");var j=d("./imdb-queryo.js");var i=d("./reely/reely.js");var k=d("./imdb-zoolander.js");var b={AlphalfaPlayer:g,Countdowner:h,DateChecker:l,Peeka:c,Reely:i,QueryO:j,Zoolander:k};window.ad_design=b;a.exports=b;},{"./alphalfa/imdb-alphalfa-player.js":49,"./imdb-countdowner.js":51,"./imdb-date-checker.js":52,"./imdb-peeka.js":53,"./imdb-queryo.js":54,"./imdb-zoolander.js":56,"./reely/reely.js":66}],51:[function(c,d,a){var f=c("./imdb-zoolander.js");var b=function(g){if(!g.targetDate){console.warn("Countdowner :: Required argument not provided.");}this.el=g.el||document.createElement("div");this.id="countdowner-"+Date.now()+Math.floor((Math.random()*10000));this.init(g);};b.prototype={defaults:{splitChar:"",doPad:false,hideAfterRelease:false,periods:["days","hours","minutes","seconds"],periodContainerCss:{display:"inline-block"},periodCountCss:{display:"inline-block"},labels:["Days","Hrs","Mins","Secs"],printLabels:false,labelsBelow:true,labelsCss:{display:"inline-block"}},classPrefix:"cd-",init:function(g){this.targetDate=this.determineTargetDate(g.targetDate);this.setConfig(g);if(g.hideAfterRelease&&this.timeRemaining()<=0){return;}this.zoo=g.zoolander||new f();this.injectCss();this.initializeHtml();if(this.printLabels){this.initializeLabels();}this._render();this.renderBind=this._render.bind(this);clearInterval(this.renderInterval);this.renderInterval=setInterval(this.renderBind,1000);},setConfig:function(h){var g=this.addDefaults(h);delete g.targetDate;for(var i in g){if(g.hasOwnProperty(i)){this[i]=g[i];}}},addDefaults:function(h){var g=h;for(var i in this.defaults){if(this.defaults.hasOwnProperty(i)){if(!this.isDefined(h[i])){g[i]=this.defaults[i];}}}return g;},determineTargetDate:function(i){var h;if(typeof i==="object"&&this.isDefined(i.month)){var g=i.date||i.day;h=new Date(i.year,i.month-1,g);}else{if(typeof i==="object"&&i instanceof Date){h=i;}else{if(typeof i==="string"){h=new Date(i);}else{console.warn("No date or invalid date provided. Aborting Countdowner.");}}}return h;},makeEl:function(l,j){var g=this.isDefined(j)?j:"div";var k=document.createElement(g);if(typeof l==="string"){k.classList.add(this.classPrefix+l);}else{for(var h=0;h<l.length;h++){k.classList.add(this.classPrefix+l[h]);}}return k;},initializeHtml:function(){this.container=this.makeEl("container");this.container.id=this.id;var k=this.periods;this.periodEls=[];var j=k[k.length-1];for(var h=0;h<k.length;h++){var g=this.makePeriodContainer(k[h]);this.container.appendChild(g);this.periodEls[k[h]]=g;if(this.splitChar&&this.splitChar!==""&&k[h]!==j){this.container.appendChild(this.makeSplitContainer());}}this.el.innerHTML="";this.el.appendChild(this.container);},appendCountChildren:function(g){var h=this.makeEl("count","div");g.appendChild(h);},makePeriodContainer:function(h){var g=this.makeEl([h,"period-container"]);this.appendCountChildren(g);return g;},makeSplitContainer:function(){var g=this.makeEl("split-el","span");g.innerHTML=" "+this.splitChar+" ";return g;},initializeLabels:function(){for(var j=0;j<this.labels.length;j++){var h=this.makeLabel(this.labels[j],this.periods[j]);var g=this.periodEls[this.periods[j]];if(this.labelsBelow){g.appendChild(h);}else{g.insertBefore(h,g.children[0]);}}},makeLabel:function(i,h){var g=this.makeEl(["label","label-"+h],"span");g.innerHTML=i;return g;},msSec:1000,msMin:1000*60,msHour:1000*60*60,msDay:1000*60*60*24,timeRemaining:function(){var g=Date.now();var h=this.targetDate.valueOf()-g;return(h>0)?h:0;},calcRemaining:function(){var g={days:0,hours:0,minutes:0,seconds:0};var j=this.timeRemaining();if(j===0){return g;}var h=j;g.days=Math.floor(h/this.msDay);h-=g.days*this.msDay;g.hours=Math.floor(h/this.msHour);h-=g.hours*this.msHour;g.minutes=Math.floor(h/this.msMin);h-=g.minutes*this.msMin;g.seconds=Math.floor(h/this.msSec);if(this.doPad){for(var i in g){if(g.hasOwnProperty(i)){g[i]=this.pad(g[i]);}}}return g;},pad:function(g){if(g>=10){return g;}return"0"+g;},container:function(){return this.el.children[0];},el:function(g){if(arguments.length){this.el=g;return this;}return this.el;},_render:function(){var g=this.calcRemaining();this.periodEls.days.children[0].innerHTML=g.days;this.periodEls.hours.children[0].innerHTML=g.hours;this.periodEls.minutes.children[0].innerHTML=g.minutes;this.periodEls.seconds.children[0].innerHTML=g.seconds;},injectCss:function(){var i="#"+this.id;var g=i+" ."+this.classPrefix;var h=[[i,{"box-sizing":"border-box"}],[i+" *",{"box-sizing":"inherit"}],[g+"period-container",this.periodContainerCss],[g+"count",this.periodCountCss],[g+"label",this.labelsCss]];this.zoo.insertRules(h);},isDefined:function(g){return typeof g!=="undefined";}};d.exports=b;},{"./imdb-zoolander.js":56}],52:[function(c,d,b){var a=function(f){this.setDateStrings(f);this.setDateObjects();this.determineReleasesWhen();this.determineFallbackReleasesWhen();};a.prototype={RELEASES:{ON_DATE:"onDate",NOW_PLAYING:"nowPlaying",TODAY:"today",TOMORROW:"tomorrow",THIS_DAYNAME:"thisDayname",NEXT_DAYNAME:"nextDayname",},getReleasePhase:function(){return this.releasesWhen;},getFallbackReleasePhase:function(){return this.fallbackReleasesWhen;},setDateStrings:function(f){this.releaseDateString=f.releaseDate;if(f.thisDaynameDate){this.hasThisDayname=true;this.thisDaynameDateString=f.thisDaynameDate;}else{this.hasThisDayname=false;}if(f.nextDaynameDate){this.hasNextDayname=true;this.nextDaynameDateString=f.nextDaynameDate;}else{this.hasNextDayname=false;}},setDateObjects:function(){var f=new Date();this.nowDate=new Date(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0,0);this.releaseDate=new Date(this.releaseDateString);this.tomorrowDate=this._releaseRelativeDate("-",1);this.nowPlayingDate=this._releaseRelativeDate("+",1);if(this.hasThisDayname){this.thisDaynameDate=new Date(this.thisDaynameDateString);}if(this.hasNextDayname){this.nextDaynameDate=new Date(this.nextDaynameDateString);}},determineReleasesWhen:function(){var g=this.releaseDate-this.nowDate;var f=this._msToDays(g);if(f<0){this.releasesWhen=this.RELEASES.NOW_PLAYING;}else{if(f===0){this.releasesWhen=this.RELEASES.TODAY;}else{if(f===1){this.releasesWhen=this.RELEASES.TOMORROW;}else{if(this.hasThisDayname&&this.nowDate>this.thisDaynameDate){this.releasesWhen=this.RELEASES.THIS_DAYNAME;}else{if(this.hasNextDayname&&this.nowDate>this.nextDaynameDate){this.releasesWhen=this.RELEASES.NEXT_DAYNAME;}else{this.releasesWhen=this.RELEASES.ON_DATE;}}}}}},determineFallbackReleasesWhen:function(){switch(this.releasesWhen){case this.RELEASES.NOW_PLAYING:case this.RELEASES.ON_DATE:this.fallbackReleasesWhen=this.RELEASES.ON_DATE;break;case this.RELEASES.TODAY:this.fallbackReleasesWhen=this.RELEASES.NOW_PLAYING;break;case this.RELEASES.TOMORROW:if(this.hasThisDayname){this.fallbackReleasesWhen=this.RELEASES.THIS_DAYNAME;}else{this.fallbackReleasesWhen=this.RELEASES.ON_DATE;}break;case this.RELEASES.THIS_DAYNAME:case this.RELEASES.NEXT_DAYNAME:this.fallbackReleasesWhen=this.RELEASES.ON_DATE;break;}},_releaseRelativeDate:function(g,h){var f=new Date(this.releaseDateString);if(g==="+"){f.setDate(f.getDate()+h);}else{if(g==="-"){f.setDate(f.getDate()-h);}}return f;},_msToDays:function(f){return Math.ceil(f/1000/60/60/24);},};a.prototype.constructor=a;d.exports=a;},{}],53:[function(b,c,a){var f=b("./imdb-zoolander.js");var d=function(g){if(!g||!g.el||!g.imageUrls){console.warn("Peeka: Required options not found. Aborting gallery creation.");return;}this.nonce=Date.now()+(Math.floor(Math.random()*10));this.elNonceClass="peeka-container-"+this.nonce;this.el=this.processEl(g.el);this.imageUrls=g.imageUrls;this.imageEls=[];this.imageReadyListener=undefined;this.zoo=(g&&g.zoolander)?g.zoolander:new f();this.height=g.height;this.width=g.width;this.currentIndex=0;this.styleOptions={arrowWidth:20,arrowHeight:15,arrowColor:"rgba(255, 255, 255, 0.75)",bgColor:"#000000",borderWidth:0,borderColor:"transparent"};if(g.styleOptions){this.processStyleOptions(g.styleOptions);}this.createDomElements();this.stylize();};d.prototype={onImageReady:function(g){this.initialImageHasLoaded=true;this.imageEls[0].removeEventListener("load",this.imageReadyListener);this.addImageTransitions();this.setActiveImg();},next:function(g){this.incrementIndex().setActiveImg();},previous:function(g){this.decrementIndex().setActiveImg();},changeSlideTo:function(i){var h=this.isDef(i)?i:this.currentIndex;var g=this.imageEls.length-1;h=(h>g)?g:h;this.currentIndex=h;this.setActiveImg();return this;},setActiveImg:function(){for(var h=0,g=this.imageEls.length;h<g;h++){this.imageEls[h].classList.remove("peeka-active");}this.imageEls[this.currentIndex].classList.add("peeka-active");return this;},incrementIndex:function(){this.currentIndex++;if(this.currentIndex>this.imageEls.length-1){this.currentIndex=0;}return this;},decrementIndex:function(){this.currentIndex--;if(this.currentIndex<0){this.currentIndex=this.imageEls.length-1;}return this;},createDomElements:function(){this.createHudLayer();this.createImageLayer();},createHudLayer:function(){var g=this.hudLayer=document.createElement("div");g.id="peeka-hud-layer-"+this.nonce;g.classList.add("peeka-hud-layer");this.nextArrow=this.createArrow(true);this.previousArrow=this.createArrow(false);g.appendChild(this.nextArrow);g.appendChild(this.previousArrow);this.el.appendChild(g);this.attachArrowEventHandlers();},createArrow:function(g){var i=(g)?"peeka-arrow-container-right":"peeka-arrow-container-left";var h=(g)?"peeka-arrow-right":"peeka-arrow-left";var k=document.createElement("div");k.classList.add("peeka-arrow-container");k.classList.add(i);var j=document.createElement("div");j.classList.add("peeka-arrow");j.classList.add(h);k.appendChild(j);return k;},attachArrowEventHandlers:function(){var g=this;this.nextArrow.addEventListener("click",function(h){g.next();});this.previousArrow.addEventListener("click",function(h){g.previous();});},getNextArrowEl:function(){return this.nextArrow;},getPreviousArrowEl:function(){return this.previousArrow;},createImageLayer:function(){var g=this.imageLayer=document.createElement("div");g.id="peeka-image-layer-"+this.nonce;g.classList.add("peeka-image-layer");this.el.appendChild(g);this.createImageEls();},createImageEls:function(){this.imageReadyListener=this.onImageReady.bind(this);for(var j=0,g=this.imageUrls.length;j<g;j++){var h=document.createElement("img");if(j===0){h.addEventListener("load",this.imageReadyListener);}h.src=this.imageUrls[j];h.classList.add("peeka-image");this.imageEls.push(h);this.imageLayer.appendChild(h);}},isDef:function(g){return(typeof g!=="undefined");},processEl:function(i){var g;if(typeof i==="string"&&i[0]==="#"){var h=i.substr(1);g=document.getElementById(h);}else{if(typeof i==="object"&&"style" in i){g=i;}}g.classList.add(this.elNonceClass);g.style.position="relative";g.style.display="inline-block";return g;},processStyleOptions:function(g){this.processStyleOption(g,"arrowWidth");this.processStyleOption(g,"arrowHeight");this.processStyleOption(g,"arrowColor");this.processStyleOption(g,"bgColor");this.processStyleOption(g,"borderWidth");this.processStyleOption(g,"borderColor");},processStyleOption:function(g,h){if(this.isDef(g[h])){this.styleOptions[h]=g[h];}},stylize:function(){this.zoo.insertRule("."+this.elNonceClass,{height:this.height+"px",width:this.width+"px","background-color":this.styleOptions.bgColor+";",border:this.styleOptions.borderWidth+"px solid "+this.styleOptions.borderColor+";"});var g="#"+this.hudLayer.id;this.zoo.insertRule(g,{position:"absolute",display:"block","z-index":"314159",width:"100%",height:"100%","pointer-events":"none"});var j=this.nextArrow.clientHeight;var i=this.styleOptions.arrowHeight;var h=this.styleOptions.arrowWidth;var k=3;this.zoo.insertRules([[g+" .peeka-arrow-container",{position:"absolute",top:(this.height/2-j/2)+"px",cursor:"pointer","pointer-events":"auto","user-select":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none"}],[g+" .peeka-arrow-container-right",{right:k+"px"}],[g+" .peeka-arrow-container-left",{left:k+"px"}],[g+" .peeka-arrow",{"border-top":i+"px solid transparent","border-bottom":i+"px solid transparent",width:"0",height:"0"}],[g+" .peeka-arrow-right",{"border-left":h+"px solid "+this.styleOptions.arrowColor}],[g+" .peeka-arrow-left",{left:k+"px","border-right":h+"px solid "+this.styleOptions.arrowColor}]]);this.zoo.insertRule(".peeka-arrow-container-"+this.nonce,{background:"black"});var l="#"+this.imageLayer.id;this.zoo.insertRules([[l+" img",{position:"absolute",top:"0",left:"0",opacity:"0","max-height":this.height+"px","max-width":this.width+"px"}],[l+" .peeka-image.peeka-active",{opacity:"1",}],]);},addImageTransitions:function(){var g="#"+this.imageLayer.id;this.zoo.insertRule(g+" .peeka-image",{transition:"opacity 0.25s linear"});}};d.prototype.constructor=d;c.exports=d;},{"./imdb-zoolander.js":56}],54:[function(b,d,a){var c=(function(){var g;var h;function f(){var i=window.location.href;if(i.indexOf("?")===-1){return"";}return i.substr(i.indexOf("?")+1);}g=f();if(!g.length){h={};}return{obj:function(){if(h){return h;}var l;var j={};l=this._getCleanString().split("&");for(var k=0;k<l.length;k++){var m=l[k].split("=");j[m[0]]=this._toStr(m[1]);}h=j;return h;},get:function(j,i){if(!j){return this.obj();}var k=this.obj()[j];if(!k){return;}if(!i||!i.as){return this._toStr(k);}return this._getAsType(k,i);},_getAsType:function(l,j){var k=j.as.toLowerCase();var i;switch(k){case"array":return this._toArray(l,j);case"number":return this._toNum(l);default:return this._toStr(l);}},_toArray:function(o,k){var j;var m=k.splitter||",";j=o.split(m);if(k.of){var n=k.of.toLowerCase();if(n!=="array"&&n!=="number"){return j;}for(var l=0;l<j.length;l++){switch(n){case"array":j[l]=this._toArray(j[l]);break;case"number":j[l]=this._toNum(j[l]);break;default:}}}return j;},_toNum:function(i){if(i.indexOf(",")!==-1){return parseFloat(i);}return parseInt(i,10);},_toStr:function(i){return decodeURIComponent(i);},_getCleanString:function(){var i=g;if(i.indexOf("#")!==-1){i.substr(0,i.indexOf("#"));}return i;}};})();d.exports=c;},{}],55:[function(b,d,a){var c=(function(){var l="-webkit";var g="-moz";var f="-ms";var k="-o";var j={"box-shadow":[l],transform:[l,f,g,k],perspective:[l,f],"box-sizing":[l,f,g],"background-size":[l],"user-select":[l,g,f],animation:[l,g,k],transition:[l,g,k],filter:[l,g,f,k]};var h=[];for(var i in j){if(j.hasOwnProperty(i)){h.push(i);}}return{needsFixer:function(m){return(h.indexOf(m)!==-1);},prefixedProps:function(q){var n=[q];if(!this.needsFixer(q)){return n;}var p=j[q];var m;for(var o=0;o<p.length;o++){m=p[o]+"-"+q;n.push(m);}return n;}};})();d.exports=c;},{}],56:[function(b,d,a){var c=b("./imdb-zoofixer.js");var f=function(i,h,j){this.index=i;this.selector=h;this.styleText=j;};var g=function(h){this.doc=this._determineDocument(h);this.styleElId=this._determineStyleElId(h);this.styleEl=this._createStyleEl(this.styleElId);this.prefixId=this._determinePrefixId(h);this.doc.head.appendChild(this.styleEl);this.ss=this.styleEl.sheet;this.isFrozen=false;this._useInsertRule=("insertRule" in this.ss);this._rulesKey=this._determineRulesKey();this._animPrefix=this._determineAnimationPrefix();this.NULLSELECTOR=".NULLRULE"+this.styleElId;};g.prototype={rules:function(){return this.ss[this._rulesKey];},teardown:function(){this.doc=null;this.ss=null;this.styleEl=null;},freeze:function(){this.isFrozen=true;},unfreeze:function(){this.isFrozen=false;},insertRule:function(j,i){if(this.isFrozen){return;}if(!j||!i){console.warn("Bad selectors and/or stylesObj provided to Zoolander.");return;}var h=this._determineSelectors(j);var k=this._determineStylesText(i);return this._insertRule(h,k);},insertRules:function(o){if(this.isFrozen){return;}var h=[];for(var l=0;l<o.length;l++){var m=o[l];var k=m[0];var j=m[1];var n=this.insertRule(k,j);h.push(n);}return h;},deleteRule:function(h){if(typeof h==="undefined"||this.isFrozen){return;}this.ss.deleteRule(h.index);this._attemptInsert(this.NULLSELECTOR,"",h.index);},insertKeyframes:function(h,k){var i="@"+this._animPrefix+"keyframes "+h;var j=this._determineKeyframesStyleText(k);return this._insertRule(i,j,true);},insertAnimation:function(i,l,k){var h=this._determineSelectors(i);var j=this._animPrefix+l+": "+k;return this._insertRule(h,j);},_insertRule:function(k,j,i){var h=this.rules().length;try{this._attemptInsert(k,j,h,i);}catch(m){console.warn("Zoolander failed to insertRule :: "+m);return;}var l=new f(h,k,j);return l;},_attemptInsert:function(j,i,k,h){var l=(h)?"":this.prefixId;if(this._useInsertRule){this.ss.insertRule(l+j+" {"+i+"}",k);}else{this.ss.addRule(l+j,i,k);}},_createStyleEl:function(h){var i="imdb_ad_design_injected_"+h;var j=this.doc.getElementById(i);if(j){return j;}j=this.doc.createElement("style");j.type="text/css";j.id=i;j.appendChild(this.doc.createTextNode(""));return j;},_determineStyleElId:function(h){if(h&&h.id){return h.id;}else{var i=Date.now()+(Math.floor(Math.random()*10));return i;}},_determineDocument:function(h){return(h&&h.document)?h.document:document;},_determinePrefixId:function(i){var h=(i&&i.prefixId)?i.prefixId:"";if(h){var j=(h.charAt(0)==="#")?h:"#"+h;j=(j.charAt(j.length-1)===" ")?j:j+" ";return j;}return"";},_isArr:function(h){return Object.prototype.toString.call(h)==="[object Array]";},_determineSelectors:function(h){if(this._isArr(h)){return this._concatSelectors(h);}else{return h;}},_concatSelectors:function(j){var l="";for(var h=0;h<j.length;h++){var k=(h===j.length-1);l+=j[h];if(!k){l+=", ";}}return l;},_determineAnimationPrefix:function(){var k=["webkit","Moz","ms"];var l=this.doc.createElement("div");var h="";for(var j=0;j<k.length;j++){if(l.style[k[j]+"AnimationName"]!==undefined){h="-"+k[j].toLowerCase()+"-";break;}}return h;},_determineStylesText:function(i){var h="";for(var j in i){if(i.hasOwnProperty(j)){h+=this._buildStyleDeclaration(j,i[j]);}}return h;},_buildStyleDeclaration:function(m,n){var l=c.needsFixer(m);if(!l){return m+": "+n+"; ";}else{var h="";var k=c.prefixedProps(m);for(var j=0;j<k.length;j++){h+=k[j]+": "+n+"; ";}return h;}},_determineKeyframesStyleText:function(k){var j="";for(var h in k){if(k.hasOwnProperty(h)){var i=this._determineStylesText(k[h]);j+=this._buildKeyframeStylesText(h,i);}}return j;},_buildKeyframeStylesText:function(h,i){return h+" { "+i+" } ";},_determineRulesKey:function(){if("cssRules" in this.ss){return"cssRules";}else{return"rules";}}};g.prototype.constructor=g;d.exports=g;},{"./imdb-zoofixer.js":55}],57:[function(d,g,b){var i=d("./reely-scrubber.js");var f=d("./reely-css-classes.js");var h=d("./reely-el-maker.js");var a=d("./reely-events.js");var c=function(j){this.eventBus=j.eventBus;this.dimensions=j.dimensions;this.controlBarConfig=j.controlBarConfig;this.spritesheet=j.spritesheet;this.zoo=j.zoo;this.init();};c.prototype={FADE_DELAY_SECS:2,init:function(){this.el=h.make("div",f.CONTROL_BAR_CONTAINER);this.el.style.display="none";this.controlBar=h.make("div",[f.CONTROL_BAR,f.REPEAT_X_SPRITE+"-controlsBG"]);this.appendTableLayoutDivs(this.controlBar);this.injectControlsStyles();this.populateControls();this.el.appendChild(this.controlBar);this.fadeOutBind=this.fadeOut.bind(this);this.resetFadeOutDelay();this.broadcastInteraction();this.listen();},populateControls:function(){this.createControlButtons();this.scrubber=new i({eventBus:this.eventBus,spritesheet:this.spritesheet,dimensions:this.dimensions,zoo:this.zoo});this.midCell.appendChild(this.scrubber.getEl());},clearFadeOutDelay:function(){clearTimeout(this.fadeOutDelay);},resetFadeOutDelay:function(){this.clearFadeOutDelay();this.fadeOutDelay=setTimeout(this.fadeOutBind,this.FADE_DELAY_SECS*1000);},fadeIn:function(){f.remove(this.el,f.TRANSPARENT);this.eventBus.trigger(a.FADE_IN_START);},fadeOut:function(){f.add(this.el,f.TRANSPARENT);this.eventBus.trigger(a.FADE_OUT_START);},broadcastInteraction:function(){this.el.addEventListener("mousemove",this.eventBus.triggers[a.MOUSE_MOVE]);},listen:function(){this.eventBus.addEventListener(a.VID_LOADEDDATA,this.onLoadedData,this);this.eventBus.addEventListener(a.VID_PLAY,this.togglePlayPause,this,"play");this.eventBus.addEventListener(a.VID_PAUSE,this.togglePlayPause,this,"pause");this.eventBus.addEventListener(a.MUTED,this.toggleMuteUnmute,this,"unmuted");this.eventBus.addEventListener(a.UNMUTED,this.toggleMuteUnmute,this,"muted");this.eventBus.addEventListener(a.MOUSE_IN,this.onMouseIn,this);this.eventBus.addEventListener(a.MOUSE_OUT,this.onMouseOut,this);this.eventBus.addEventListener(a.MOUSE_MOVE,this.onMouseMove,this);},teardown:function(){this.clearFadeOutDelay();this.scrubber.teardown();this.el.removeEventListener("mousemove",this.eventBus.triggers[a.MOUSE_MOVE]);this.eventBus.removeEventListener(a.VID_LOADEDDATA,this.onLoadedData,this);this.eventBus.removeEventListener(a.VID_PLAY,this.togglePlayPause,this,"play");this.eventBus.removeEventListener(a.VID_PAUSE,this.togglePlayPause,this,"pause");this.eventBus.removeEventListener(a.MUTED,this.toggleMuteUnmute,this,"unmuted");this.eventBus.removeEventListener(a.UNMUTED,this.toggleMuteUnmute,this,"muted");this.eventBus.removeEventListener(a.MOUSE_IN,this.onMouseIn,this);this.eventBus.removeEventListener(a.MOUSE_OUT,this.onMouseOut,this);this.eventBus.removeEventListener(a.MOUSE_MOVE,this.onMouseMove,this);},onLoadedData:function(j){this.el.style.display="";},togglePlayPause:function(l){var j=this.isToggled(this.playPause);var k=(!j&&l==="play"||j&&l==="pause");if(k){this.toggleTwoState(this.playPause);}},toggleMuteUnmute:function(l){var j=this.isToggled(this.muteUnmute);var k=(!j&&l==="muted"||j&&l==="unmuted");if(k){this.toggleTwoState(this.muteUnmute);}},isToggled:function(j){return f.contains(j,f.TOGGLED);},toggleTwoState:function(j){if(this.isToggled(j)){f.remove(j,f.TOGGLED);}else{f.add(j,f.TOGGLED);}},onMouseIn:function(j){this.fadeIn();},onMouseMove:function(j){this.fadeIn();this.resetFadeOutDelay();},onMouseOut:function(j){this.resetFadeOutDelay();},appendTableLayoutDivs:function(j){this.midCell=h.make("div",f.CONTROL_BAR_MID);this.leftCell=h.make("div",f.CONTROL_BAR_LEFT);this.rightCell=h.make("div",f.CONTROL_BAR_RIGHT);j.appendChild(this.midCell);j.appendChild(this.leftCell);j.appendChild(this.rightCell);},createControlButtons:function(){this.playPause=h.createTwoStateButton("play-pause",[{defaultIconName:"play",hoverIconName:"play-hover"},{defaultIconName:"pause",hoverIconName:"pause-hover"}]);this.muteUnmute=h.createTwoStateButton("mute-unmute",[{defaultIconName:"sound-off",hoverIconName:"sound-off-hover"},{defaultIconName:"sound-on",hoverIconName:"sound-on-hover"}]);this.playPause.addEventListener("click",this.eventBus.triggerBind(a.PLAY_PAUSE_TOGGLE));this.leftCell.appendChild(this.playPause);this.muteUnmute.addEventListener("click",this.eventBus.triggerBind(a.MUTE_UNMUTE_TOGGLE));this.rightCell.appendChild(this.muteUnmute);},injectControlsStyles:function(){var j=[];j=j.concat(this.getButtonStyles());j=j.concat(this.getControlBarStyles());this.zoo.insertRules(j);},determineButtonVisualWidth:function(){return this.dimensions.spriteWidth+(this.dimensions.buttonPadding*2);},determineContainerStyles:function(){var k=this.controlBarConfig;var j={position:"absolute",display:"inline-block",height:k.height+"px",width:"100%",transition:"opacity 1s ease"};if(k.anchorX==="center"){j.margin="0 auto";j.textAlign="center";}j[k.anchorY]=k.offsetY;return j;},determineBarElStyles:function(){var k=this.controlBarConfig;var j={position:"relative",display:"block",height:"inherit",width:k.width,"background-color":"transparent","background-position":"0 0","background-repeat":"repeat-x",};if(!this.controlBarConfig.hideBG){j["background-image"]='url("'+this.spritesheet.getSrc()+'")';}if(k.anchorX==="center"){j.margin="0 auto";}else{j[k.anchorX]=k.offsetX;}return j;},getButtonStyles:function(){return[["."+f.BUTTON_ICON,{height:this.dimensions.spriteHeight+"px",width:this.dimensions.spriteWidth+"px",padding:this.dimensions.buttonPadding+"px"}]];},getControlBarStyles:function(){var m=this.determineButtonVisualWidth();var j=this.determineContainerStyles();var l=this.determineBarElStyles();var k=[["."+f.CONTROL_BAR_CONTAINER,j],["."+f.CONTROL_BAR,l],[["."+f.CONTROL_BAR_LEFT,"."+f.CONTROL_BAR_RIGHT],{display:"inline-block",height:"100%",width:m+"px",}],["."+f.CONTROL_BAR_LEFT,{"float":"left"}],["."+f.CONTROL_BAR_RIGHT,{"float":"right"}],["."+f.CONTROL_BAR_MID,{position:"absolute",left:"0",display:"block",height:"100%",width:"100%","box-sizing":"border-box","padding-left":m+"px","padding-right":m+"px",}]];return k;}};g.exports=c;},{"./reely-css-classes.js":58,"./reely-el-maker.js":59,"./reely-events.js":61,"./reely-scrubber.js":64}],58:[function(b,d,a){var c={WRAPPER:"reely-wrapper",CONTAINER:"reely-container",VIDEO:"reely-video",OVERLAY_CONTAINER:"reely-overlay-container",CONTROL_BAR_CONTAINER:"reely-control-bar-container",CONTROL_BAR:"reely-control-bar",CONTROL_BAR_LEFT:"reely-control-bar-left",CONTROL_BAR_RIGHT:"reely-control-bar-right",CONTROL_BAR_MID:"reely-control-bar-mid",BUTTON:"reely-button",BUTTON_ICON:"reely-button-icon",BUTTON_ICON_LARGE:"reely-button-icon-large",TWO_STATE_BUTTON:"reely-two-state",TWO_STATE_DEFAULT:"reely-two-state-default",TWO_STATE_ALT:"reely-two-state-toggled",REPEAT_X_SPRITE:"reely-repeat-x-sprite",ICON_LARGE:"reely-icon-large",ICON:"reely-icon",ICON_DEFAULT:"reely-default-icon",ICON_HOVER:"reely-hover-icon",ICON_ACTIVE:"reely-toggle-active",ICON_DOWN:"reely-toggle-down",LOADING_SPINNER:"reely-loading-spinner",SCRUBBER_CONTAINER:"reely-scrubber-container",TOGGLED:"reely-toggled",UNSELECTABLE:"reely-unselectable",HIDDEN:"reely-hidden",INVISIBLE:"reely-invisible",TRANSPARENT:"reely-transparent",add:function(g,f){if(typeof f==="undefined"){console.warn("Attempted to add() an undefined class.");}switch(this.mode()){case"modern":return g.classList.add(f);case"oldIE":return g.className+=" "+f;}},contains:function(g,f){if(typeof f==="undefined"){console.warn("Attempted to check contains() an undefined class.");}switch(this.mode()){case"modern":return g.classList.contains(f);case"oldIE":return g.className.split(" ").indexOf(f)!==-1;}},remove:function(g,f){if(typeof f==="undefined"){console.warn("Attempted to remove() an undefined class.");}if(!this._removeClass){this._removeClass=this.removeModes[this.mode()];}this._removeClass(g,f);},removeModes:{modern:function(g,f){g.classList.remove(f);},oldIE:function(i,h){var f=i.className.split(" ");var g=f.indexOf(h);if(g!==-1){f.splice(g,1);}i.className=f.join(" ");}},mode:function(){if(!this._mode){var f=document.createElement("div");this._mode=("classList" in f)?"modern":"oldIE";f=undefined;}return this._mode;}};d.exports=c;},{}],59:[function(b,d,a){var c=b("./reely-css-classes.js");var f={make:function(g,i,j){var h=document.createElement(g);h.setAttribute("class",this.arrayWrap(i).join(" "));if(j){h.id=j;}return h;},createIcon:function(h,g){return this._createIcon(c.ICON,h,g);},createLargeIcon:function(h,g){return this._createIcon(c.ICON_LARGE,h,g);},_createIcon:function(i,j,h){var g=this.concatClasses([i,i+"-"+j],h);return this.make("div",g);},createRepeatXSprite:function(i,h){var g=this.concatClasses([c.REPEAT_X_SPRITE,c.REPEAT_X_SPRITE+"-"+i],h);return this.make("div",g);},createSpriteEl:function(g,i){var h=g;if(i){h=this.concatClasses(h,i);}return this.make("div",h);},concatClasses:function(h,g){if(!g){return h;}if(typeof g==="string"){h.push(g);return h;}else{return h.concat(g);}},createTwoStateButton:function(i,h){var j=this.createIcon;var g=c.BUTTON_ICON;return this._createTwoStateButton(i,h,g,j);},createLargeTwoStateButton:function(i,h){var j=this.createLargeIcon;var g=c.BUTTON_ICON_LARGE;return this._createTwoStateButton(i,h,g,j);},_createTwoStateButton:function(k,i,h,m){var l=this.make("div",[c.TWO_STATE_BUTTON,c.TWO_STATE_BUTTON+"-"+k]);var g=this.createButtonState(i[0],c.TWO_STATE_DEFAULT,h,m);var j=this.createButtonState(i[1],c.TWO_STATE_ALT,h,m);l.appendChild(g);l.appendChild(j);return l;},createButtonState:function(i,h,g,j){if(!j){j=this.createIcon;}if(!g){g=c.BUTTON_ICON;}return this._createButtonState(i,h,g,j);},_createButtonState:function(k,i,h,l){var m=[c.BUTTON,c.UNSELECTABLE];m.push(h);if(i){m=m.concat(this.arrayWrap(i));}var g=this.make("div",m);var n=l.call(this,k.defaultIconName,c.ICON_DEFAULT);var j=l.call(this,k.hoverIconName,c.ICON_HOVER);g.appendChild(n);g.appendChild(j);return g;},arrayWrap:function(g){if(typeof g==="undefined"){return[];}else{if(Object.prototype.toString.call(g)!=="[object Array]"){return[g];}}return g;}};d.exports=f;},{"./reely-css-classes.js":58}],60:[function(d,f,c){var b=d("./reely-events.js");var a=function(){this.init();};a.prototype={reelyEvents:[],init:function(){this.triggers={};this.listeners={};this.reelyEvents=this.getReelyEventsArray();for(var g=0;g<this.reelyEvents.length;g++){var h=this.reelyEvents[g];this.triggers[h]=this.triggerBind(h);this.listeners[h]=[];}},getReelyEventsArray:function(){var h=[];for(var g in b){if(b.hasOwnProperty(g)){h.push(b[g]);}}return h;},addEventListener:function(g,k,i){if(!this.listeners[g]){console.warn("Attempted to addEventListener with unsupported event :: ",g);}var h=Array.prototype.slice.call(arguments);h.splice(0,3);var j={callback:k,context:i,args:h};this.listeners[g].push(j);},removeEventListener:function(g,m,j){if(!this.listeners[g]){console.warn("Attempted to removeEventListener with unsupported event :: ",g);}var l=this.listeners[g].slice();var k;for(var h=0;h<l.length;h++){k=l[h];if(k.callback===m&&k.context===j){l.splice(h,1);break;}}this.listeners[g]=l;},triggerBind:function(g,h){return this.trigger.bind(this,g);},trigger:function(g){if(!this.listeners[g]){console.warn("Attempted to trigger an unsupported event :: ",g);}var h=Array.prototype.slice.call(arguments);h.splice(0,1);var k=this.listeners[g];var l;var m=[];for(var j=0;j<k.length;j++){l=k[j];m=l.args.concat(h);l.callback.apply(l.context,m);}}};f.exports=a;},{"./reely-events.js":61}],61:[function(c,d,b){var a={STARTED:"started",PLAY_PAUSE_TOGGLE:"playPauseToggle",MUTE_UNMUTE_TOGGLE:"muteUnmuteToggle",SCRUBBER_BAR_CLICK:"scrubberBarClick",MOUSE_IN:"mouseIn",MOUSE_OUT:"mouseOut",MOUSE_MOVE:"mouseMove",MUTED:"muted",UNMUTED:"unmuted",VID_LOADSTART:"video:loadstart",VID_LOADEDMETADATA:"video:loadedmetadata",VID_LOADEDDATA:"video:loadeddata",VID_CANPLAY:"video:canplay",VID_CANPLAYTHROUGH:"video:canplaythrough",VID_WAITING:"video:waiting",VID_PROGRESS:"video:progress",VID_SUSPEND:"video:suspend",VID_PLAY:"video:play",VID_PLAYING:"video:playing",VID_PAUSE:"video:pause",VID_TIMEUPDATE:"video:timeupdate",VID_ENDED:"video:ended",FADE_OUT_START:"reely:fadeoutstart",FADE_IN_START:"reely:fadeinstart"};d.exports=a;},{}],62:[function(d,g,c){var f=d("./reely-css-classes.js");var h=d("./reely-el-maker.js");var b=d("./reely-events.js");var a=function(i){this.eventBus=i.eventBus;this.zoo=i.zoo;this.init();};a.prototype={PROGRESS_TICKS_TO_SHOW:5,init:function(){this.el=h.make("div",f.LOADING_SPINNER+"-outer-container");this.innerContainer=h.make("div",f.LOADING_SPINNER+"-inner-container");this.spinner=h.make("div",f.LOADING_SPINNER);this.hide();this.innerContainer.appendChild(this.spinner);this.el.appendChild(this.innerContainer);this.injectLoadingSpinnerCSS();this.progressTicks=0;this.listen();},listen:function(){this.eventBus.addEventListener(b.VID_LOADEDMETADATA,this.onLoadedMetadata,this);this.eventBus.addEventListener(b.VID_CANPLAY,this.onCanPlay,this);this.eventBus.addEventListener(b.VID_PROGRESS,this.onProgress,this);this.eventBus.addEventListener(b.VID_SUSPEND,this.onSuspend,this);this.eventBus.addEventListener(b.VID_TIMEUPDATE,this.onTimeUpdate,this);this.eventBus.addEventListener(b.VID_PLAY,this.onPlay,this);this.eventBus.addEventListener(b.VID_PAUSE,this.onPause,this);},teardown:function(){this.eventBus.removeEventListener(b.VID_LOADEDMETADATA,this.onLoadedMetadata,this);this.eventBus.removeEventListener(b.VID_CANPLAY,this.onCanPlay,this);this.eventBus.removeEventListener(b.VID_PROGRESS,this.onProgress,this);this.eventBus.removeEventListener(b.VID_SUSPEND,this.onSuspend,this);this.eventBus.removeEventListener(b.VID_TIMEUPDATE,this.onTimeUpdate,this);this.eventBus.removeEventListener(b.VID_PLAY,this.onPlay,this);this.eventBus.removeEventListener(b.VID_PAUSE,this.onPause,this);},onPlay:function(){this.isPlaying=true;this.progressTicks=0;},onPause:function(){this.isPlaying=false;this.progressTicks=0;},onLoadedMetadata:function(){this.show();},onCanPlay:function(){this.hide();},onSuspend:function(){this.progressTicks=0;},onProgress:function(){if(!this.isPlaying){return;}this.progressTicks++;if(this.progressTicks>=this.PROGRESS_TICKS_TO_SHOW){this.show();}},onTimeUpdate:function(){this.progressTicks=0;this.hide();},hide:function(){if(!this.isHidden){this.isHidden=true;f.add(this.el,f.HIDDEN);f.remove(this.spinner,f.TRANSPARENT);}},show:function(){if(this.isHidden){this.isHidden=false;f.remove(this.el,f.HIDDEN);f.remove(this.spinner,f.TRANSPARENT);}},injectLoadingSpinnerCSS:function(){var j="loading-spinner-spin";var k=[];this.zoo.insertKeyframes(j,this.getSpinnerKeyframes());var i=[];i=i.concat(this.getSpinnerStyles());this.zoo.insertRules(i);this.zoo.insertAnimation("."+f.LOADING_SPINNER,"animation",j+" 1.6s linear infinite");},getSpinnerKeyframes:function(){return{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(359deg)"}};},getSpinnerStyles:function(){return[["."+f.LOADING_SPINNER+"-outer-container",{position:"absolute",top:"50%",left:"50%",height:0,width:0}],["."+f.LOADING_SPINNER+"-inner-container",{display:"block",height:"64px",width:"64px",transform:"translate(-50%, -50%)"}],["."+f.LOADING_SPINNER,{display:"block","box-sizing":"border-box",height:"64px",width:"64px",background:"transparent","border-radius":"50%","border-top":"7px solid rgba(255, 255, 255, 1)","border-right":"7px solid rgba(255, 255, 255, 0.5)","border-bottom":"7px solid rgba(255, 255, 255, 0.5)","border-left":"7px solid rgba(255, 255, 255, 0.5)",transition:"opacity 1s ease-out"}]];}};g.exports=a;},{"./reely-css-classes.js":58,"./reely-el-maker.js":59,"./reely-events.js":61}],63:[function(f,h,d){var g=f("./reely-css-classes.js");var i=f("./reely-el-maker.js");var c=f("./reely-events.js");var b=f("./reely-loading-spinner.js");var a=function(j){this.eventBus=j.eventBus;this.spritesheet=j.spritesheet;this.dimensions=j.dimensions;this.zoo=j.zoo;this.loadingSpinner=new b(j);this.init();};a.prototype={init:function(){this.el=i.make("div",g.OVERLAY_CONTAINER);this.isPlaying(false);this.isEnded(false);this.playReplay=i.createLargeTwoStateButton("overlay-play-pause",[{defaultIconName:"overlay-play",hoverIconName:"overlay-play-hover"},{defaultIconName:"overlay-replay",hoverIconName:"overlay-replay-hover"}]);this.el.appendChild(this.playReplay);this.el.appendChild(this.loadingSpinner.el);this.hide();this.broadcastInteraction();this.injectOverlayStyles();this.listen();},hide:function(){g.add(this.playReplay,g.TRANSPARENT);},show:function(){g.remove(this.playReplay,g.TRANSPARENT);},listen:function(){this.eventBus.addEventListener(c.VID_CANPLAY,this.onCanPlay,this);this.eventBus.addEventListener(c.VID_PLAY,this.onPlay,this);this.eventBus.addEventListener(c.VID_PAUSE,this.onPause,this);this.eventBus.addEventListener(c.VID_ENDED,this.onVideoEnded,this);},teardown:function(){this.loadingSpinner.teardown();this.el.removeEventListener("click",this.eventBus.triggers[c.PLAY_PAUSE_TOGGLE]);this.el.removeEventListener("mouseenter",this.eventBus.triggers[c.MOUSE_IN]);this.el.removeEventListener("mouseleave",this.eventBus.triggers[c.MOUSE_OUT]);this.el.removeEventListener("mousemove",this.eventBus.triggers[c.MOUSE_MOVE]);this.eventBus.removeEventListener(c.VID_CANPLAY,this.onLoadedMetadata,this);this.eventBus.removeEventListener(c.VID_PLAY,this.onPlay,this);this.eventBus.removeEventListener(c.VID_PAUSE,this.onPause,this);this.eventBus.removeEventListener(c.VID_ENDED,this.onVideoEnded,this);},broadcastInteraction:function(){this.el.addEventListener("click",this.eventBus.triggers[c.PLAY_PAUSE_TOGGLE]);this.el.addEventListener("mouseenter",this.eventBus.triggers[c.MOUSE_IN]);this.el.addEventListener("mouseleave",this.eventBus.triggers[c.MOUSE_OUT]);this.el.addEventListener("mousemove",this.eventBus.triggers[c.MOUSE_MOVE]);},onCanPlay:function(){if(!this.isPlaying()){this.show();}},onPlay:function(){g.remove(this.playReplay,g.TOGGLED);this.isEnded(false);this.isPlaying(true);this.hide();},onPause:function(){this.isPlaying(false);this.show();},onVideoEnded:function(){g.add(this.playReplay,g.TOGGLED);this.isEnded(true);this.show();},isPlaying:function(j){if(j!=null){this._isPlaying=j;}return this._isPlaying;},isEnded:function(j){if(j!=null){this._isEnded=j;}return this._isEnded;},injectOverlayStyles:function(){var j=[];j=j.concat(this.getContainerStyles());j=j.concat(this.getButtonStyles());j=j.concat(this.getHoverOverrideStyles());this.zoo.insertRules(j);},getContainerStyles:function(){return[["."+g.OVERLAY_CONTAINER,{position:"absolute",top:0,left:0,display:"block",height:"100%",width:"100%",cursor:"pointer","text-align":"center",}],["."+g.OVERLAY_CONTAINER+" *",{visibility:"inherit"}]];},getButtonStyles:function(){return[["."+g.OVERLAY_CONTAINER+" ."+g.TWO_STATE_BUTTON,{top:"50%",left:"50%"}],["."+g.OVERLAY_CONTAINER+" ."+g.BUTTON_ICON_LARGE,{transform:"translate(-50%, -50%)"}],["."+g.BUTTON_ICON_LARGE,{height:this.dimensions.overlaySpriteHeight+"px",width:this.dimensions.overlaySpriteWidth+"px",padding:this.dimensions.buttonPadding+"px"}]];},getHoverOverrideStyles:function(){var j=g;return[[["."+j.OVERLAY_CONTAINER+" ."+j.TWO_STATE_BUTTON+" ."+j.TWO_STATE_DEFAULT,"."+j.OVERLAY_CONTAINER+" ."+j.TWO_STATE_BUTTON+" ."+j.TWO_STATE_DEFAULT,],{visibility:"inherit"}],[["."+j.OVERLAY_CONTAINER+" ."+j.BUTTON+" ."+j.ICON_DEFAULT,"."+j.OVERLAY_CONTAINER+":hover ."+j.BUTTON+" ."+j.ICON_HOVER],{opacity:1}],[["."+j.OVERLAY_CONTAINER+":hover ."+j.BUTTON+" ."+j.ICON_DEFAULT,"."+j.OVERLAY_CONTAINER+" ."+j.BUTTON+" ."+j.ICON_HOVER],{opacity:0}],[["."+j.OVERLAY_CONTAINER+":hover ."+j.BUTTON+" ."+j.ICON_DEFAULT,"."+j.OVERLAY_CONTAINER+" ."+j.BUTTON+" ."+j.ICON_HOVER],{transition:"opacity 0.2s linear"}],["."+j.OVERLAY_CONTAINER+":hover ."+j.BUTTON+" ."+j.ICON_DEFAULT,{transition:"opacity 0s linear 0.2s"}],];}};h.exports=a;},{"./reely-css-classes.js":58,"./reely-el-maker.js":59,"./reely-events.js":61,"./reely-loading-spinner.js":62}],64:[function(c,f,b){var d=c("./reely-css-classes.js");var g=c("./reely-el-maker.js");var a=c("./reely-events.js");var h=function(i){this.eventBus=i.eventBus;this.spritesheet=i.spritesheet;this.dimensions=i.dimensions;this.zoo=i.zoo;this.init();};h.prototype={init:function(){this.el=g.make("div",d.SCRUBBER_CONTAINER);this.el.addEventListener("click",this.onScrubberClick.bind(this));this.els=this.createScrubberBarEls();this.appendEls();this.injectScrubberStyles();this.listen();},getEl:function(){return this.el;},appendEls:function(){this.el.appendChild(this.els.bg);this.el.appendChild(this.els.buffered);this.el.appendChild(this.els.played);this.el.appendChild(this.els.thumb);},createScrubberBarEls:function(){var i={};i.bg=g.createRepeatXSprite("scrubber-bg");i.played=g.createRepeatXSprite("scrubber-played-bg");i.played.style.width=0;i.buffered=g.createRepeatXSprite("scrubber-buffered-bg");i.buffered.style.width=0;i.thumb=g.createButtonState({defaultIconName:"scrubber-tab",hoverIconName:"scrubber-tab-hover"},d.BUTTON+"-scrubber-tab");return i;},listen:function(){this.eventBus.addEventListener(a.VID_TIMEUPDATE,this.onTimeUpdate,this);this.eventBus.addEventListener(a.VID_PLAY,this.onPlay,this);},teardown:function(){this.eventBus.removeEventListener(a.VID_TIMEUPDATE,this.onTimeUpdate,this);this.eventBus.removeEventListener(a.VID_PLAY,this.onPlay,this);},onPlay:function(i){this.lastUpdateMs=Date.now();},onTimeUpdate:function(n){var l=Date.now();var k;if(this.lastUpdateMs){k=(l-this.lastUpdateMs)/1000;}var j=n.target;var i=j.currentTime/j.duration;this.setScrubberBar(i,k);var m=this.determineBufferedFraction(j.buffered,j.duration);this.setBufferBar(m);this.lastUpdateMs=l;},setScrubberTransition:function(i){if(!i){this.els.played.style.transition="";this.els.thumb.style.transition="";}else{this.els.played.style.transition="width "+i+"s linear";this.els.thumb.style.transition="left "+i+"s linear";}},onScrubberClick:function(k){if(d.contains(k.target,"reely-icon")){return;}var i=(typeof k.offsetX!=="undefined")?k.offsetX:k.layerX;var j=i/this.el.clientWidth;this.eventBus.trigger(a.SCRUBBER_BAR_CLICK,{clickedFraction:j});},setScrubberBar:function(i,l){this.setScrubberTransition(l||undefined);var k=i*100;var m=this.el.clientWidth;var j=(m*i)-(this.els.thumb.clientWidth/2);this.els.played.style.width=k+"%";this.els.thumb.style.left=j+"px";},setBufferBar:function(j){var i=j*100;this.els.buffered.style.width=i+"%";},determineBufferedFraction:function(l,j){var n=0;var o=0;for(var m=0;m<l.length;m++){var k=l.end(0)-l.start(0);o+=k;}if(o>0){n=o/j;}return n;},injectScrubberStyles:function(){var i=[];i=i.concat(this.getScrubberBarStyles());i=i.concat(this.getScrubberThumbOverrideStyles());this.zoo.insertRules(i);},getScrubberBarStyles:function(){return[["."+d.SCRUBBER_CONTAINER,{position:"relative",height:"100%",width:"100%","box-sizing":"border-box",overflow:"hidden","padding-top":this.dimensions.buttonPadding+"px","padding-bottom":this.dimensions.buttonPadding+"px",}],["."+d.BUTTON+"-scrubber-tab",{position:"absolute",top:0,left:"-"+(this.dimensions.spriteWidth/2)+"px","padding-left":0,"padding-right":0,"pointer-events":"none"}]];},getScrubberThumbOverrideStyles:function(){return[["."+d.SCRUBBER_CONTAINER+" ."+d.ICON_HOVER,{left:0}]];}};f.exports=h;},{"./reely-css-classes.js":58,"./reely-el-maker.js":59,"./reely-events.js":61}],65:[function(b,d,a){var c=b("./reely-css-classes.js");var f=function(g){this.dimensions=g.dimensions;this.controlBarConfig=g.controlBarConfig;this.zoo=g.zoo;this.spritesheetUrls=this.determineSpritesheetUrls(g.spritesheetUrls);this.overlaySpritesheetUrls=this.determineOverlaySpritesheetUrls(g.overlaySpritesheetUrls);this.init();};f.prototype={TEMP_FORCE_PNG_SPRITESHEET:true,DEFAULT_SPRITESHEET:"http://g-ec2.images-amazon.com/images/G/01/IMDb/ads/tarnhelm-temp/reely-sprites_v0.3.png",DEFAULT_OVERLAY_SPRITESHEET:"http://g-ec2.images-amazon.com/images/G/01/IMDb/ads/tarnhelm-temp/reely-overlay-sprites_v0.0.png",init:function(){this.doesSupportSVG=this.supportsSVG();this.spritesheetSrc=this.determineSpritesheetMode(this.spritesheetUrls);this.overlaySpritesheetSrc=this.determineSpritesheetMode(this.overlaySpritesheetUrls);this.spritesData=this.initSpritesData();this.injectSpritesheetCSS();},getSrc:function(){return this.spritesheetSrc;},getOverlaySrc:function(){return this.overlaySpritesheetSrc;},supportsSVG:function(){return(typeof SVGRect!=="undefined");},determineSpritesheetMode:function(g){if(!this.TEMP_FORCE_PNG_SPRITESHEET&&this.doesSupportSVG&&g.svg){return g.svg;}return g.png;},initSpritesData:function(){var h={};var g=0;g=this.addControlsBGData(h,g);g=this.addRepeatXData(h,g);g=this.addIconData(h,g);this.addLargeIconData(h);return h;},addControlsBGData:function(g,i){var h=this.controlBarConfig.height;g.controlsBG={type:"repeat-x",h:h,x:0,y:i};return i+h;},addRepeatXData:function(k,n){var g=n;var m=this.dimensions.spriteHeight;var j=["scrubber-bg","scrubber-played-bg","scrubber-buffered-bg"];var l;for(var h=0;h<j.length;h++){l=j[h];k[l]={type:"repeat-x",h:m,x:0,y:g};g+=m;}return g;},addIconData:function(j,h){var q=this.dimensions.spriteHeight;var k=this.dimensions.spriteWidth;var o=["scrubber-tab","scrubber-tab-hover","scrubber-tabDown","","play","play-hover","pause","pause-hover","sound-off","sound-off-hover","sound-on","sound-on-hover"];var l;var m;var p;var g=h;for(var n=0;n<o.length;n++){l=o[n];m=(n%2);p=(m)?20:0;if(l!==""){j[l]={type:"icon",w:k,h:q,x:p,y:g};}g=(m)?g+q:g;}return g;},addLargeIconData:function(l,m){var o=this.dimensions.overlaySpriteWidth;var n=this.dimensions.overlaySpriteHeight;var k=["overlay-play","overlay-play-hover","overlay-replay","overlay-replay-hover"];var h;var g=0;for(var j=0;j<k.length;j++){h=k[j];l[h]={type:"icon-large",w:o,h:n,x:0,y:g};g+=n;}return g;},determineSpritesheetUrls:function(g){var h={png:this.DEFAULT_SPRITESHEET};return this._determineSpritesheetUrls(g,h);},determineOverlaySpritesheetUrls:function(g){var h={png:this.DEFAULT_OVERLAY_SPRITESHEET};return this._determineSpritesheetUrls(g,h);},_determineSpritesheetUrls:function(i,j){var g={};var h=(i&&Object.keys(i).length&&i.png);if(h){g.png=i.png;}else{g=j;}return g;},injectSpritesheetCSS:function(){var g=[];g=g.concat(this.getSpriteStyles());g=g.concat(this.getOverlaySpriteStyles());g=g.concat(this.getIndividualSpriteStyles());this.zoo.insertRules(g);},getSpriteStyles:function(){return[[["."+c.ICON,"."+c.REPEAT_X_SPRITE],{height:this.dimensions.spriteHeight+"px",display:"inline-block","background-image":"url("+this.getSrc()+")","background-color":"transparent"}]];},getOverlaySpriteStyles:function(){return[["."+c.ICON_LARGE,{display:"inline-block",height:this.dimensions.overlaySpriteHeight+"px",width:this.dimensions.overlaySpriteWidth+"px","background-image":"url("+this.getOverlaySrc()+")","background-color":"transparent"}]];},getIndividualSpriteStyles:function(){var h=[];var j={icon:this.getIconCSS,"repeat-x":this.getRepeatXSpriteCSS,"icon-large":this.getIconLargeCSS};var l;var g;var k;for(var i in this.spritesData){if(this.spritesData.hasOwnProperty(i)){l=this.spritesData[i];g=j[l.type];k=g.call(this,i,l);h.push(k);}}return h;},getIconCSS:function(g,h){return["."+c.ICON+"-"+g,{width:this.dimensions.spriteWidth+"px","background-position":"-"+h.x+"px -"+h.y+"px","background-repeat":"no-repeat"}];},getRepeatXSpriteCSS:function(g,h){return["."+c.REPEAT_X_SPRITE+"-"+g,{position:"absolute",width:"100%","background-position":"0 -"+h.y+"px","background-repeat":"repeat-x"}];},getIconLargeCSS:function(g,h){return["."+c.ICON_LARGE+"-"+g,{"background-position":"0 -"+h.y+"px","background-repeat":"no-repeat"}];}};d.exports=f;},{"./reely-css-classes.js":58}],66:[function(d,b,f){var g=d("./reely-event-bus.js");var i=d("./reely-controls.js");var a=d("./reely-overlay.js");var c=d("./reely-spritesheet.js");var m=d("../imdb-zoolander.js");var k=d("./reely-css-classes.js");var l=d("./reely-el-maker.js");var h=d("./reely-events.js");var j=function(n){this.injectEl=n.injectEl;this.src=n.src;this.slate=n.slate||"";this.autoplay=n.autoplay||false;this.autosound=n.autosound||false;this.spritesheetUrls=n.spritesheets||{};this.overlaySpritesheetUrls=n.overlaySpritesheets||{};if(n.zoolander){this.zoo=n.zoolander;}var o=n.controlBar||{};this.controlBarConfig=this.determineControlBarConfig(o);var p=n.dimensions||{};this.dimensions=this.determineDimensionsConfig(p);this.init();};j.prototype={doDebug:false,init:function(){k.add(this.injectEl,k.WRAPPER);this.el=l.make("div",k.CONTAINER);this.initZoolander();this.injectPlayerStyles();this.hide();this.initChildren();this.videoStarted=false;this.videoEl=this.createVideoEl();this.broadcast();this.listen();this.el.appendChild(this.videoEl);this.el.appendChild(this.overlay.el);this.el.appendChild(this.controls.el);this.injectEl.appendChild(this.el);},initZoolander:function(){this.zoo=this.zoo||new m();},initChildren:function(){this.eventBus=new g();this.spritesheet=new c({spritesheetUrls:this.spritesheetUrls,overlaySpritesheetUrls:this.overlaySpritesheetUrls,dimensions:this.dimensions,controlBarConfig:this.controlBarConfig,zoo:this.zoo});var n={eventBus:this.eventBus,spritesheet:this.spritesheet,dimensions:this.dimensions,controlBarConfig:this.controlBarConfig,zoo:this.zoo};this.overlay=new a(n);this.controls=new i(n);},play:function(){if(!this.isPlaying()){this.eventBus.trigger(h.PLAY_PAUSE_TOGGLE);}},pause:function(){if(this.isPlaying()){this.eventBus.trigger(h.PLAY_PAUSE_TOGGLE);}},isPlaying:function(){return !this.videoEl.paused;},reset:function(){this.videoEl.currentTime=0;},unmute:function(){if(this.isMuted()){this.videoEl.muted=false;this.eventBus.trigger(h.UNMUTED);}},mute:function(){if(!this.isMuted()){this.videoEl.muted=true;this.eventBus.trigger(h.MUTED);}},isMuted:function(){return this.videoEl.muted;},hide:function(){k.add(this.el,k.HIDDEN);},show:function(){k.remove(this.el,k.HIDDEN);},getEventBus:function(){return this.eventBus;},broadcast:function(){this.passVideoEvents();this.passInteractionEvents();},passVideoEvents:function(){if(this.doDebug){this.passDebugEventLog();}this.videoEl.addEventListener("loadstart",this.eventBus.triggers[h.VID_LOADSTART]);this.videoEl.addEventListener("loadedmetadata",this.eventBus.triggers[h.VID_LOADEDMETADATA]);this.videoEl.addEventListener("loadeddata",this.eventBus.triggers[h.VID_LOADEDDATA]);this.videoEl.addEventListener("canplay",this.eventBus.triggers[h.VID_CANPLAY]);this.videoEl.addEventListener("canplaythrough",this.eventBus.triggers[h.VID_CANPLAYTHROUGH]);this.videoEl.addEventListener("waiting",this.eventBus.triggers[h.VID_WAITING]);this.videoEl.addEventListener("progress",this.eventBus.triggers[h.VID_PROGRESS]);this.videoEl.addEventListener("suspend",this.eventBus.triggers[h.VID_SUSPEND]);this.videoEl.addEventListener("play",this.eventBus.triggers[h.VID_PLAY]);this.videoEl.addEventListener("pause",this.eventBus.triggers[h.VID_PAUSE]);this.videoEl.addEventListener("timeupdate",this.eventBus.triggers[h.VID_TIMEUPDATE]);this.videoEl.addEventListener("ended",this.eventBus.triggers[h.VID_ENDED]);},passDebugEventLog:function(){var o=[];for(var n=0;n<o.length;n++){this.videoEl.addEventListener(o[n],this.debugLog);}},debugLog:function(n){if(window&&window.console&&window.console.log){window.console.log("Media Event :: type :: ",n.type);}},passInteractionEvents:function(){this.videoEl.addEventListener("click",this.eventBus.triggers[h.PLAY_PAUSE_TOGGLE]);},listen:function(){this.eventBus.addEventListener(h.VID_LOADEDMETADATA,this.onLoadedMetadata,this);this.eventBus.addEventListener(h.VID_LOADEDDATA,this.onLoadedData,this);this.eventBus.addEventListener(h.VID_PLAY,this.onPlay,this);this.eventBus.addEventListener(h.PLAY_PAUSE_TOGGLE,this.onPlayPauseClick,this);this.eventBus.addEventListener(h.MUTE_UNMUTE_TOGGLE,this.onMuteUnmuteClick,this);this.eventBus.addEventListener(h.SCRUBBER_BAR_CLICK,this.onScrubberBarClick,this);},teardown:function(){this.pause();this.mute();this.videoEl.removeEventListener("loadstart",this.eventBus.triggers[h.VID_LOADSTART]);this.videoEl.removeEventListener("loadedmetadata",this.eventBus.triggers[h.VID_LOADEDMETADATA]);this.videoEl.removeEventListener("loadeddata",this.eventBus.triggers[h.VID_LOADEDDATA]);this.videoEl.removeEventListener("canplay",this.eventBus.triggers[h.VID_CANPLAY]);this.videoEl.removeEventListener("canplaythrough",this.eventBus.triggers[h.VID_CANPLAYTHROUGH]);this.videoEl.removeEventListener("waiting",this.eventBus.triggers[h.VID_WAITING]);this.videoEl.removeEventListener("progress",this.eventBus.triggers[h.VID_PROGRESS]);this.videoEl.removeEventListener("suspend",this.eventBus.triggers[h.VID_SUSPEND]);this.videoEl.removeEventListener("play",this.eventBus.triggers[h.VID_PLAY]);this.videoEl.removeEventListener("pause",this.eventBus.triggers[h.VID_PAUSE]);this.videoEl.removeEventListener("timeupdate",this.eventBus.triggers[h.VID_TIMEUPDATE]);this.videoEl.removeEventListener("ended",this.eventBus.triggers[h.VID_ENDED]);this.videoEl.removeEventListener("click",this.eventBus.triggers[h.PLAY_PAUSE_TOGGLE]);this.eventBus.removeEventListener(h.STARTED,this.onPlay,this);this.eventBus.removeEventListener(h.VID_LOADEDMETADATA,this.onLoadedMetadata,this);this.eventBus.removeEventListener(h.VID_LOADEDDATA,this.onLoadedData,this);this.eventBus.removeEventListener(h.PLAY_PAUSE_TOGGLE,this.onPlayPauseClick,this);this.eventBus.removeEventListener(h.MUTE_UNMUTE_TOGGLE,this.onMuteUnmuteClick,this);this.eventBus.removeEventListener(h.SCRUBBER_BAR_CLICK,this.onScrubberBarClick,this);this.zoo.teardown();this.overlay.teardown();this.controls.teardown();this.removeNodes();},removeNodes:function(){k.remove(this.injectEl,k.WRAPPER);this.injectEl.removeChild(this.el);this.videoEl=null;this.overlay.el=null;this.controls.el=null;this.el=null;},onPlay:function(){if(!this.videoStarted){this.videoStarted=true;this.eventBus.triggers[h.STARTED]();this.eventBus.removeEventListener(h.STARTED,this.onPlay,this);}},onPlayPauseClick:function(n){if(this.videoEl.paused){this.videoEl.play();}else{this.videoEl.pause();}},onMuteUnmuteClick:function(n){if(this.isMuted()){this.unmute();}else{this.mute();}},onScrubberBarClick:function(n){var o=n.clickedFraction;this.videoEl.currentTime=this.videoEl.duration*o;},onLoadedMetadata:function(n){this.injectAspectStyles();},onLoadedData:function(n){this.show();if(this.autoplay){this.videoEl.play();}},createVideoEl:function(){var n=l.make("video",k.VIDEO);n.volume=1;n.preload=true;n.poster=this.slate;var o=this.autosound;n.muted=!o;if(o){this.eventBus.trigger(h.UNMUTED);}this.addSources(n);return n;},addSources:function(n){var o=this.createSource(this.src,"mp4");var q=this.createSource(this.src,"webm");var p=document.createElement("p");p.innerHTML="Sorry, your browser does not support HTML5 video.";n.appendChild(o);n.appendChild(q);n.appendChild(p);},createSource:function(p,n){var o=document.createElement("source");o.src=p+"."+n;o.type="video/"+n;return o;},determineControlBarConfig:function(p){var n=p;var s=this.controlBarDefaults();if(!n){return s;}var r=["width","anchorX","anchorY","offsetX","offsetY","hideBG"];var q;for(var o=0;o<r.length;o++){q=r[o];if(n[q]!=null){s[q]=this.addPxIfNumber(n[q]);}}return s;},controlBarDefaults:function(){return{height:30,width:"100%",anchorX:"center",anchorY:"bottom",offsetX:0,offsetY:0,hideBG:false,};},addPxIfNumber:function(n){if(typeof n==="number"){return n+"px";}return n;},determineDimensionsConfig:function(p){var o=this.dimensionsDefaults();var n=p.width;if(n){o.reelyElWidth=n;}return o;},dimensionsDefaults:function(){return{buttonPadding:5,spriteHeight:20,spriteWidth:20,overlaySpriteHeight:100,overlaySpriteWidth:100,reelyElWidth:"100%"};},injectPlayerStyles:function(){var n=[];n=n.concat(this.getUtilityStyles());n=n.concat(this.getPlayerStyles());n=n.concat(this.getIconStyles());n=n.concat(this.getButtonStyles());n=n.concat(this.getTwoStateStyles());this.zoo.insertRules(n);},getUtilityStyles:function(){return[["."+k.UNSELECTABLE,{"user-select":"none"}],["."+k.HIDDEN,{display:"none"}],["."+k.INVISIBLE,{visibility:"hidden"}],["."+k.TRANSPARENT,{opacity:0}]];},getPlayerStyles:function(){var n;if(typeof this.dimensions.reelyElWidth==="number"){n=this.dimensions.reelyElWidth+"px";}else{n=this.dimensions.reelyElWidth;}return[["."+k.WRAPPER,{display:"inline-block",width:n}],["."+k.CONTAINER,{position:"relative",display:"block",height:"0",width:"100%"}],["."+k.VIDEO,{position:"absolute",top:0,left:0,"max-height":"100%",width:"100%",cursor:"pointer"}]];},getIconStyles:function(){return[[["."+k.ICON,"."+k.ICON_HOVER],{position:"absolute"}],["."+k.ICON_HOVER,{top:this.dimensions.buttonPadding+"px",left:this.dimensions.buttonPadding+"px"}],];},getButtonStyles:function(){return[["."+k.BUTTON,{cursor:"pointer"}],[["."+k.BUTTON+" ."+k.ICON_DEFAULT,"."+k.BUTTON+":hover ."+k.ICON_HOVER],{opacity:1}],[["."+k.BUTTON+":hover ."+k.ICON_DEFAULT,"."+k.BUTTON+" ."+k.ICON_HOVER],{opacity:0}],[["."+k.BUTTON+":hover ."+k.ICON_DEFAULT,"."+k.BUTTON+" ."+k.ICON_HOVER],{transition:"opacity 0.2s linear"}],["."+k.BUTTON+":hover ."+k.ICON_DEFAULT,{transition:"opacity 0s linear 0.2s"}],];},getTwoStateStyles:function(){return[[["."+k.TWO_STATE_BUTTON,"."+k.TWO_STATE_BUTTON+" ."+k.TWO_STATE_DEFAULT,"."+k.TWO_STATE_BUTTON+" ."+k.TWO_STATE_ALT],{position:"absolute"}],["."+k.TWO_STATE_BUTTON,{display:"inline-block"}],[["."+k.TWO_STATE_BUTTON+" ."+k.TWO_STATE_DEFAULT,"."+k.TWO_STATE_BUTTON+"."+k.TOGGLED+" ."+k.TWO_STATE_ALT,],{opacity:1,visibility:"visible"}],[["."+k.TWO_STATE_BUTTON+"."+k.TOGGLED+" ."+k.TWO_STATE_DEFAULT,"."+k.TWO_STATE_BUTTON+" ."+k.TWO_STATE_ALT,],{opacity:0,visibility:"hidden"}]];},injectAspectStyles:function(){var n=((this.videoEl.videoHeight/this.videoEl.videoWidth)*100).toFixed(4);this.zoo.insertRule("."+k.CONTAINER,{"padding-top":n+"%"});}};b.exports=j;},{"../imdb-zoolander.js":56,"./reely-controls.js":57,"./reely-css-classes.js":58,"./reely-el-maker.js":59,"./reely-event-bus.js":60,"./reely-events.js":61,"./reely-overlay.js":63,"./reely-spritesheet.js":65}]},{},[48]);